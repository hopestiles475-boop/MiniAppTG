<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>NFT Cases</title>
    <!-- –í–ï–†–°–ò–Ø –§–ê–ô–õ–ê: 2024-12-19-TonConnect-Fix-v2 -->
    <noscript>
        <div style="position:fixed;top:0;left:0;width:100%;height:100%;background:red;color:white;z-index:99999;padding:20px;font-size:24px;">
            ‚ö†Ô∏è JavaScript –æ—Ç–∫–ª—é—á–µ–Ω! –í–∫–ª—é—á–∏—Ç–µ JavaScript –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
        </div>
    </noscript>
    <script>
        // –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ü–ï–†–í–´–ú
        // –í–ï–†–°–ò–Ø: 2024-12-19-TonConnect-Fix-v2
        (function() {
            'use strict';
            try {
                console.log('üöÄ –°–¢–†–ê–ù–ò–¶–ê –ù–ê–ß–ê–õ–ê –ó–ê–ì–†–£–ñ–ê–¢–¨–°–Ø - –í–ï–†–°–ò–Ø v2');
                console.log('Timestamp:', new Date().toISOString());
                console.log('User Agent:', navigator.userAgent);
                console.log('URL:', window.location.href);
                
                // –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ CSP
                try {
                    const testDiv = document.createElement('div');
                    testDiv.style.display = 'none';
                    document.body.appendChild(testDiv);
                    console.log('‚úÖ DOM –¥–æ—Å—Ç—É–ø–µ–Ω');
                } catch(e) {
                    console.error('‚ùå DOM –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω:', e);
                }
                
                // –ü–µ—Ä–µ—Ö–≤–∞—Ç –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
                window.addEventListener('error', function(e) {
                    console.error('‚ùå –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –û–®–ò–ë–ö–ê:', e.message, e.filename, e.lineno);
                }, true);
                
                // –ü–µ—Ä–µ—Ö–≤–∞—Ç –Ω–µ–ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –ø—Ä–æ–º–∏—Å–æ–≤
                window.addEventListener('unhandledrejection', function(e) {
                    console.error('‚ùå –û–®–ò–ë–ö–ê –ü–†–û–ú–ò–°–ê:', e.reason);
                });
            } catch(err) {
                alert('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ' + err.message);
            }
        })();
    </script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –°–†–ê–ó–£, —á—Ç–æ–±—ã –æ–Ω–∏ –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ HTML
        // –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞ - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã —Å—Ä–∞–∑—É
        window.openCase = function() {
            console.log('‚ö†Ô∏è openCase –≤—ã–∑–≤–∞–Ω–∞ –¥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏, –æ–∂–∏–¥–∞—é...');
            setTimeout(function() {
                if (typeof window.openCase === 'function' && window.openCase.toString().includes('caseDetailPage')) {
                    window.openCase();
                } else {
                    alert('–§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É.');
                }
            }, 100);
        };
        
        window.closePrizeModal = function() {
            console.log('‚ö†Ô∏è closePrizeModal –≤—ã–∑–≤–∞–Ω–∞ –¥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏');
        };
        
        window.goBackFromCase = function() {
            console.log('‚ö†Ô∏è goBackFromCase –≤—ã–∑–≤–∞–Ω–∞ –¥–æ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏');
        };
        
        // –ü–ï–†–ï–•–í–ê–¢–´–í–ê–ï–ú –û–®–ò–ë–ö–ò –û–¢ TELEGRAM SDK
        window.addEventListener('error', function(e) {
            if (e.message && (e.message.includes("reading 'top'") || e.message.includes('calculatePosition'))) {
                e.preventDefault();
                return true;
            }
        }, true);
        
        window.addEventListener('unhandledrejection', function(e) {
            if (e.reason && e.reason.message && (e.reason.message.includes("reading 'top'") || e.reason.message.includes('calculatePosition'))) {
                e.preventDefault();
                return true;
            }
        });
        
        // –§–£–ù–ö–¶–ò–Ø –ù–ê–í–ò–ì–ê–¶–ò–ò - –û–ü–†–ï–î–ï–õ–Ø–ï–ú –í HEAD –ß–¢–û–ë–´ –ë–´–õ–ê –î–û–°–¢–£–ü–ù–ê –°–†–ê–ó–£
        // –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º
        if (!window.handleNavClick) {
            window.handleNavClick = function(page, clickedItem) {
                if (!page) return;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
                var items = document.querySelectorAll('.nav-item');
                for (var i = 0; i < items.length; i++) {
                    items[i].classList.remove('active');
                }
                if (clickedItem) clickedItem.classList.add('active');
                
                // –ü–æ–ª—É—á–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                var mainPage = document.getElementById('mainPage');
                var profilePage = document.getElementById('profilePage');
                var casesPage = document.getElementById('casesPage');
                var crashPage = document.getElementById('crashPage');
                var minesPage = document.getElementById('minesPage');
                var dicePage = document.getElementById('dicePage');
                var caseDetailPage = document.getElementById('caseDetailPage');
                var header = document.querySelector('.header');
                var openBtn = document.getElementById('openBtn');
                
                if (!mainPage || !profilePage) return;
                
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –≤–∫–ª—é—á–∞—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–µ–π—Å–∞
                var pages = [mainPage, profilePage];
                if (casesPage) pages.push(casesPage);
                if (crashPage) pages.push(crashPage);
                if (minesPage) pages.push(minesPage);
                if (dicePage) pages.push(dicePage);
                if (caseDetailPage) {
                    caseDetailPage.style.display = 'none';
                    caseDetailPage.style.visibility = 'hidden';
                    caseDetailPage.style.opacity = '0';
                    caseDetailPage.style.pointerEvents = 'none';
                }
                
                for (var i = 0; i < pages.length; i++) {
                    if (pages[i]) {
                        // –ù–µ —Å–∫—Ä—ã–≤–∞–µ–º mainPage –ø–æ–ª–Ω–æ—Å—Ç—å—é, –µ—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –¥—Ä—É–≥—É—é –≤–∫–ª–∞–¥–∫—É
                        // –ü—Ä–æ—Å—Ç–æ —Å–∫—Ä—ã–≤–∞–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
                        if (pages[i].id === 'mainPage' && page !== 'cases') {
                        pages[i].style.display = 'none';
                        pages[i].style.visibility = 'hidden';
                        pages[i].style.opacity = '0';
                        pages[i].style.pointerEvents = 'none';
                        } else if (pages[i].id !== 'mainPage') {
                            pages[i].style.display = 'none';
                            pages[i].style.visibility = 'hidden';
                            pages[i].style.opacity = '0';
                            pages[i].style.pointerEvents = 'none';
                        }
                        pages[i].classList.remove('active');
                        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è caseDetailPage
                        if (pages[i].id === 'caseDetailPage') {
                            pages[i].style.position = 'fixed';
                            pages[i].style.top = '0';
                            pages[i].style.left = '0';
                            pages[i].style.right = '0';
                            pages[i].style.bottom = '0';
                            pages[i].style.zIndex = '-1';
                        }
                    }
                }
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–û—Ç–∫—Ä—ã—Ç—å" –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–∫–ª–∞–¥–æ–∫
                if (openBtn) {
                    openBtn.style.display = 'none';
                    openBtn.style.visibility = 'hidden';
                    openBtn.style.opacity = '0';
                    openBtn.classList.remove('show');
                }
                
                // –°–∫—Ä—ã–≤–∞–µ–º mainPage (—Å—Ç–∞—Ä–æ–µ –º–µ–Ω—é) –ø—Ä–∏ –ª—é–±–æ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
                if (mainPage) {
                    mainPage.style.display = 'none';
                    mainPage.style.visibility = 'hidden';
                    mainPage.style.opacity = '0';
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º
                if (page === 'cases' && casesPage) {
                    if (header) header.style.display = 'flex';
                    casesPage.style.display = 'block';
                    casesPage.style.visibility = 'visible';
                    casesPage.style.opacity = '1';
                    casesPage.style.position = 'fixed';
                    casesPage.style.top = '0';
                    casesPage.style.left = '0';
                    casesPage.style.right = '0';
                    casesPage.style.bottom = '0';
                    casesPage.style.width = '100%';
                    casesPage.style.height = '100%';
                    casesPage.style.zIndex = '100';
                    casesPage.style.pointerEvents = 'auto';
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–¥–ø–∏—Å–∫–∏ –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
                    const subscribeBtn = document.querySelector('.subscribe-btn');
                    if (subscribeBtn) {
                        subscribeBtn.style.display = 'none';
                    }
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–µ–π—Å—ã —Å—Ä–∞–∑—É - –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                    function forceLoadCases() {
                        if (typeof loadCases === 'function') {
                            console.log('üîµ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é –∫–µ–π—Å—ã');
                            loadCases();
                        } else {
                            console.error('‚ùå loadCases –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                        }
                    }
                    
                    forceLoadCases();
                    setTimeout(forceLoadCases, 100);
                    setTimeout(forceLoadCases, 500);
                    
                    setTimeout(function() {
                        if (typeof updateBalanceDisplay === 'function') updateBalanceDisplay();
                    }, 50);
                } else if (page === 'profile' && profilePage) {
                    if (header) header.style.display = 'flex';
                    profilePage.style.display = 'block';
                    profilePage.style.visibility = 'visible';
                    profilePage.style.opacity = '1';
                    profilePage.style.pointerEvents = 'auto';
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                    setTimeout(function() {
                        if (typeof updateProfileInfo === 'function') updateProfileInfo();
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
                        if (typeof loadUserData === 'function') {
                            loadUserData().then(() => {
                                if (typeof updateInventory === 'function') {
                                    updateInventory();
                                }
                            }).catch(err => {
                                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', err);
                                if (typeof updateInventory === 'function') {
                                    updateInventory();
                                }
                            });
                        } else {
                            if (typeof updateInventory === 'function') updateInventory();
                        }
                        if (typeof initProfileHandlers === 'function') initProfileHandlers();
                        if (typeof initTopUpHandlers === 'function') initTopUpHandlers();
                        if (typeof initWithdrawHandlers === 'function') initWithdrawHandlers();
                    }, 50);
                } else if (page === 'crash' && crashPage) {
                    if (header) header.style.display = 'flex';
                    crashPage.style.display = 'block';
                    crashPage.style.visibility = 'visible';
                    crashPage.style.opacity = '1';
                    crashPage.style.position = 'fixed';
                    crashPage.style.top = '0';
                    crashPage.style.left = '0';
                    crashPage.style.right = '0';
                    crashPage.style.bottom = '0';
                    crashPage.style.width = '100%';
                    crashPage.style.height = '100%';
                    crashPage.style.zIndex = '100';
                    crashPage.style.pointerEvents = 'auto';
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫—Ä–∞—à –∏–≥—Ä—É
                    setTimeout(function() {
                        if (typeof updateBalanceDisplay === 'function') updateBalanceDisplay();
                        if (typeof initCrashGame === 'function') initCrashGame();
                    }, 50);
                } else if (page === 'mines' && minesPage) {
                    if (header) header.style.display = 'flex';
                    minesPage.style.display = 'block';
                    minesPage.style.visibility = 'visible';
                    minesPage.style.opacity = '1';
                    minesPage.style.position = 'fixed';
                    minesPage.style.top = '0';
                    minesPage.style.left = '0';
                    minesPage.style.right = '0';
                    minesPage.style.bottom = '0';
                    minesPage.style.width = '100%';
                    minesPage.style.height = '100%';
                    minesPage.style.zIndex = '100';
                    minesPage.style.pointerEvents = 'auto';
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–∏–Ω—ã –∏–≥—Ä—É
                    setTimeout(function() {
                        if (typeof updateBalanceDisplay === 'function') updateBalanceDisplay();
                        if (typeof initMinesGame === 'function') initMinesGame();
                    }, 50);
                } else if (page === 'dice' && dicePage) {
                    if (header) header.style.display = 'flex';
                    dicePage.style.display = 'block';
                    dicePage.style.visibility = 'visible';
                    dicePage.style.opacity = '1';
                    dicePage.style.position = 'fixed';
                    dicePage.style.top = '0';
                    dicePage.style.left = '0';
                    dicePage.style.right = '0';
                    dicePage.style.bottom = '0';
                    dicePage.style.width = '100%';
                    dicePage.style.height = '100%';
                    dicePage.style.zIndex = '100';
                    dicePage.style.pointerEvents = 'auto';
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º dice –∏–≥—Ä—É
                    setTimeout(function() {
                        if (typeof updateBalanceDisplay === 'function') updateBalanceDisplay();
                        if (typeof initDiceGame === 'function') initDiceGame();
                    }, 50);
                }
            };
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(180deg, 
                rgba(10, 10, 20, 0.98) 0%, 
                rgba(20, 15, 30, 0.98) 25%,
                rgba(30, 20, 40, 0.98) 50%,
                rgba(20, 15, 30, 0.98) 75%,
                rgba(10, 10, 20, 0.98) 100%);
            background-attachment: fixed;
            color: var(--tg-theme-text-color, #ffffff);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(102, 126, 234, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(118, 75, 162, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(0, 212, 255, 0.08) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            position: relative;
            z-index: 10;
            background: transparent;
        }


        .profile-section {
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            z-index: 1;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            overflow: hidden;
            position: relative;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .username {
            font-weight: 600;
            font-size: 16px;
            color: #ffffff;
        }

        .balance-section {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
            position: relative;
            z-index: 1;
        }
        
        .balance-section, .balance-text {
            color: #ffffff !important;
        }

        .diamond-icon {
            width: 18px;
            height: 18px;
            display: inline-block;
            background-image: url('ton_symbol.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            vertical-align: middle;
        }
        
        .currency-icon {
            width: 16px;
            height: 16px;
            display: inline-block;
            background-image: url('ton_symbol.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            vertical-align: middle;
            margin-right: 2px;
        }

        .balance-text {
            font-weight: 600;
            font-size: 16px;
        }

        .ton-balance {
            display: none !important;
            visibility: hidden !important;
            font-size: 24px;
            font-weight: 700;
            margin: 10px 20px;
            color: #ffffff;
        }

        .demo-badge {
            display: none !important;
            visibility: hidden !important;
            background: #667eea;
            padding: 4px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .subscribe-btn {
            cursor: pointer !important;
            pointer-events: auto !important;
            position: relative !important;
            z-index: 10 !important;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 15px auto;
            padding: 20px;
            border-radius: 16px;
            border: none;
            color: white;
            cursor: pointer;
            gap: 15px;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3);
            transition: all 0.3s;
            max-width: 90%;
            width: 100%;
        }

        .subscribe-btn:active {
            transform: scale(0.98);
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.2);
        }

        .subscribe-inner {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 18px;
            font-weight: 700;
            width: 100%;
        }

        .subscribe-icon {
            font-size: 24px;
        }

        .subscribe-action {
            background: white;
            color: #667eea;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            transition: all 0.3s;
            box-shadow: 0 2px 10px rgba(255, 255, 255, 0.2);
        }

        .subscribe-action:active {
            transform: scale(0.95);
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 0 20px;
            margin-bottom: 15px;
        }

        .tab {
            padding: 10px 20px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }


        #mainPage {
            display: block;
            position: relative;
            width: 100%;
            min-height: 100vh;
            background: transparent;
            z-index: 1;
        }

        #mainPage.hidden {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            position: absolute !important;
            pointer-events: none !important;
        }
        
        #minesPage {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            z-index: 100;
            background: transparent;
        }
        
        #minesPage[style*="none"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }
        
        #profilePage {
            position: relative;
            width: 100%;
            min-height: 100vh;
            background: transparent;
            z-index: 1;
        }
        
        #profilePage[style*="none"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            position: absolute !important;
            pointer-events: none !important;
        }
        
        #mainPage {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }
        
        #mainPage:not(.hidden) {
            display: none !important;
        }
        
        body:not(.show-main-page) #mainPage {
            display: none !important;
        }
        
        #caseDetailPage {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            z-index: 1000;
            background: transparent;
            padding: 20px;
            padding-bottom: 120px;
        }

        .case-detail-page {
            padding: 20px;
            padding-bottom: 120px;
            position: relative;
            z-index: 1;
            min-height: 100vh;
        }

        .case-detail-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }

        .case-detail-icon {
            font-size: 120px;
            margin: 20px 0;
            background: transparent;
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 150px;
        }

        .case-detail-icon img {
            width: 100%;
            max-width: 300px;
            min-width: 150px;
            height: auto;
            max-height: 300px;
            object-fit: contain;
            display: block;
        }

        .case-detail-price {
            font-size: 28px;
            font-weight: 700;
            color: #667eea;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 6px;
            justify-content: center;
        }
        
        .case-detail-price .currency-icon {
            width: 24px;
            height: 24px;
        }

        .whats-inside-title {
            font-size: 24px;
            font-weight: 700;
            margin: 35px 0 25px 0;
            padding: 0 15px;
            color: #ffffff;
            text-align: center;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            letter-spacing: 0.5px;
            position: relative;
            z-index: 1;
        }

        .prizes-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 18px;
            padding: 0 15px;
            margin-bottom: 40px;
            position: relative;
            z-index: 1;
        }

        .prize-item {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.15) 100%);
            border-radius: 20px;
            padding: 18px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.15);
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .prize-item:hover {
            transform: translateY(-5px) scale(1.05);
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.25) 0%, rgba(118, 75, 162, 0.25) 100%);
        }

        .prize-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin-bottom: 10px;
        }

        .prize-icon img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            display: block;
        }

        .prize-value {
            font-size: 16px;
            font-weight: 600;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 4px;
            justify-content: center;
        }
        
        .prize-value .currency-icon {
            width: 16px;
            height: 16px;
        }

        .prize-name {
            display: none !important;
        }

        .back-btn {
            background: rgba(102, 126, 234, 0.3);
            border: 2px solid rgba(102, 126, 234, 0.5);
            color: white;
            padding: 12px 24px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: rgba(102, 126, 234, 0.5);
            transform: translateY(-2px);
        }

        .open-case-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 18px 40px;
            border-radius: 20px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
            position: relative;
            z-index: 1;
            width: calc(100% - 40px);
            max-width: 400px;
        }

        .open-case-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.6);
        }

        .open-case-btn:active {
            transform: translateY(-1px);
        }

        .roulette-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .roulette-wrapper {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 300px;
            overflow: hidden;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 24px;
            border: 3px solid rgba(102, 126, 234, 0.3);
        }

        .roulette-prize {
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.1s linear;
            will-change: transform;
        }

        .roulette-item {
            width: 100%;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            box-sizing: border-box;
        }

        .roulette-item img {
            width: 80px;
            height: 80px;
            object-fit: contain;
        }

        .roulette-arrow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 25px solid #667eea;
            z-index: 10;
            pointer-events: none;
        }

        .prize-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 3000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .prize-modal-content {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            border-radius: 24px;
            padding: 40px;
            text-align: center;
            border: 2px solid rgba(102, 126, 234, 0.5);
            max-width: 400px;
            width: 100%;
        }

        .prize-modal-title {
            font-size: 28px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 30px;
        }

        .prize-modal-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            min-height: 120px;
        }

        .prize-modal-icon img {
            width: 120px;
            height: 120px;
            object-fit: contain;
        }

        .prize-modal-value {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        .prize-modal-value .currency-icon {
            width: 24px;
            height: 24px;
        }

        .prize-modal-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 16px 40px;
            border-radius: 16px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
        }

        .prize-modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 30px rgba(102, 126, 234, 0.6);
        }
        


        .open-btn:disabled {
            opacity: 0.5 !important;
            cursor: not-allowed !important;
            pointer-events: none !important;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.5) 0%, rgba(118, 75, 162, 0.5) 100%) !important;
            border-color: rgba(255, 255, 255, 0.2) !important;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3) !important;
            transform: none !important;
        }
        
        .open-btn:disabled:hover {
            transform: none !important;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.3) !important;
        }

        .spinning {
            animation: spin 0.1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .spinning-prizes {
            animation: shuffle 0.05s linear infinite;
        }

        @keyframes shuffle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #ffffff;
            padding: 10px 20px;
            border-radius: 12px;
            font-size: 14px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .modal {
            display: none !important;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            z-index: 3000 !important;
            pointer-events: auto !important;
        }
        
        #inventoryItemModal {
            z-index: 3000 !important;
            pointer-events: auto !important;
        }
        
        #inventoryItemModal .modal-content {
            pointer-events: auto !important;
            z-index: 3001 !important;
        }
        
        #inventoryItemModal .inventory-modal-btn {
            cursor: pointer !important;
            pointer-events: auto !important;
            z-index: 3002 !important;
        }

        /* –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–û—Ç–∫—Ä—ã—Ç—å" —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–µ—Ç–∞–ª–µ–π –∫–æ–≥–¥–∞ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–∫—Ç–∏–≤–Ω–æ */
        .modal.active ~ #openBtn {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }

        .modal-content {
            background: rgba(26, 26, 46, 0.85);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 40px;
            padding-bottom: 30px;
            text-align: center;
            max-width: 90%;
            width: 100%;
            max-width: 400px;
            animation: scaleIn 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-sizing: border-box;
        }
        
        .modal-content > * {
            width: 100%;
        }
        
        .modal-content .modal-close {
            width: auto !important;
        }

        .inventory-modal-content {
            max-width: 400px;
            width: 90%;
            padding: 30px;
            position: relative;
        }

        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: rgba(255, 255, 255, 0.7);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            z-index: 10;
        }

        .modal-close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
        }

        .modal-close-btn:active {
            transform: scale(0.9);
        }

        .inventory-modal-icon {
            width: 150px;
            height: 150px;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            background: rgba(102, 126, 234, 0.1);
            padding: 20px;
        }

        .inventory-modal-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }

        .inventory-modal-name {
            font-size: 28px;
            font-weight: 700;
            color: #ffffff;
            text-align: center;
            margin-bottom: 20px;
        }

        .inventory-modal-price {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            margin-bottom: 30px;
        }

        .price-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 500;
        }

        .price-value {
            font-size: 32px;
            font-weight: 700;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .price-value .currency-icon {
            width: 28px;
            height: 28px;
        }

        .inventory-modal-buttons {
            display: flex;
            gap: 12px;
            width: 100%;
        }

        .inventory-modal-btn {
            flex: 1;
            padding: 16px 24px;
            border-radius: 16px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .inventory-modal-btn.sell-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
        }

        .inventory-modal-btn.sell-btn:active {
            transform: scale(0.98);
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        .inventory-modal-btn.close-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.8);
        }

        .inventory-modal-btn.close-btn:active {
            transform: scale(0.98);
            background: rgba(255, 255, 255, 0.15);
        }

        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-prize-icon {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-prize-icon img {
            width: 120px;
            height: 120px;
            object-fit: contain;
            display: block;
        }

        .modal-prize-icon-old {
            font-size: 100px;
            margin: 20px 0;
            animation: bounce 0.6s;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-30px); }
        }

        .modal-prize-name {
            font-size: 28px;
            font-weight: 700;
            margin: 20px 0;
            color: #ffffff;
        }

        .modal-prize-value {
            font-size: 24px;
            color: #667eea;
            font-weight: 700;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 6px;
            justify-content: center;
        }
        
        .modal-prize-value .currency-icon {
            width: 20px;
            height: 20px;
        }

        .modal-open-btn {
            display: none !important;
        }
        
        .modal-open-btn:hover {
            transform: translateY(-2px) !important;
            box-shadow: 0 10px 50px rgba(102, 126, 234, 1), 0 0 40px rgba(102, 126, 234, 0.8), inset 0 1px 0 rgba(255, 255, 255, 0.4) !important;
        }
        
        .modal-open-btn:active {
            transform: translateY(0) !important;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.08) !important;
            color: rgba(255, 255, 255, 0.7) !important;
            border: 2px solid rgba(255, 255, 255, 0.2) !important;
            padding: 10px 25px !important;
            border-radius: 12px !important;
            font-size: 14px !important;
            font-weight: 500 !important;
            cursor: pointer !important;
            width: auto !important;
            min-width: 100px !important;
            max-width: 150px !important;
            margin: 0 auto !important;
            display: block !important;
            box-sizing: border-box !important;
            text-align: center !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
            transition: all 0.3s !important;
            align-self: center !important;
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.15) !important;
            border-color: rgba(255, 255, 255, 0.35) !important;
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3) !important;
        }
        
        .modal-close:active {
            transform: translateY(0);
        }

        .bottom-nav {
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            background: rgba(10, 10, 10, 0.98);
            backdrop-filter: blur(20px);
            border-top: 2px solid rgba(255, 255, 255, 0.15);
            display: flex !important;
            justify-content: space-around;
            padding: 12px 0;
            z-index: 9999 !important;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.5);
            pointer-events: auto !important;
        }

        .nav-item {
            cursor: pointer !important;
            pointer-events: auto !important;
            position: relative !important;
            z-index: 100 !important;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 20px;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-item.active {
            color: #667eea;
        }
        
        .nav-item.active .nav-icon {
            transform: scale(1.1);
        }

        .nav-icon {
            font-size: 24px;
        }

        .nav-label {
            font-size: 12px;
            font-weight: 500;
        }

        .profile-page {
            padding: 20px;
            padding-bottom: 120px;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        .profile-header {
            text-align: center;
            margin-bottom: 30px;
            margin-top: 20px;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 4px solid rgba(255, 255, 255, 0.2);
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-username {
            font-size: 24px;
            font-weight: 700;
            color: #ffffff;
        }

        .top-up-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .top-up-btn {
            cursor: pointer !important;
            pointer-events: auto !important;
            position: relative !important;
            z-index: 10 !important;
            flex: 1;
            padding: 16px 20px;
            border-radius: 16px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .top-up-btn.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .top-up-btn.secondary {
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        .top-up-btn:active {
            transform: scale(0.98);
        }

        .btn-icon {
            font-size: 20px;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è */
        .top-up-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .top-up-modal-content {
            background: #1a1a1a;
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 100%;
            position: relative;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .top-up-modal-title {
            font-size: 22px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 20px;
            text-align: center;
        }

        .top-up-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .top-up-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
        }

        .top-up-input {
            width: 100%;
            padding: 14px 16px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
            box-sizing: border-box;
        }

        .top-up-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .top-up-info {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
        }

        .top-up-info p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            margin: 0;
        }

        .top-up-info span {
            color: #667eea;
            font-weight: 700;
        }

        .top-up-modal.active {
            display: flex !important;
        }

        .payment-methods {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .payment-method-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            width: 100%;
        }

        .payment-method-btn:active {
            transform: scale(0.98);
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
        }

        .payment-method-icon {
            font-size: 32px;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 12px;
        }

        .payment-method-info {
            flex: 1;
        }

        .payment-method-name {
            font-size: 16px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 4px;
        }

        .payment-method-desc {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
        }


        .payment-status {
            padding: 12px;
            border-radius: 12px;
            text-align: center;
            font-size: 14px;
            font-weight: 600;
        }

        .payment-status p {
            margin: 0;
        }


        .payment-section {
            margin-top: 10px;
        }

        .telegram-bot-info {
            background: rgba(0, 136, 204, 0.1);
            border: 1px solid rgba(0, 136, 204, 0.3);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
        }

        .telegram-bot-info p {
            margin: 5px 0;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        .telegram-bot-info .bot-instruction {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }

        .telegram-bot-btn {
            width: 100%;
            padding: 16px;
            border-radius: 16px;
            border: none;
            background: linear-gradient(135deg, #0088cc 0%, #006699 100%);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(0, 136, 204, 0.4);
            margin-bottom: 15px;
        }

        .telegram-bot-btn:active {
            transform: scale(0.98);
        }

        .telegram-bot-steps {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .telegram-bot-steps p {
            margin: 0 0 10px 0;
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            font-weight: 600;
        }

        .telegram-bot-steps ol {
            margin: 0;
            padding-left: 20px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
            line-height: 1.8;
        }

        .telegram-bot-steps code {
            background: rgba(102, 126, 234, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            color: #667eea;
        }

        .telegram-bot-steps span {
            color: #667eea;
            font-weight: 700;
        }

        .check-payment-btn {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .check-payment-btn:active {
            transform: scale(0.98);
            background: rgba(255, 255, 255, 0.15);
        }

        .inventory-section {
            margin-top: 30px;
        }

        .inventory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .inventory-title {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
        }

        .sell-all-btn {
            background: rgba(102, 126, 234, 0.3);
            border: 1px solid rgba(102, 126, 234, 0.5);
            color: #667eea;
            padding: 8px 16px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .sell-all-btn:active {
            transform: scale(0.98);
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .inventory-slot {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            cursor: pointer !important;
            pointer-events: auto !important;
            z-index: 10 !important;
            transition: all 0.3s;
        }

        .inventory-slot:active {
            transform: scale(0.95);
        }
        
        .inventory-slot:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.6);
        }

        .inventory-slot.has-item {
            border-color: rgba(102, 126, 234, 0.5);
            background: rgba(102, 126, 234, 0.1);
        }
        
        .inventory-slot.selected {
            border-color: #667eea !important;
            border-width: 3px !important;
            background: rgba(102, 126, 234, 0.3) !important;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.6) !important;
            transform: scale(1.05);
        }
        
        .inventory-slot.selected::before {
            content: '‚úì';
            position: absolute;
            top: 5px;
            right: 5px;
            background: #667eea;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            z-index: 5;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.5);
        }

        .inventory-slot img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .inventory-slot .empty-icon {
            font-size: 40px;
            color: rgba(255, 255, 255, 0.3);
        }

        .mines-page {
            padding: 20px;
            padding-bottom: 120px;
            min-height: 100vh;
            background: #0a0a0a;
            position: relative;
            z-index: 1;
        }

        .cases-page {
            padding: 20px;
            padding-bottom: 120px;
            min-height: 100vh;
            background: transparent;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            z-index: 100;
        }
        
        .cases-page .subscribe-btn {
            display: none !important;
        }
        
        .cases-container {
            display: flex !important;
            flex-direction: column;
            gap: 12px;
            align-items: center;
            justify-content: flex-start;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            padding: 12px;
            padding-top: 20px;
            visibility: visible !important;
            opacity: 1 !important;
            min-height: 200px;
        }
        
        .cases-container:empty::before {
            content: '–ó–∞–≥—Ä—É–∑–∫–∞ –∫–µ–π—Å–æ–≤...';
            color: rgba(255, 255, 255, 0.5);
            font-size: 14px;
        }

        .cases-header {
            text-align: center;
            padding: 12px;
            padding-top: 20px;
        }

        .cases-header h2 {
            font-size: 24px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 12px;
        }

        .case-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            border-radius: 16px;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.15);
            cursor: pointer;
            transition: all 0.4s;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            width: 100%;
        }

        .case-card:hover {
            transform: translateY(-2px);
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 6px 24px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%);
        }

        .case-icon {
            width: 80px;
            height: 80px;
            min-width: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .case-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }

        .case-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .case-name {
            font-size: 18px;
            font-weight: 700;
            color: #ffffff;
        }

        .case-description {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
        }

        .case-price {
            font-size: 16px;
            font-weight: 700;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-top: 4px;
        }

        .case-price .currency-icon {
            width: 14px;
            height: 14px;
        }

        .crash-page {
            padding: 20px;
            padding-bottom: 120px;
            min-height: 100vh;
            background: transparent;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            z-index: 100;
        }

        .crash-header {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 20px;
        }

        .crash-balance {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
        }

        .crash-graph-container {
            position: relative;
            width: 100%;
            height: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        #crashCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .crash-multiplier {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 12px;
            font-size: 28px;
            font-weight: 700;
            color: #00ff00;
            border: 2px solid #00ff00;
        }

        .crash-controls {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
        }

        .crash-bet-control {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .crash-bet-control label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            font-weight: 600;
        }

        .crash-input {
            padding: 10px 15px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
            font-weight: 600;
            width: 150px;
            text-align: right;
            box-sizing: border-box;
        }

        .crash-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .crash-bet-btn {
            width: 100%;
            padding: 18px;
            border-radius: 16px;
            border: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
        }

        .crash-bet-btn:active {
            transform: scale(0.98);
        }

        .crash-bet-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .crash-history-container {
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 15px;
        }

        .crash-history-header {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .crash-history-list {
            max-height: 200px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .crash-history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            font-size: 14px;
            gap: 10px;
        }

        .crash-history-item.empty {
            justify-content: center;
        }

        .crash-history-part {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            flex: 1;
        }

        .crash-history-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .crash-history-item.win {
            border-left: 3px solid #00ff00;
        }

        .crash-history-item.loss {
            border-left: 3px solid #ff0000;
        }

        .crash-history-bet {
            color: rgba(255, 255, 255, 0.7);
        }

        .crash-history-multiplier {
            color: #00ff00;
            font-weight: 600;
        }

        .crash-history-winnings {
            color: #00ff00;
            font-weight: 700;
        }

        .crash-history-loss {
            color: #ff0000;
            font-weight: 700;
            font-size: 18px;
        }

        .dice-page {
            padding: 20px;
            padding-bottom: 120px;
            min-height: 100vh;
            background: transparent;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            z-index: 100;
        }

        .dice-header {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .dice-balance {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 16px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            color: #ffffff;
            font-size: 18px;
            font-weight: 700;
        }

        .dice-game-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .dice-controls {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .dice-bet-control {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .dice-bet-control label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            font-weight: 600;
        }

        .dice-input {
            padding: 10px 15px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
            font-weight: 600;
            width: 150px;
            text-align: right;
            box-sizing: border-box;
        }

        .dice-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .dice-threshold-container {
            margin-bottom: 20px;
        }

        .dice-threshold-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 600;
        }

        .dice-threshold-label span:nth-child(2) {
            font-size: 20px;
            font-weight: 700;
            color: #ffffff;
        }

        .dice-slider-wrapper {
            position: relative;
        }

        .dice-slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(to right, #ff0000 0%, #00ff00 100%);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .dice-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ff0000;
            border: 3px solid #ffffff;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(255, 0, 0, 0.5);
        }

        .dice-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ff0000;
            border: 3px solid #ffffff;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(255, 0, 0, 0.5);
        }

        .dice-slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
        }

        .dice-roll-type {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .dice-roll-type-btn {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .dice-roll-type-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
        }

        .dice-roll-type-btn:active {
            transform: scale(0.95);
        }

        .dice-auto-control {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .dice-auto-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            font-weight: 600;
        }

        .dice-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .dice-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .dice-switch-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: 0.3s;
            border-radius: 30px;
        }

        .dice-switch-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        .dice-switch input:checked + .dice-switch-slider {
            background-color: #00ff00;
        }

        .dice-switch input:checked + .dice-switch-slider:before {
            transform: translateX(30px);
        }

        .dice-auto-status {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            font-weight: 600;
            min-width: 40px;
        }

        .dice-start-btn {
            width: 100%;
            padding: 18px;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, #00ff00 0%, #00cc00 100%);
            color: #000;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(0, 255, 0, 0.4);
            text-transform: uppercase;
        }

        .dice-start-btn:active {
            transform: scale(0.98);
        }

        .dice-start-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .dice-result-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
            text-align: center;
        }

        .dice-result-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .dice-result-value {
            font-size: 72px;
            font-weight: 700;
            color: #ffffff;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dice-result-text {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 600;
        }

        .dice-result-value.win {
            color: #00ff00;
        }

        .dice-result-value.lose {
            color: #ff0000;
        }

        .dice-stats {
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 15px;
        }

        .dice-stat-item {
            text-align: center;
        }

        .dice-stat-label {
            display: block;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            margin-bottom: 5px;
        }

        .dice-stat-item span:last-child {
            display: block;
            color: #ffffff;
            font-size: 18px;
            font-weight: 700;
        }

        .mines-header {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .mines-balance {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 16px;
            border: 2px solid rgba(102, 126, 234, 0.3);
            color: #ffffff;
            font-size: 18px;
            font-weight: 700;
        }

        .mines-game-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .mines-controls {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .mines-bet-control {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .mines-bet-control label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            font-weight: 600;
        }

        .mines-input {
            padding: 10px 15px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
            font-weight: 600;
            width: 150px;
            text-align: right;
            box-sizing: border-box;
        }

        .mines-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .mines-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .mines-count-control {
            margin-bottom: 15px;
        }

        .mines-count-control label {
            display: block;
            color: rgba(255, 255, 255, 0.8);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .mines-count-buttons {
            display: flex;
            gap: 10px;
        }

        .mines-count-btn {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.7);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mines-count-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
        }

        .mines-count-btn:active {
            transform: scale(0.95);
        }

        .mines-multiplier-display {
            text-align: center;
            margin-bottom: 15px;
        }

        .mines-multiplier-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
            margin-bottom: 5px;
        }

        .mines-multiplier-value {
            color: #00ff00;
            font-size: 28px;
            font-weight: 700;
        }

        .mines-cash-out-btn,
        .mines-start-btn {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            border: none;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .mines-start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
        }

        .mines-start-btn:active {
            transform: scale(0.98);
        }

        .mines-cash-out-btn {
            background: linear-gradient(135deg, #00ff00 0%, #00cc00 100%);
            color: #000;
            box-shadow: 0 4px 20px rgba(0, 255, 0, 0.4);
        }

        .mines-cash-out-btn:active {
            transform: scale(0.98);
        }

        .mines-cash-out-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .mines-grid-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .mines-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            max-width: 400px;
            margin: 0 auto;
        }

        .mines-cell {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }

        .mines-cell:active {
            transform: scale(0.95);
        }

        .mines-cell.opened {
            background: rgba(102, 126, 234, 0.3);
            border-color: rgba(102, 126, 234, 0.5);
            cursor: default;
        }

        .mines-cell.mine {
            background: #ff0000;
            border-color: #ff3333;
        }

        .mines-cell.safe {
            background: rgba(0, 255, 0, 0.2);
            border-color: rgba(0, 255, 0, 0.4);
        }

        .mines-stats {
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 15px;
        }

        .mines-stat-item {
            text-align: center;
        }

        .mines-stat-label {
            display: block;
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            margin-bottom: 5px;
        }

        .mines-stat-item span:last-child {
            display: block;
            color: #ffffff;
            font-size: 18px;
            font-weight: 700;
        }

        .inventory-slot .next-icon {
            font-size: 30px;
            color: rgba(255, 255, 255, 0.5);
        }

        .inventory-slot .item-value {
            position: absolute;
            bottom: 5px;
            left: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            padding: 4px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
            color: #00d4ff;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
        }

        .inventory-slot .item-value .currency-icon {
            width: 10px;
            height: 10px;
        }

        .crash-page {
            padding: 20px;
            padding-bottom: 120px;
            min-height: 100vh;
            background: transparent;
            position: relative;
            z-index: 1;
        }

        .crash-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .players-count {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(0, 255, 0, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            color: #00ff00;
            font-weight: 600;
            font-size: 14px;
        }

        .players-icon {
            font-size: 18px;
        }

        .crash-balance {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 16px;
            border-radius: 20px;
        }

        .crash-graph-container {
            width: 100%;
            height: 250px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .crash-graph {
            width: 100% !important;
            height: 250px !important;
            min-height: 250px !important;
            position: relative;
            display: block !important;
            visibility: visible !important;
            overflow: visible !important;
        }

        #crashCanvas {
            width: 100% !important;
            height: 250px !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            background: rgba(20, 20, 30, 1) !important;
        }

        .current-multiplier {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 12px;
            font-size: 24px;
            font-weight: 700;
            color: #00ff00;
            border: 2px solid #00ff00;
        }

        .crash-controls {
            margin-bottom: 20px;
        }

        .multiplier-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .multiplier-btn {
            cursor: pointer !important;
            pointer-events: auto !important;
            position: relative !important;
            z-index: 100 !important;
            padding: 10px 16px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .multiplier-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
        }

        .multiplier-btn:active {
            transform: scale(0.95);
        }

        .bet-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .bet-type-btn {
            cursor: pointer !important;
            pointer-events: auto !important;
            position: relative !important;
            z-index: 100 !important;
            flex: 1;
            padding: 12px 20px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.3s;
        }

        .bet-type-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
        }

        .bet-amount-input,
        .bet-item-select {
            width: 100%;
            padding: 14px 16px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
            margin-bottom: 15px;
            box-sizing: border-box;
        }

        .bet-amount-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .bet-amount-input:focus,
        .bet-item-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .make-bet-btn {
            width: 100%;
            padding: 18px;
            border-radius: 16px;
            border: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.4);
        }

        .make-bet-btn:active {
            transform: scale(0.98);
        }

        .make-bet-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .bets-list {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .bets-list-header {
            font-size: 18px;
            font-weight: 600;
            color: white;
            margin-bottom: 15px;
        }

        .bet-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            margin-bottom: 10px;
        }

        .bet-item-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .bet-item-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .bet-item-username {
            font-size: 14px;
            font-weight: 600;
            color: white;
        }

        .bet-item-details {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .bet-item-winnings {
            font-size: 16px;
            font-weight: 700;
            color: #00ff00;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .bet-item-winnings .currency-icon {
            width: 14px;
            height: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="profile-section">
            <div class="avatar">üë§</div>
            <div class="username" id="username">User</div>
        </div>
        <div class="balance-section">
            <span class="diamond-icon"></span>
            <span class="balance-text" id="balance">0.00</span>
            <button style="background: transparent; border: none; color: #ffffff; font-size: 18px; cursor: pointer; padding: 0 5px;">+</button>
        </div>
    </div>


    <div id="mainPage">
        <button class="subscribe-btn">
            <div class="subscribe-inner">
                <div class="subscribe-icon"></div>
                <span>–ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –Ω–∞—Å</span>
            </div>
            <div class="subscribe-action">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</div>
        </button>

    </div>

    <div class="modal" id="inventoryItemModal">
        <div class="modal-content inventory-modal-content">
            <button class="modal-close-btn" onclick="closeInventoryModal()">‚úï</button>
            <div class="inventory-modal-icon" id="inventoryModalIcon"></div>
            <div class="inventory-modal-name" id="inventoryModalName">–ü—Ä–µ–¥–º–µ—Ç</div>
            <div class="inventory-modal-price">
                <span class="price-label">–¶–µ–Ω–∞:</span>
                <span class="price-value" id="inventoryModalPrice"><span class="currency-icon"></span> 0.00</span>
            </div>
            <div class="inventory-modal-buttons">
                <button class="inventory-modal-btn sell-btn" id="sellItemBtn" onclick="try{if(typeof sellSelectedItem === 'function'){sellSelectedItem();}else if(typeof window.sellSelectedItem === 'function'){window.sellSelectedItem();}else{alert('–§—É–Ω–∫—Ü–∏—è sellSelectedItem –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');}}catch(e){console.error(e);alert('–û—à–∏–±–∫–∞: '+e.message);}">–ü—Ä–æ–¥–∞—Ç—å</button>
                <button class="inventory-modal-btn close-btn" onclick="closeInventoryModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div class="profile-page" id="profilePage" style="display: none;">
        <div class="profile-header">
            <div class="profile-avatar" id="profileAvatar">
                <img id="profileAvatarImg" src="" alt="Avatar">
            </div>
            <div class="profile-username" id="profileUsername">User</div>
        </div>

        <div class="top-up-buttons">
            <button class="top-up-btn primary" id="topUpBtn" onclick="try{window.handleTopUp(event);}catch(e){alert('–û—à–∏–±–∫–∞: '+e.message);}" style="cursor: pointer !important; pointer-events: auto !important; z-index: 999 !important;">
                <span class="btn-icon"><span class="currency-icon" style="width: 18px; height: 18px; display: inline-block;"></span></span>
                <span>–ü–æ–ø–æ–ª–Ω–∏—Ç—å</span>
            </button>
            <button class="top-up-btn secondary" id="withdrawBtn" onclick="try{window.handleWithdraw(event);}catch(e){alert('–û—à–∏–±–∫–∞: '+e.message);}" style="cursor: pointer !important; pointer-events: auto !important; z-index: 999 !important;">
                <span>–í—ã–≤–µ—Å—Ç–∏</span>
            </button>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
        <div class="top-up-modal" id="topUpModal" onclick="event.target === this && closeTopUpModal()">
            <div class="top-up-modal-content" onclick="event.stopPropagation()">
                <h3 class="top-up-modal-title">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
                <div class="payment-methods">
                    <button class="payment-method-btn" id="telegramWalletBtn" onclick="try{if(typeof processTelegramWalletTopUp === 'function'){processTelegramWalletTopUp();}else if(tg && tg.openTelegramLink){const userId=tg.initDataUnsafe?.user?.id || 'unknown';tg.openTelegramLink('https://t.me/your_bot?start=wallet_'+userId);}else{alert('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏');}}catch(e){console.error(e);alert('–û—à–∏–±–∫–∞: '+e.message);}">
                        <div class="payment-method-icon">üí≥</div>
                        <div class="payment-method-info">
                            <div class="payment-method-name">–ß–µ—Ä–µ–∑ Telegram Wallet</div>
                            <div class="payment-method-desc">–ë–æ—Ç —Å–æ–∑–¥–∞—Å—Ç –∏–Ω–≤–æ–π—Å –¥–ª—è –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ –∫–æ—à–µ–ª—ë–∫</div>
                        </div>
                    </button>
                    <button class="payment-method-btn" id="telegramBotBtn" onclick="try{if(typeof processTelegramBotTopUp === 'function'){processTelegramBotTopUp();}else if(tg && tg.openTelegramLink){const userId=tg.initDataUnsafe?.user?.id || 'unknown';tg.openTelegramLink('https://t.me/your_bot?start=topup_'+userId);}else{alert('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏');}}catch(e){console.error(e);alert('–û—à–∏–±–∫–∞: '+e.message);}">
                        <div class="payment-method-icon">ü§ñ</div>
                        <div class="payment-method-info">
                            <div class="payment-method-name">–ß–µ—Ä–µ–∑ –±–æ—Ç–∞ CryptoBot</div>
                            <div class="payment-method-desc">–ü–æ–ø–æ–ª–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –±–æ—Ç–∞ Telegram</div>
                        </div>
                    </button>
                </div>
                <button class="modal-close" onclick="closeTopUpModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –≤—ã–≤–æ–¥–∞ -->
        <div class="top-up-modal" id="withdrawModal" onclick="event.target === this && closeWithdrawModal()">
            <div class="top-up-modal-content" onclick="event.stopPropagation()">
                <h3 class="top-up-modal-title">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –≤—ã–≤–æ–¥–∞</h3>
                <div class="payment-methods">
                    <button class="payment-method-btn" id="withdrawTelegramWalletBtn" onclick="try{if(typeof processTelegramWalletWithdraw === 'function'){processTelegramWalletWithdraw();}else if(tg && tg.openTelegramLink){const userId=tg.initDataUnsafe?.user?.id || 'unknown';tg.openTelegramLink('https://t.me/your_bot?start=withdraw_wallet_'+userId);}else{alert('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏');}}catch(e){console.error(e);alert('–û—à–∏–±–∫–∞: '+e.message);}">
                        <div class="payment-method-icon">üí≥</div>
                        <div class="payment-method-info">
                            <div class="payment-method-name">–ß–µ—Ä–µ–∑ Telegram Wallet</div>
                            <div class="payment-method-desc">–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ Telegram –∫–æ—à–µ–ª—ë–∫</div>
                        </div>
                    </button>
                    <button class="payment-method-btn" id="withdrawTelegramBotBtn" onclick="try{if(typeof processTelegramBotWithdraw === 'function'){processTelegramBotWithdraw();}else if(tg && tg.openTelegramLink){const userId=tg.initDataUnsafe?.user?.id || 'unknown';tg.openTelegramLink('https://t.me/your_bot?start=withdraw_'+userId);}else{alert('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏');}}catch(e){console.error(e);alert('–û—à–∏–±–∫–∞: '+e.message);}">
                        <div class="payment-method-icon">ü§ñ</div>
                        <div class="payment-method-info">
                            <div class="payment-method-name">–ß–µ—Ä–µ–∑ –±–æ—Ç–∞ CryptoBot</div>
                            <div class="payment-method-desc">–í—ã–≤–µ—Å—Ç–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ Telegram</div>
                        </div>
                    </button>
                </div>
                <button class="modal-close" onclick="closeWithdrawModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>

        <div class="inventory-section">
            <div class="inventory-header">
                <span class="inventory-title">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å (<span id="inventoryCount">0</span>)</span>
                <button class="sell-all-btn" id="sellAllBtn" onclick="try{if(typeof sellAllItems === 'function'){sellAllItems();}else if(typeof window.sellAllItems === 'function'){window.sellAllItems();}else{alert('–§—É–Ω–∫—Ü–∏—è sellAllItems –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');}}catch(e){console.error(e);alert('–û—à–∏–±–∫–∞: '+e.message);}">–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ</button>
            </div>
            <div class="inventory-grid" id="inventoryGrid">
            </div>
        </div>
    </div>


    <div id="minesPage" class="mines-page" style="display: none;">
        <div class="mines-header">
            <div class="mines-balance">
                <span class="currency-icon"></span>
                <span id="minesBalance">0.00</span>
            </div>
        </div>
        
        <div class="mines-game-container">
            <div class="mines-controls">
                <div class="mines-bet-control">
                    <label>–°—Ç–∞–≤–∫–∞:</label>
                    <input type="number" id="minesBetAmount" class="mines-input" value="0.1" min="0.01" step="0.01" placeholder="0.00">
                </div>
                <div class="mines-count-control">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω:</label>
                    <div class="mines-count-buttons">
                        <button class="mines-count-btn" data-count="3" onclick="try{if(typeof minesGameState !== 'undefined'){minesGameState.minesCount=3;document.querySelectorAll('.mines-count-btn').forEach(b=>b.classList.remove('active'));event.target.closest('.mines-count-btn')?.classList.add('active');const totalCountEl=document.getElementById('minesTotalCount');if(totalCountEl){totalCountEl.textContent='3';}}else{alert('–ò–≥—Ä–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');}}catch(e){console.error(e);}">3</button>
                        <button class="mines-count-btn active" data-count="5" onclick="try{if(typeof minesGameState !== 'undefined'){minesGameState.minesCount=5;document.querySelectorAll('.mines-count-btn').forEach(b=>b.classList.remove('active'));event.target.closest('.mines-count-btn')?.classList.add('active');const totalCountEl=document.getElementById('minesTotalCount');if(totalCountEl){totalCountEl.textContent='5';}}else{alert('–ò–≥—Ä–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');}}catch(e){console.error(e);}">5</button>
                        <button class="mines-count-btn" data-count="10" onclick="try{if(typeof minesGameState !== 'undefined'){minesGameState.minesCount=10;document.querySelectorAll('.mines-count-btn').forEach(b=>b.classList.remove('active'));event.target.closest('.mines-count-btn')?.classList.add('active');const totalCountEl=document.getElementById('minesTotalCount');if(totalCountEl){totalCountEl.textContent='10';}}else{alert('–ò–≥—Ä–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');}}catch(e){console.error(e);}">10</button>
                    </div>
                </div>
                <div class="mines-multiplier-display">
                    <div class="mines-multiplier-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å:</div>
                    <div class="mines-multiplier-value" id="minesMultiplier">x1.00</div>
                </div>
                <button id="minesCashOutBtn" class="mines-cash-out-btn" onclick="try{if(typeof cashOutMines === 'function'){cashOutMines();}else if(typeof window.cashOutMines === 'function'){window.cashOutMines();}else{alert('–§—É–Ω–∫—Ü–∏—è cashOutMines –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');}}catch(e){console.error(e);alert('–û—à–∏–±–∫–∞: '+e.message);}" disabled>–ó–∞–±—Ä–∞—Ç—å</button>
                <button id="minesStartBtn" class="mines-start-btn" onclick="try{window.handleMinesStart(event);}catch(e){alert('–û—à–∏–±–∫–∞: '+e.message);}" style="cursor: pointer !important; pointer-events: auto !important; z-index: 999 !important;">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
            </div>
            
            <div class="mines-grid-container">
                <div id="minesGrid" class="mines-grid"></div>
            </div>
            
            <div class="mines-stats">
                <div class="mines-stat-item">
                    <span class="mines-stat-label">–û—Ç–∫—Ä—ã—Ç–æ:</span>
                    <span id="minesOpenedCount">0</span>
                </div>
                <div class="mines-stat-item">
                    <span class="mines-stat-label">–ú–∏–Ω—ã:</span>
                    <span id="minesTotalCount">5</span>
                </div>
                <div class="mines-stat-item">
                    <span class="mines-stat-label">–í—ã–∏–≥—Ä—ã—à:</span>
                    <span id="minesWinnings">0.00</span>
                </div>
            </div>
        </div>
    </div>

    <div id="dicePage" class="dice-page" style="display: none;">
        <div class="dice-header">
            <div class="dice-balance">
                <span class="currency-icon"></span>
                <span id="diceBalance">0.00</span>
            </div>
        </div>
        
        <div class="dice-game-container">
            <div class="dice-controls">
                <div class="dice-bet-control">
                    <label>–°—Ç–∞–≤–∫–∞:</label>
                    <input type="number" id="diceBetAmount" class="dice-input" value="0.1" min="0.01" step="0.01" placeholder="0.00">
                </div>
                
                <div class="dice-threshold-container">
                    <div class="dice-threshold-label">
                        <span>Roll Under</span>
                        <span id="diceThresholdValue">50</span>
                        <span>Roll Over</span>
                    </div>
                    <div class="dice-slider-wrapper">
                        <input type="range" id="diceThreshold" class="dice-slider" min="1" max="98" value="50">
                        <div class="dice-slider-labels">
                            <span>0</span>
                            <span>99</span>
                        </div>
                    </div>
                </div>
                
                <div class="dice-roll-type">
                    <button id="diceRollUnderBtn" class="dice-roll-type-btn active" onclick="try{if(typeof diceGameState !== 'undefined'){diceGameState.rollType='under';document.getElementById('diceRollUnderBtn')?.classList.add('active');document.getElementById('diceRollOverBtn')?.classList.remove('active');}else{alert('–ò–≥—Ä–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');}}catch(e){console.error(e);}">Roll Under</button>
                    <button id="diceRollOverBtn" class="dice-roll-type-btn" onclick="try{if(typeof diceGameState !== 'undefined'){diceGameState.rollType='over';document.getElementById('diceRollOverBtn')?.classList.add('active');document.getElementById('diceRollUnderBtn')?.classList.remove('active');}else{alert('–ò–≥—Ä–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');}}catch(e){console.error(e);}">Roll Over</button>
                </div>
                
                <div class="dice-auto-control">
                    <span class="dice-auto-label">AUTO</span>
                    <label class="dice-switch">
                        <input type="checkbox" id="diceAutoToggle">
                        <span class="dice-switch-slider"></span>
                    </label>
                    <span class="dice-auto-status" id="diceAutoStatus">OFF</span>
                </div>
                
                <button id="diceStartBtn" class="dice-start-btn" onclick="try{window.handleDiceStart(event);}catch(e){alert('–û—à–∏–±–∫–∞: '+e.message);}" style="cursor: pointer !important; pointer-events: auto !important; z-index: 999 !important;">START</button>
            </div>
            
            <div class="dice-result-container">
                <div class="dice-result-display" id="diceResultDisplay">
                    <div class="dice-result-value" id="diceResultValue">?</div>
                    <div class="dice-result-text" id="diceResultText">–ù–∞–∂–º–∏—Ç–µ START</div>
                </div>
            </div>
            
            <div class="dice-stats">
                <div class="dice-stat-item">
                    <span class="dice-stat-label">–í—ã–∏–≥—Ä—ã—à:</span>
                    <span id="diceWinnings">0.00</span>
                </div>
                <div class="dice-stat-item">
                    <span class="dice-stat-label">–ú–Ω–æ–∂–∏—Ç–µ–ª—å:</span>
                    <span id="diceMultiplier">x2.00</span>
                </div>
            </div>
        </div>
    </div>

    <div id="casesPage" class="cases-page" style="display: block;">
        <div class="cases-header">
            <h2>–ö–µ–π—Å—ã</h2>
        </div>
        <div class="cases-container" id="casesContainer">
        </div>
        <script>
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–µ–π—Å–æ–≤ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            (function() {
                setTimeout(function() {
                    if (typeof window.loadCases === 'function') {
                        console.log('üîµ –ü—Ä—è–º–æ–π –≤—ã–∑–æ–≤ loadCases –∏–∑ HTML');
                        window.loadCases();
                    } else {
                        console.error('‚ùå window.loadCases –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ HTML');
                    }
                }, 100);
            })();
        </script>
    </div>

    <div id="caseDetailPage" class="case-detail-page" style="display: none;">
        <button class="back-btn" onclick="goBackFromCase()" style="position: relative; z-index: 10; background: rgba(102, 126, 234, 0.3); border: 2px solid rgba(102, 126, 234, 0.5); color: white; padding: 12px 24px; border-radius: 16px; font-size: 16px; font-weight: 600; cursor: pointer; margin: 20px;">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="case-detail-header">
            <div class="case-detail-icon" id="detailIcon"></div>
            <div class="case-detail-price" id="detailPrice">0.1 <span class="currency-icon"></span></div>
        </div>
        
        <button class="open-case-btn" id="openCaseBtn" onclick="try{console.log('üîµ –ü—Ä—è–º–æ–π onclick –Ω–∞ –∫–Ω–æ–ø–∫–µ');if(typeof window.openCase === 'function'){console.log('‚úÖ –í—ã–∑—ã–≤–∞—é window.openCase');window.openCase();}else{alert('–§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –¢–∏–ø: '+typeof window.openCase);console.error('‚ùå window.openCase:', typeof window.openCase);}}catch(e){console.error('–û—à–∏–±–∫–∞ –≤ onclick:',e);alert('–û—à–∏–±–∫–∞: '+e.message);}return false;">–û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å</button>
        
        <div class="whats-inside-title">–ß—Ç–æ –º–æ–∂–µ—Ç –≤—ã–ø–∞—Å—Ç—å?</div>
        <div class="prizes-grid" id="prizesGrid">
        </div>
        
        <div id="rouletteContainer" class="roulette-container" style="display: none;">
            <div class="roulette-wrapper">
                <div class="roulette-prize" id="roulettePrize"></div>
                <div class="roulette-arrow"></div>
            </div>
        </div>
        
        <div id="prizeModal" class="prize-modal" style="display: none;">
            <div class="prize-modal-content">
                <div class="prize-modal-title">–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!</div>
                <div class="prize-modal-icon" id="prizeModalIcon"></div>
                <div class="prize-modal-value" id="prizeModalValue"></div>
                <button class="prize-modal-btn" onclick="closePrizeModal()">–ó–∞–±—Ä–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="crashPage" class="crash-page" style="display: none;">
        <div class="crash-header">
            <div class="crash-balance">
                <span class="currency-icon"></span>
                <span id="crashBalance">0.00</span>
                <button style="background: transparent; border: none; color: #ffffff; font-size: 18px; cursor: pointer; padding: 0 5px;" onclick="try{window.handleTopUp(event);}catch(e){alert('–û—à–∏–±–∫–∞: '+e.message);}">+</button>
            </div>
        </div>

        <div class="crash-graph-container">
            <canvas id="crashCanvas"></canvas>
            <div class="crash-multiplier" id="crashMultiplier">x1.00</div>
        </div>

        <div class="crash-controls">
            <div class="crash-bet-control">
                <label>–°—Ç–∞–≤–∫–∞:</label>
                <input type="number" id="crashBetAmount" class="crash-input" value="0.1" min="0.01" step="0.01" placeholder="0.00">
            </div>
            <button id="crashBetBtn" class="crash-bet-btn" onclick="try{console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –∫—Ä–∞—à, hasBet:', typeof crashGameState !== 'undefined' ? crashGameState.hasBet : 'undefined');window.handleCrashBet(event);}catch(e){alert('–û—à–∏–±–∫–∞: '+e.message);console.error(e);}" style="cursor: pointer !important; pointer-events: auto !important; z-index: 999 !important;">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
        </div>
        
        <div class="crash-history-container">
            <div class="crash-history-header">–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</div>
            <div id="crashHistory" class="crash-history-list"></div>
        </div>
    </div>

    <div class="bottom-nav" id="bottomNav">
        <div class="nav-item active" data-page="cases" onclick="handleNavClick('cases', this)">
            <div class="nav-icon">üéÅ</div>
            <div class="nav-label">–ö–µ–π—Å—ã</div>
        </div>
        <div class="nav-item" data-page="crash" onclick="handleNavClick('crash', this)">
            <div class="nav-icon">üöÄ</div>
            <div class="nav-label">–ö—Ä–∞—à</div>
        </div>
        <div class="nav-item" data-page="mines" onclick="handleNavClick('mines', this)">
            <div class="nav-icon">üí£</div>
            <div class="nav-label">–ú–∏–Ω—ã</div>
        </div>
        <div class="nav-item" data-page="dice" onclick="handleNavClick('dice', this)">
            <div class="nav-icon">üé≤</div>
            <div class="nav-label">Dice</div>
        </div>
        <div class="nav-item" data-page="profile" onclick="handleNavClick('profile', this)">
            <div class="nav-icon">üë§</div>
            <div class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
        </div>
    </div>

    <script>
        console.log('‚úÖ JAVASCRIPT –†–ê–ë–û–¢–ê–ï–¢!');
        
        // ===== –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò - –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–£–ï–ú –°–†–ê–ó–£ =====
        // –î–µ–ª–∞–µ–º –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Å—Ä–∞–∑—É
        
        // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ö–ï–ô–°–ê #1
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã –ú–∏–Ω—ã
        let minesGameState = {
            grid: [],
            mines: [],
            opened: [],
            gameActive: false,
            betAmount: 0.1,
            currentMultiplier: 1.0,
            minesCount: 5,
            gridSize: 25
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã Crash
        let crashGameState = {
            multiplier: 1.00,
            targetMultiplier: 2.0,
            isRunning: false,
            isCooldown: false,
            hasBet: false,
            betAmount: 0,
            animationId: null,
            graphPoints: [],
            cooldownRemaining: 0,
            cooldownInterval: null,
            speedVariation: 0.02,
            history: [] // –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã Dice
        let diceGameState = {
            betAmount: 0.1,
            threshold: 50,
            rollType: 'under',
            autoPlay: false,
            autoPlayInterval: null,
            isRolling: false
        };
        
        console.log('‚úÖ –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
        
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò - –û–ü–†–ï–î–ï–õ–Ø–ï–ú –°–†–ê–ó–£ –í –ù–ê–ß–ê–õ–ï –°–ö–†–ò–ü–¢–ê
        // –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è inline onclick
        
        window.handleMinesStart = function(e) {
            console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –º–∏–Ω—ã');
            try {
                if (typeof window.startMinesGame === 'function') {
                    window.startMinesGame();
                } else if (typeof startMinesGame === 'function') {
                    startMinesGame();
                } else {
                    alert('–û—à–∏–±–∫–∞: startMinesGame –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                    console.error('startMinesGame –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
                }
            } catch(err) {
                console.error('–û—à–∏–±–∫–∞ handleMinesStart:', err);
                alert('–û—à–∏–±–∫–∞: ' + err.message);
            }
        };
        
        window.handleDiceStart = function(e) {
            console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ dice');
            try {
                if (typeof window.startDiceGame === 'function') {
                    window.startDiceGame();
                } else if (typeof startDiceGame === 'function') {
                    startDiceGame();
                } else {
                    alert('–û—à–∏–±–∫–∞: startDiceGame –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                    console.error('startDiceGame –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
                }
            } catch(err) {
                console.error('–û—à–∏–±–∫–∞ handleDiceStart:', err);
                alert('–û—à–∏–±–∫–∞: ' + err.message);
            }
        };
        
        window.handleTopUp = function(e) {
            console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ø–æ–ø–æ–ª–Ω–∏—Ç—å');
            try {
                if (typeof window.openTopUpModal === 'function') {
                    window.openTopUpModal();
                } else if (typeof openTopUpModal === 'function') {
                    openTopUpModal();
                } else {
                    alert('–û—à–∏–±–∫–∞: openTopUpModal –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                    console.error('openTopUpModal –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
                }
            } catch(err) {
                console.error('–û—à–∏–±–∫–∞ handleTopUp:', err);
                alert('–û—à–∏–±–∫–∞: ' + err.message);
            }
        };
        
        window.handleWithdraw = function(e) {
            console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –≤—ã–≤–µ—Å—Ç–∏');
            try {
                if (typeof window.openWithdrawModal === 'function') {
                    window.openWithdrawModal();
                } else if (typeof openWithdrawModal === 'function') {
                    openWithdrawModal();
                } else {
                    alert('–û—à–∏–±–∫–∞: openWithdrawModal –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                    console.error('openWithdrawModal –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
                }
            } catch(err) {
                console.error('–û—à–∏–±–∫–∞ handleWithdraw:', err);
                alert('–û—à–∏–±–∫–∞: ' + err.message);
            }
        };

        window.handleCrashBet = function(e) {
            console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –∫—Ä–∞—à —Å—Ç–∞–≤–∫–∞');
            try {
                if (typeof window.makeCrashBet === 'function') {
                    window.makeCrashBet();
                } else if (typeof makeCrashBet === 'function') {
                    makeCrashBet();
                } else {
                    alert('–û—à–∏–±–∫–∞: makeCrashBet –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                    console.error('makeCrashBet –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
                }
            } catch(err) {
                console.error('–û—à–∏–±–∫–∞ handleCrashBet:', err);
                alert('–û—à–∏–±–∫–∞: ' + err.message);
            }
        };
        
        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = null;
        let isTelegram = false;
        
        try {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Telegram Web App API
            if (typeof window !== 'undefined' && window.Telegram && window.Telegram.WebApp) {
                tg = window.Telegram.WebApp;
                console.log('‚úÖ Telegram Web App API –Ω–∞–π–¥–µ–Ω');
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ API –¥–æ—Å—Ç—É–ø–µ–Ω, —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
                try {
                    if (tg && typeof tg.ready === 'function') {
            tg.ready();
                        console.log('‚úÖ Telegram Web App –≥–æ—Ç–æ–≤');
                    }
                } catch (err) {
                    console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ tg.ready():', err.message);
                }
                
                try {
                    if (tg && typeof tg.expand === 'function') {
            tg.expand();
                        console.log('‚úÖ Telegram Web App —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç');
                    }
                } catch (err) {
                    console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ tg.expand():', err.message);
                }
                
                try {
                    if (tg && typeof tg.setHeaderColor === 'function') {
            tg.setHeaderColor('#0a0a0a');
                    }
                } catch (err) {
                    console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ tg.setHeaderColor():', err.message);
                }
                
                try {
                    if (tg && typeof tg.setBackgroundColor === 'function') {
            tg.setBackgroundColor('#0a0a0a');
                    }
                } catch (err) {
                    console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ tg.setBackgroundColor():', err.message);
                }
                
            isTelegram = true;
                console.log('‚úÖ Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                // –í—ã–∑—ã–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                if (typeof updateHeaderAvatar === 'function') {
                    setTimeout(updateHeaderAvatar, 500);
                }
            } else {
                console.warn('‚ö†Ô∏è Telegram Web App API –Ω–µ –Ω–∞–π–¥–µ–Ω - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–µ–∂–∏–º–µ –±—Ä–∞—É–∑–µ—Ä–∞');
                console.log('‚ÑπÔ∏è –ï—Å–ª–∏ –≤—ã —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –í Telegram Mini App –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.');
                // –°–æ–∑–¥–∞—ë–º –∑–∞–≥–ª—É—à–∫—É –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
                tg = {
                    initDataUnsafe: {
                        user: {
                            id: Math.floor(Math.random() * 1000000),
                            first_name: null, // –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–ª—É—à–∫—É, —á—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
                            username: null,
                            photo_url: null
                        }
                    },
                    showAlert: function(text) { alert(text); },
                    showConfirm: function(text, callback) { callback(confirm(text)); },
                    HapticFeedback: {
                        impactOccurred: function(type) { console.log('Haptic:', type); },
                        notificationOccurred: function(type) { console.log('Notification:', type); }
                    },
                    openTelegramLink: function(url) { window.open(url, '_blank'); },
                    openLink: function(url) { window.open(url, '_blank'); }
                };
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram Web App:', error);
            // –°–æ–∑–¥–∞—ë–º –∑–∞–≥–ª—É—à–∫—É –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
            tg = {
                initDataUnsafe: {
                    user: {
                        id: Math.floor(Math.random() * 1000000),
                        first_name: null, // –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–ª—É—à–∫—É
                        username: null,
                        photo_url: null
                    }
                },
                showAlert: function(text) { alert(text); },
                showConfirm: function(text, callback) { callback(confirm(text)); },
                HapticFeedback: {
                    impactOccurred: function(type) { console.log('Haptic:', type); },
                    notificationOccurred: function(type) { console.log('Notification:', type); }
                },
                openTelegramLink: function(url) { window.open(url, '_blank'); },
                openLink: function(url) { window.open(url, '_blank'); }
            };
        }

        // ========== –ó–ê–©–ò–¢–ê –§–†–û–ù–¢–ï–ù–î–ê ==========
        
        // –ó–∞—â–∏—â—ë–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±–∞–ª–∞–Ω—Å–∞
        let _balance = 100.00; // –¢–µ—Å—Ç–æ–≤—ã–π –±–∞–ª–∞–Ω—Å
        let balanceLocked = false;
        let isServerValidated = false;
        
        // –ì–µ—Ç—Ç–µ—Ä/—Å–µ—Ç—Ç–µ—Ä –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ —Å –∑–∞—â–∏—Ç–æ–π
        Object.defineProperty(window, 'balance', {
            get: function() { return _balance; },
            set: function(val) {
                console.warn('‚ö†Ô∏è –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ balance –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ API.');
                return false;
            },
            configurable: false
        });
        
        // –§—É–Ω–∫—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∞–ª–∞–Ω—Å–∞ —Ç–æ–ª—å–∫–æ —Å —Å–µ—Ä–≤–µ—Ä–∞
        function setBalanceFromServer(newBalance) {
            const validated = parseFloat(newBalance);
            if (!isNaN(validated) && validated >= 0 && validated <= 1000000) {
                _balance = validated;
                updateBalanceDisplay();
                isServerValidated = true;
                return true;
            }
            console.error('‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞:', newBalance);
            return false;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
        function changeBalance(amount, source = 'unknown') {
            if (balanceLocked) {
                console.warn('‚ö†Ô∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ');
                return false;
            }
            
            const validated = parseFloat(amount);
            if (isNaN(validated) || Math.abs(validated) > 1000000) {
                console.error('‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:', amount);
                return false;
            }
            
            const newBalance = _balance + validated;
            if (newBalance < 0 || newBalance > 1000000) {
                console.error('‚ùå –ë–∞–ª–∞–Ω—Å –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã:', newBalance);
                return false;
            }
            
            const oldBalance = _balance;
            _balance = newBalance;
            updateBalanceDisplay();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ —Å—Ä–∞–∑—É
            try {
                localStorage.setItem('userBalance', _balance.toString());
                console.log('‚úÖ –ë–∞–ª–∞–Ω—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ:', _balance);
            } catch (e) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –ª–æ–∫–∞–ª—å–Ω–æ:', e);
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)
            saveUserData().catch(error => {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', error);
            });
            
            console.log(`‚úÖ –ë–∞–ª–∞–Ω—Å –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ ${validated} –∏–∑ ${source}. –°—Ç–∞—Ä—ã–π: ${oldBalance}, –ù–æ–≤—ã–π: ${_balance}`);
            return true;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
        function updateBalanceDisplay() {
            try {
                const balanceEl = document.getElementById('balance');
                const crashBalanceEl = document.getElementById('crashBalance');
                const minesBalanceEl = document.getElementById('minesBalance');
                const diceBalanceEl = document.getElementById('diceBalance');
                
                const balanceValue = _balance.toFixed(2);
                
                if (balanceEl) {
                    balanceEl.textContent = balanceValue;
                    console.log('‚úÖ –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ header:', balanceValue);
                }
                if (crashBalanceEl) {
                    crashBalanceEl.textContent = balanceValue;
                    console.log('‚úÖ –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ –∫—Ä–∞—à–µ:', balanceValue);
                }
                if (minesBalanceEl) {
                    minesBalanceEl.textContent = balanceValue;
                    console.log('‚úÖ –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ –º–∏–Ω–∞—Ö:', balanceValue);
                }
                if (diceBalanceEl) {
                    diceBalanceEl.textContent = balanceValue;
                    console.log('‚úÖ –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ dice:', balanceValue);
                }
                
                console.log('üí∞ –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å:', _balance);
            } catch(err) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', err);
            }
        }
        
        // –°–¥–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≥–ª–æ–±–∞–ª—å–Ω–æ–π
        window.updateBalanceDisplay = updateBalanceDisplay;
        
        // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π
        const protectedFunctions = {
            setBalanceFromServer,
            changeBalance,
            updateBalanceDisplay
        };
        Object.freeze(protectedFunctions);
        
        let currentTab = 'cases';
        
        
        // API —ç–Ω–¥–ø–æ–∏–Ω—Ç (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä)
        const API_BASE_URL = 'http://localhost:3000/api'; // –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—ã–∏–≥—Ä—ã—à–µ–π –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        let globalPrizes = [];
        
        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤—ã–∏–≥—Ä–∞–Ω–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏)
        let userInventory = [];
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram (–∑–∞—â–∏—â—ë–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
        function getUserId() {
            if (!tg || !tg.initDataUnsafe) {
                console.warn('‚ö†Ô∏è Telegram Web App –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                return null;
            }
            
            const user = tg.initDataUnsafe.user;
            if (!user || !user.id) {
                console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                return null;
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è userId (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º)
            const userId = String(user.id);
            if (!/^\d+$/.test(userId)) {
                console.error('‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç userId:', userId);
                return null;
            }
            
            return userId;
        }
        
        // –ó–∞—â–∏—â—ë–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
        function makeProtectedRequest(url, options = {}) {
            const userId = getUserId();
            if (!userId) {
                return Promise.reject(new Error('User ID –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω'));
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è URL (–∑–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –∏ SSRF)
            if (!url || typeof url !== 'string' || !url.startsWith(API_BASE_URL)) {
                console.error('‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞:', url);
                return Promise.reject(new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL'));
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ (–∑–∞—â–∏—Ç–∞ –æ—Ç XSS)
            if (options.body) {
                try {
                    const parsed = typeof options.body === 'string' ? JSON.parse(options.body) : options.body;
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
                    const bodyStr = JSON.stringify(parsed);
                    if (bodyStr.includes('<script') || bodyStr.includes('javascript:') || bodyStr.includes('onerror=')) {
                        console.error('‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω –æ–ø–∞—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞');
                        return Promise.reject(new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ'));
                    }
                } catch (e) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞:', e);
                    return Promise.reject(new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ'));
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º userId –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
            const headers = {
                'Content-Type': 'application/json',
                'X-User-ID': userId,
                ...options.headers
            };
            
            return fetch(url, {
                ...options,
                headers
            }).catch(error => {
                console.error('‚ùå –û—à–∏–±–∫–∞ API –∑–∞–ø—Ä–æ—Å–∞:', error);
                throw error;
            });
        }
        
        // –ó–∞—â–∏—Ç–∞ –æ—Ç XSS - —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
        function sanitizeText(text) {
            if (typeof text !== 'string') return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // –ó–∞—â–∏—Ç–∞ –æ—Ç –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å
        (function() {
            const originalConsole = window.console;
            const protectedKeys = ['balance', '_balance', 'changeBalance', 'setBalanceFromServer'];
            
            protectedKeys.forEach(key => {
                Object.defineProperty(window, key, {
                    get: function() {
                        if (key === 'balance') return _balance;
                        return undefined;
                    },
                    set: function() {
                        console.warn('‚ö†Ô∏è –ü—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ');
                    },
                    configurable: false
                });
            });
        })();
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUsername() {
            const user = tg?.initDataUnsafe?.user;
            return user?.username || user?.first_name || 'Unknown';
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserPhotoUrl() {
            const user = tg?.initDataUnsafe?.user;
            return user?.photo_url || null;
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Å–µ—Ä–≤–µ—Ä–∞ (–±–∞–ª–∞–Ω—Å –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å)
        async function loadUserData() {
            const userId = getUserId();
            if (!userId) {
                console.log('User ID not available, using local storage');
                loadInventory();
                return;
            }
            
            // –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –æ–Ω –±–æ–ª—å—à–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ)
            const localBalance = localStorage.getItem('userBalance');
            const localBalanceValue = localBalance ? parseFloat(localBalance) : null;
            
            try {
                const response = await makeProtectedRequest(`${API_BASE_URL}/users/${userId}`);
                
                if (response.ok) {
                    const data = await response.json();
                    if (data) {
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∞–ª–∞–Ω—Å —Å —Å–µ—Ä–≤–µ—Ä–∞ (–∑–∞—â–∏—â—ë–Ω–Ω–æ)
                        if (data.balance !== undefined) {
                            const serverBalance = parseFloat(data.balance);
                            
                            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª—å—à–∏–π –±–∞–ª–∞–Ω—Å (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã–π)
                            // –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ—Ç–µ—Ä–∏ –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
                            if (localBalanceValue !== null && localBalanceValue > serverBalance) {
                                console.log(`‚ö†Ô∏è –õ–æ–∫–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å (${localBalanceValue}) –±–æ–ª—å—à–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ (${serverBalance}), –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π`);
                                setBalanceFromServer(localBalanceValue);
                                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–æ–ª—å—à–∏–π –±–∞–ª–∞–Ω—Å –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                                saveUserData().catch(err => console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', err));
                            } else {
                                setBalanceFromServer(serverBalance);
                            }
                        } else if (localBalanceValue !== null) {
                            // –ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ—Ç –±–∞–ª–∞–Ω—Å–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π
                            console.log('‚ö†Ô∏è –ë–∞–ª–∞–Ω—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π:', localBalanceValue);
                            setBalanceFromServer(localBalanceValue);
                            saveUserData().catch(err => console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', err));
                        }
                        
                        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å - –æ–±—ä–µ–¥–∏–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã–π
                        const localInventory = localStorage.getItem('userInventory');
                        let localInventoryArray = [];
                        if (localInventory) {
                            try {
                                localInventoryArray = JSON.parse(localInventory);
                                if (!Array.isArray(localInventoryArray)) {
                                    localInventoryArray = [];
                                }
                            } catch (e) {
                                console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:', e);
                                localInventoryArray = [];
                            }
                        }
                        
                        const serverInventory = (data.inventory && Array.isArray(data.inventory)) ? data.inventory : [];
                        
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                        // –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ—Ç–µ—Ä–∏ –ø–æ–¥–∞—Ä–∫–æ–≤ –ø—Ä–∏ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
                        if (localInventoryArray.length > serverInventory.length) {
                            console.log(`‚ö†Ô∏è –õ–æ–∫–∞–ª—å–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (${localInventoryArray.length} –ø—Ä–µ–¥–º–µ—Ç–æ–≤) –±–æ–ª—å—à–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ (${serverInventory.length}), –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π`);
                            userInventory = localInventoryArray;
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–æ–ª—å—à–∏–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                            saveUserData().catch(err => console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:', err));
                        } else if (serverInventory.length > 0) {
                            console.log(`‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (${serverInventory.length} –ø—Ä–µ–¥–º–µ—Ç–æ–≤)`);
                            userInventory = serverInventory;
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                            try {
                                localStorage.setItem('userInventory', JSON.stringify(userInventory));
                            } catch (e) {
                                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –ª–æ–∫–∞–ª—å–Ω–æ:', e);
                            }
                        } else {
                            // –ï—Å–ª–∏ –æ–±–∞ –ø—É—Å—Ç—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π (–º–æ–∂–µ—Ç —Ç–∞–º —á—Ç–æ-—Ç–æ –µ—Å—Ç—å)
                            userInventory = localInventoryArray;
                            console.log('‚ö†Ô∏è –û–±–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –ø—É—Å—Ç—ã–µ –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π');
                        }
                        
                        updateInventory();
                    }
                } else {
                    console.log('Failed to load user data, using local storage');
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
                    if (localBalanceValue !== null) {
                        setBalanceFromServer(localBalanceValue);
                    }
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–∑ localStorage
                    loadInventory();
                }
            } catch (error) {
                console.error('Error loading user data:', error);
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø—Ä–∏ –æ—à–∏–±–∫–µ
                if (localBalanceValue !== null) {
                    setBalanceFromServer(localBalanceValue);
                }
                loadInventory();
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–±–∞–ª–∞–Ω—Å –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å)
        async function saveUserData() {
            const userId = getUserId();
            if (!userId) {
                console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å userId –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                saveInventory();
                return;
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è: –±–∞–ª–∞–Ω—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞
            if (!isServerValidated && _balance > 10000) {
                console.warn('‚ö†Ô∏è –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–æ–π –±–∞–ª–∞–Ω—Å –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞');
            }
            
            try {
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
                if (_balance < 0 || _balance > 1000000 || !Array.isArray(userInventory)) {
                    console.error('‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                    return;
                }
                
                const userData = {
                    userId: userId,
                    username: getUsername(),
                    balance: _balance, // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞—â–∏—â—ë–Ω–Ω—ã–π –±–∞–ª–∞–Ω—Å
                    inventory: userInventory,
                    updatedAt: Date.now()
                };
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è userId –≤ URL (–∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–º–µ–Ω—ã)
                const validatedUserId = getUserId();
                if (validatedUserId !== userId) {
                    console.error('‚ùå –ü–æ–ø—ã—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏–º userId');
                    return;
                }
                
                const response = await makeProtectedRequest(`${API_BASE_URL}/users/${userId}`, {
                    method: 'POST',
                    body: JSON.stringify(userData)
                });
                
                if (response.ok) {
                    console.log('User data saved successfully');
                    // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞
                    saveInventory();
                } else {
                    console.error('Failed to save user data to server');
                    saveInventory();
                }
            } catch (error) {
                console.error('Error saving user data:', error);
                // –ü—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
                saveInventory();
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –∏–∑ localStorage
        function loadInventory() {
            try {
                const stored = localStorage.getItem('userInventory');
                const storedBalance = localStorage.getItem('userBalance');
                
                if (stored) {
                    const parsed = JSON.parse(stored);
                    if (Array.isArray(parsed)) {
                        userInventory = parsed;
                        console.log('‚úÖ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ localStorage:', userInventory.length, '–ø—Ä–µ–¥–º–µ—Ç–æ–≤');
                    } else {
                        console.warn('‚ö†Ô∏è –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –≤ localStorage –Ω–µ –º–∞—Å—Å–∏–≤, —Å–æ–∑–¥–∞—é –ø—É—Å—Ç–æ–π');
                        userInventory = [];
                    }
                } else {
                    console.log('‚ÑπÔ∏è –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –≤ localStorage –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞—é –ø—É—Å—Ç–æ–π');
                    userInventory = [];
                }
                
                if (storedBalance) {
                    setBalanceFromServer(parseFloat(storedBalance) || 100.00);
                }
                
                updateInventory();
            } catch (e) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:', e);
                userInventory = [];
                updateInventory();
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –≤ localStorage
        function saveInventory() {
            try {
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
                if (!Array.isArray(userInventory)) {
                    console.error('‚ùå –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º');
                    userInventory = [];
                }
                
                localStorage.setItem('userInventory', JSON.stringify(userInventory));
                
                // –í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å –≤ localStorage
                const balanceToSave = _balance.toString();
                localStorage.setItem('userBalance', balanceToSave);
                console.log('‚úÖ –ë–∞–ª–∞–Ω—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage:', balanceToSave);
            } catch (e) {
                console.error('Failed to save inventory:', e);
            }
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
        function addToInventory(prize) {
            userInventory.push({
                icon: prize.icon,
                name: prize.name,
                value: prize.value,
                timestamp: Date.now(),
                id: Date.now() + Math.random()
            });
            saveInventory();
            saveUserData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            updateInventory();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω—ã —Å –∏–∫–æ–Ω–∫–æ–π –≤–∞–ª—é—Ç—ã
        function formatPrice(value) {
            return `<span class="currency-icon"></span>${value.toFixed(2)}`;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤—ã–∏–≥—Ä—ã—à–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        async function sendPrizeToServer(prize) {
            try {
                const user = tg?.initDataUnsafe?.user;
                const userId = user?.id || null;
                const username = user?.username || user?.first_name || 'Unknown';
                
                const response = await fetch(`${API_BASE_URL}/prizes`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        userId: userId,
                        username: username,
                        icon: prize.icon,
                        name: prize.name,
                        value: prize.value,
                        timestamp: Date.now()
                    })
                });
                
                if (response.ok) {
                    console.log('Prize sent to server successfully');
                    return true;
                } else {
                    console.error('Failed to send prize to server');
                    return false;
                }
            } catch (error) {
                console.error('Error sending prize to server:', error);
                // –ü—Ä–∏ –æ—à–∏–±–∫–µ –¥–æ–±–∞–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ (fallback)
                addPrizeLocally(prize);
                return false;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π —Å —Å–µ—Ä–≤–µ—Ä–∞
        async function fetchGlobalPrizes() {
            try {
                const response = await fetch(`${API_BASE_URL}/prizes?limit=50`);
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.prizes && Array.isArray(data.prizes)) {
                        globalPrizes = data.prizes;
                        return true;
                    }
                } else {
                    console.error('Failed to fetch prizes from server');
                    loadPrizesFromLocalStorage();
                    return false;
                }
            } catch (error) {
                console.error('Error fetching prizes from server:', error);
                loadPrizesFromLocalStorage();
                return false;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–∞—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ (fallback)
        function addPrizeLocally(prize) {
            globalPrizes.push({
                icon: prize.icon,
                name: prize.name,
                value: prize.value,
                timestamp: Date.now()
            });
            
            if (globalPrizes.length > 50) {
                globalPrizes.shift();
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
            try {
                localStorage.setItem('globalPrizes', JSON.stringify(globalPrizes));
            } catch (e) {
                console.error('Failed to save to localStorage:', e);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–∞—Ä–∫–æ–≤ –∏–∑ localStorage
        function loadPrizesFromLocalStorage() {
            try {
                const stored = localStorage.getItem('globalPrizes');
                if (stored) {
                    globalPrizes = JSON.parse(stored);
                } else {
                    // –ù–∞—á–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –ø–æ–¥–∞—Ä–∫–æ–≤
                    globalPrizes = [
                        { icon: 'ItemCase1/_Jne2Jf3nM6erEUU5TEnvU7PWFOiElGs2WJc0zQ250JHxRd6md_v1huDDCpZRSesDCZP53pWDPEnqfojbzsYqjbD.png', name: '–õ–æ–ª–∏ –ø–æ–ø', value: 82.17 },
                        { icon: 'ItemCase1/4dOUEOHs9WSNk5pRBkEnCptGIs16lB5xe4E7mh3sWF6XAkHcwQvINscw7cXwhK5IUXv5eOdct9_vxDZtoaMTm8GJ.png', name: '–ë–∞–±–æ—á–∫–∞', value: 75.66 },
                        { icon: 'ItemCase1/GsJZ-oPiqQHoyerbmc-z_L_NTi8cBWgKmS9ueEOwk5_PHeYbWeRwn6Jxic2d1Yhl8IZwt0rBUg5ZfvrkYkYp0UrO.png', name: '–ó–µ–ª—å–µ', value: 69.30 },
                        { icon: 'ItemCase1/qlq8mJd7J1-60XWhd29rLbtjBfzeXSPLMVgzkcBDTNfHL50TBMHG2B0h2jB1bAd-rJWlHO1NtkI0zAsWF4BgcVHn.png', name: '–®–ª–µ–º', value: 25.27 },
                        { icon: 'ItemCase1/QrKwYOzBzIX1ilzkfuCuiFdyCRU9jBm5pASbp_z2Sb6ATFNaaB1Zr1XfNGehXeHTYhldZNO8x4_l0ueW2t4MZ62W.png', name: '–°–∏–≥–∞—Ä–∞', value: 23.50 }
                    ];
                }
            } catch (e) {
                console.error('Failed to load from localStorage:', e);
            }
        }

        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        function safeInit() {
            try {
                console.log('üîß –ù–∞—á–∏–Ω–∞—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const criticalElements = [
                    'mainPage', 
                    'profilePage', 
                    'crashPage', 
                    'minesPage', 
                    'dicePage',
                    'balance',
                    'crashBalance'
                ];
                
                const missingElements = criticalElements.filter(id => !document.getElementById(id));
                if (missingElements.length > 0) {
                    console.error('‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã:', missingElements);
                    alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                    return;
                }
                
                console.log('‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã');
                
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—ã—á–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
                if (typeof initApp === 'function') {
                    initApp();
                } else {
                    console.warn('‚ö†Ô∏è –§—É–Ω–∫—Ü–∏—è initApp –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                }
                
                // –¢–∞–∫–∂–µ –≤—ã–∑—ã–≤–∞–µ–º initEventHandlers –µ—Å–ª–∏ –æ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–∞
                if (typeof initEventHandlers === 'function') {
                    setTimeout(() => {
                        console.log('üîÑ –í—ã–∑–æ–≤ initEventHandlers –∏–∑ safeInit...');
                        initEventHandlers();
                    }, 150);
                }
            } catch (error) {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: ' + error.message);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        function initializeApp() {
            try {
                safeInit();
                setTimeout(function() {
                    if (typeof initEventHandlers === 'function') {
                        initEventHandlers();
                    }
                }, 200);
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
            }
        }
        
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        function initEventHandlers() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ inline onclick –∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç–∞–±–æ–≤
            if (typeof initTabs === 'function') {
                initTabs();
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–µ–π—Å–æ–≤
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏
            if (typeof initSubscribeButton === 'function') {
                initSubscribeButton();
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            if (typeof initInventoryHandlers === 'function') {
                initInventoryHandlers();
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è
            if (typeof initProfileHandlers === 'function') {
                initProfileHandlers();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –≤—ã–≤–æ–¥–∞
            if (typeof initTopUpHandlers === 'function') {
                initTopUpHandlers();
            }
            
            if (typeof initWithdrawHandlers === 'function') {
                initWithdrawHandlers();
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏
        function initSubscribeButton() {
            try {
                const subscribeBtn = document.querySelector('.subscribe-btn');
                if (subscribeBtn) {
                    const newBtn = subscribeBtn.cloneNode(true);
                    subscribeBtn.parentNode.replaceChild(newBtn, subscribeBtn);
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —á–µ—Ä–µ–∑ onclick –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏
                    newBtn.onclick = function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        console.log('‚úÖ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ø–æ–¥–ø–∏—Å–∫–∏ (onclick)');
                        
                        try {
                            if (tg && tg.openTelegramLink) {
                                tg.openTelegramLink('https://t.me/YourChannel');
                                if (tg.HapticFeedback) {
                                    tg.HapticFeedback.impactOccurred('medium');
                                }
                            } else {
                                window.open('https://t.me/YourChannel', '_blank');
                            }
                        } catch (err) {
                            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Å—ã–ª–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏:', err);
                            window.open('https://t.me/YourChannel', '_blank');
                        }
                        return false;
                    };
                    
                    // –¢–∞–∫–∂–µ —á–µ—Ä–µ–∑ addEventListener –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏
                    newBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();
                        console.log('‚úÖ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ø–æ–¥–ø–∏—Å–∫–∏ (addEventListener)');
                        
                        if (tg && tg.openTelegramLink) {
                            tg.openTelegramLink('https://t.me/YourChannel');
                            if (tg.HapticFeedback) {
                                tg.HapticFeedback.impactOccurred('medium');
                            }
                        } else {
                            window.open('https://t.me/YourChannel', '_blank');
                        }
                    }, { capture: true });
                    
                    console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                } else {
                    console.warn('‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–Ω–æ–ø–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏:', error);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function initInventoryHandlers() {
            try {
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ"
                const sellAllBtn = document.getElementById('sellAllBtn');
                if (sellAllBtn && typeof sellAllItems === 'function') {
                    const newBtn = sellAllBtn.cloneNode(true);
                    sellAllBtn.parentNode.replaceChild(newBtn, sellAllBtn);
                    newBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ"');
                        sellAllItems();
                    });
                    console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ" –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                } else {
                    console.warn('‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è sellAllItems –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–æ—Ç–æ–≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:', error);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–Ω–æ–ø–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è
        function initProfileHandlers() {
            try {
                console.log('üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è...');
                
                // –ö–Ω–æ–ø–∫–∞ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å" - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–ø—Ä—è–º—É—é
                const topUpBtn = document.getElementById('topUpBtn');
                if (topUpBtn) {
                    // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —á–µ—Ä–µ–∑ –∫–ª–æ–Ω
                    const newBtn = topUpBtn.cloneNode(true);
                    topUpBtn.parentNode.replaceChild(newBtn, topUpBtn);
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
                    const topUpHandler = function(e) {
                        if (e) {
                            e.preventDefault();
                            e.stopPropagation();
                            e.stopImmediatePropagation();
                        }
                        console.log('‚úÖ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å" –≤ –ø—Ä–æ—Ñ–∏–ª–µ');
                        
                        try {
                            if (typeof openTopUpModal === 'function') {
                                openTopUpModal();
                            } else {
                                console.error('‚ùå –§—É–Ω–∫—Ü–∏—è openTopUpModal –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                                alert('–û—à–∏–±–∫–∞: —Ñ—É–Ω–∫—Ü–∏—è openTopUpModal –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                            }
                        } catch (err) {
                            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ openTopUpModal:', err);
                            alert('–û—à–∏–±–∫–∞: ' + err.message);
                        }
                        return false;
                    };
                    
                    newBtn.onclick = topUpHandler;
                    newBtn.addEventListener('click', topUpHandler, { capture: true });
                    window.handleTopUp = topUpHandler;
                    
                    console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å" –≤ –ø—Ä–æ—Ñ–∏–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                } else {
                    console.warn('‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                }
                
                // –ö–Ω–æ–ø–∫–∞ "–í—ã–≤–µ—Å—Ç–∏" - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–ø—Ä—è–º—É—é
                const withdrawBtn = document.getElementById('withdrawBtn');
                if (withdrawBtn) {
                    // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —á–µ—Ä–µ–∑ –∫–ª–æ–Ω
                    const newBtn = withdrawBtn.cloneNode(true);
                    withdrawBtn.parentNode.replaceChild(newBtn, withdrawBtn);
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
                    const withdrawHandler = function(e) {
                        if (e) {
                            e.preventDefault();
                            e.stopPropagation();
                            e.stopImmediatePropagation();
                        }
                        console.log('‚úÖ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "–í—ã–≤–µ—Å—Ç–∏" –≤ –ø—Ä–æ—Ñ–∏–ª–µ');
                        
                        try {
                            if (typeof openWithdrawModal === 'function') {
                                openWithdrawModal();
                            } else {
                                console.error('‚ùå –§—É–Ω–∫—Ü–∏—è openWithdrawModal –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                                alert('–û—à–∏–±–∫–∞: —Ñ—É–Ω–∫—Ü–∏—è openWithdrawModal –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                            }
                        } catch (err) {
                            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ openWithdrawModal:', err);
                            alert('–û—à–∏–±–∫–∞: ' + err.message);
                        }
                        return false;
                    };
                    
                    newBtn.onclick = withdrawHandler;
                    newBtn.addEventListener('click', withdrawHandler, { capture: true });
                    window.handleWithdraw = withdrawHandler;
                    
                    console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ "–í—ã–≤–µ—Å—Ç–∏" –≤ –ø—Ä–æ—Ñ–∏–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
                } else {
                    console.warn('‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ "–í—ã–≤–µ—Å—Ç–∏" –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                }
                
                console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è:', error);
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–µ–π—Å–æ–≤
        window.casesData = {};
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–µ–π—Å–æ–≤ –∏–∑ –ø–∞–ø–æ–∫
        function loadCases() {
            console.log('üîµ loadCases –≤—ã–∑–≤–∞–Ω–∞, –∏—â—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä...');
            
            // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
            let casesContainer = document.getElementById('casesContainer');
            if (!casesContainer) {
                casesContainer = document.querySelector('.cases-container');
            }
            if (!casesContainer) {
                casesContainer = document.querySelector('#casesContainer');
            }
            
            if (!casesContainer) {
                console.error('‚ùå casesContainer –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø–æ–ø—Ä–æ–±—É—é –Ω–∞–π—Ç–∏ —á–µ—Ä–µ–∑ 100–º—Å');
                setTimeout(function() {
                    loadCases();
                }, 100);
                return;
            }
            
            console.log('‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–π–¥–µ–Ω:', casesContainer);
            
            // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—å –≤–∏–¥–∏–º—ã
            const casesPage = document.getElementById('casesPage');
            if (casesPage) {
                casesPage.style.display = 'block';
                casesPage.style.visibility = 'visible';
                casesPage.style.opacity = '1';
                casesPage.style.position = 'fixed';
                casesPage.style.top = '0';
                casesPage.style.left = '0';
                casesPage.style.right = '0';
                casesPage.style.bottom = '0';
                casesPage.style.width = '100%';
                casesPage.style.height = '100%';
                casesPage.style.zIndex = '100';
                console.log('‚úÖ casesPage —Å–¥–µ–ª–∞–Ω–∞ –≤–∏–¥–∏–º–æ–π');
            }
            
            console.log('‚úÖ –ó–∞–≥—Ä—É–∂–∞—é –∫–µ–π—Å—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:', casesContainer);
            
            // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–∞ 1 - –¥–æ–±–∞–≤–ª—è–µ–º —Ü–µ–Ω—ã –¥–ª—è –ø–æ–¥–∞—Ä–∫–æ–≤
            const case1Data = {
                id: 1,
                icon: 'Case1/Case/OA2YI79hneequQi62NNm5RTa0jw-sxBTwlrfcD4cx18nkOBqIQ-edited-free%20(carve.photos).png',
                price: 0.5,
                prizes: [
                    { icon: 'Case1/7aggEGM43iT4zaeQ90WDXbKgaxRuIctX8OzjKHUoNGYKDTiEdT-no-bg-preview%20(carve.photos).png', value: 22.89 },
                    { icon: 'Case1/AW7Qv-lm22xsWd8ZnVjP7pVDjzBgqo-x9-7UoZO2ekVCWsWsAl-edited-free%20(carve.photos).png', value: 7.37 },
                    { icon: 'Case1/cIBPnG2m_9uqU5vfNaXES6TIPHfksPhjIYc8nPIjbVuiGb317Z-no-bg-preview%20(carve.photos).png', value: 1.93 },
                    { icon: 'Case1/g7a9ySOF7wq3mu2Shuxr67enQDHEcB0zcgllGa59ked5fEcXN-yfwBe-9z2LBU_7zbVRyb2z2-DCQaLdGYWqfUqS-Photoroom.png', value: 1.66 },
                    { icon: 'Case1/Jftdn-uPpbWzly4TEgsyY3LBDQUkI1Q0hcmopC-HAru9nM5uJW-no-bg-preview%20(carve.photos).png', value: 8.00 },
                    { icon: 'Case1/kIMnTGaiutK0Ou4X_-RRh2ckiNpdKQBCMNtnb9wRdYmxf_kJ3s-no-bg-preview%20(carve.photos).png', value: 6.85 },
                    { icon: 'Case1/KQdlr7WVUg4qZZ3J0muYmXNRCePTR-p8n74r-_r7zQMhtyuhHTUb9JrOU6rTAjB9tnNBBplZGBXyh-YxLPQnqYZO-Photoroom.png', value: 1.38 },
                    { icon: 'Case1/L3L25Ezu2782EQaWm5os_oi1ELu1qudKKDGbeP4FMGOxxjKCBi-no-bg-preview%20(carve.photos).png', value: 2.79 },
                    { icon: 'Case1/llJ3ZTgJvieSHhmehyG9LuNG5M2dY7tr5bPpctgOh6H_Mz4bal-edited-free%20(carve.photos).png', value: 2.90 },
                    { icon: 'Case1/NE-peoxoim_KxZ6SDxHjoRAwQSnt7tj6rcRUOgvyfYHoXKlU9f-no-bg-preview%20(carve.photos).png', value: 4.59 },
                    { icon: 'Case1/QWvlnRQNdZo2nqVt5hI6ff7l3ZpxK-IGc3X10-CUGLv10ycEwc-no-bg-preview%20(carve.photos).png', value: 2.90 },
                    { icon: 'Case1/rO9Afzk_7QoBW7-D-94uoD2JsyTsaZnp1prTIWnzp_AsMeQrp--no-bg-preview%20(carve.photos).png', value: 1.76 },
                    { icon: 'Case1/SZPAhV0giLdoCjqwE0tP2Fa3_NfB65B54BuJKToWItApL6Qtt3-no-bg-preview%20(carve.photos).png', value: 40.44 },
                    { icon: 'Case1/VqbJmqTX4m3Um9XF5l6aFIETbR-TRBmBrEOiHLnxicnI8Bfqoh-no-bg-preview%20(carve.photos).png', value: 23.50 },
                    { icon: 'ton_symbol.png', value: 1.00 },
                    { icon: 'ton_symbol.png', value: 0.05 },
                    { icon: 'ton_symbol.png', value: 0.20 },
                    { icon: 'ton_symbol.png', value: 0.10 }
                ]
            };
            
            // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–∞ 2
            const case2Data = {
                id: 2,
                icon: 'Case2/Case/05FdJJ2aGJGsQIutsKUd0AlbIHYdawIuMvN1kcQ1CIBZUU3ThvWft319nelV7u3ID1Zp5diNbUKGVIZ2yrMX7EFU-Photoroom.png',
                price: 1.0,
                prizes: [
                    { icon: 'Case2/4atzFbzn2e3UxeIjh4R4mt5JR1vIlB-wau9esupxJII97_CFmUSRTdFrVRMH6CInNhOnlwjTpNgsNMRi7U0b8Q-s.png', value: 7.09 },
                    { icon: 'Case2/5Fb-YCFbFvfEetWLJJStAOU0jv3qfu-EuVMupeTIgD6RJSDE_FSST7np9CodZxl5Zwp6b_NnJefqTxxstMvkLrT0.png', value: 1.70 },
                    { icon: 'Case2/d9J-xWqlGTdT-H9I-yxmVjPyIfDfRUIoVIpqLHup_cmINQRfd0VjQ0MtITk6mbxTUsAkFZXDEgVkkJQ-OdP6iEgW.png', value: 2.00 },
                    { icon: 'Case2/dbiccJZH0zWig-l2b3knXtEpZ7UDW8a4ffeZZJG9ALAuOVZVzYAH0FlrfOQzOb_KE9iEDqJ84inTnrcJtK4wlokk.png', value: 2.50 },
                    { icon: 'Case2/F9M9_Ci6MNLF67i0fa2JJKohkl2h2eJyUlizgjKYNJ7HPRk0aiCWt5Ok_YOhj0rhNkaz-PL69ZfmaG8xpfVuRh_L.png', value: 8.00 },
                    { icon: 'Case2/gzyva6NWRTfaE58yDe6ux65ccMFzHcnt_VuD2ZnEBMUfmLdhoMDWwAUyNl28O-4jFiNzKYXCZEVIQID4Joe2LDNK.png', value: 1.25 },
                    { icon: 'Case2/jj58rgvhnUjNAXK73UsxvKMh8E3b0egRsMDNPnLYvRl2vWUUzaj_SFcw_OpCXU_A2weBg-ao0iUdqEeO60q3k1V1.png', value: 3.33 },
                    { icon: 'Case2/Jx-jT_mb94wlDgjOeKbsgFfNNZGicx95NxRqKOox25a2kZAkqg8rJHhACD1bJuKYqAd28TT3GNhZsrZ5Fz7W4JP3.png', value: 1.25 },
                    { icon: 'Case2/LcdGhlqKKnkI26o7RkuMCHXi7Q-5ivAqRgpj5YhQgRfDhjwgOhiyeb5afg2_L0Ls5wR4iHYVuWPyIglAfu1NxQ8r.png', value: 65.00 },
                    { icon: 'Case2/LjtcgEifJ5cNeMCCHjgPNSz2LCrFu5j7Axoj6MEOKy5kPCZIBB662cvAO0AVr3z5ILutbM0Jt5DIPLy8soN7__lu.png', value: 6.85 },
                    { icon: 'Case2/RQxtlT0hSFZTWrPagbjMP-RkwEkZliBq9DtdzEjBD56fx5Twnl4lCd0v4Hk8EFcXWrdbfSYeYOWWOG7koSzmXFNX.png', value: 20.76 },
                    { icon: 'Case2/Ua_M9EJHMA5yXfw5TS_JLQmfl8vuOTEsagv3uq-QARWqxPFJtKZDE462U4pP6ZfwyJCVeFeUwVlAZ-v9GtSa0K6I.png', value: 7.37 },
                    { icon: 'Case2/uorrEfYkPQ5wbi6WY1S6GO5Ed2xHrvXHzVKuHQHkHYGiuhWTesjj6ERIwI_bqOinCyBMlnUmjtf-lqulft_aRwgK.png', value: 4.46 },
                    { icon: 'Case2/Xyi7k4eeD2gkWGlfObjRPbzVM9aq2i3r9uU2zM-0hobAbCmxwwKvTGQH404oiYFWnXWFVgFv0XIZtdllebiHmP3g.png', value: 23.50 },
                    { icon: 'Case2/xZnLrl0D4kUBURiL825bozVLww2K5bqzWY8w3p3wsZ0t7c9k4-wVTLqqKkchtiGpJDtoPH-z941HY921gjskfCX9.png', value: 1.56 },
                    { icon: 'ton_symbol.png', value: 5.00 },
                    { icon: 'ton_symbol.png', value: 3.00 },
                    { icon: 'ton_symbol.png', value: 1.00 },
                    { icon: 'ton_symbol.png', value: 0.50 },
                    { icon: 'ton_symbol.png', value: 0.30 }
                ]
            };
            
            // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–∞ 3
            const case3Data = {
                id: 3,
                icon: 'Case3/Case/snapedit_1762254890291.png',
                price: 1.5,
                prizes: [
                    { icon: 'Case3/Bear.png', value: 20.76 },
                    { icon: 'Case3/black.png', value: 35.84 },
                    { icon: 'Case3/Cris.png', value: 101.88 },
                    { icon: 'Case3/Kukla.png', value: 16.19 },
                    { icon: 'Case3/rejrwk.png', value: 23.50 },
                    { icon: 'Case3/remove-photos-background-removed.png', value: 7.37 },
                    { icon: 'Case3/snapedit_1762254932069.png', value: 1.25 },
                    { icon: 'Case3/snapedit_1762254948441.png', value: 1.30 },
                    { icon: 'Case3/snapedit_1762254959768.png', value: 1.80 },
                    { icon: 'Case3/snapedit_1762254971800.png', value: 2.00 },
                    { icon: 'Case3/snapedit_1762254982271.png', value: 2.49 },
                    { icon: 'Case3/snapedit_1762254992823.png', value: 2.90 },
                    { icon: 'Case3/snapedit_1762255004128.png', value: 2.93 },
                    { icon: 'Case3/snapedit_1762255014774.png', value: 6.85 },
                    { icon: 'ton_symbol.png', value: 0.70 },
                    { icon: 'ton_symbol.png', value: 0.50 }
                ]
            };
            
            // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–∞ 4
            const case4Data = {
                id: 4,
                icon: 'Case4/Case/acetone-2025114-143714-579.png',
                price: 2.0,
                prizes: [
                    { icon: 'Case4/6909e7c56c6467000e321e41.png', value: 22.89 },
                    { icon: 'Case4/6909e7ec6c6467000e321e58.png', value: 7.37 },
                    { icon: 'Case4/cvbgf.png', value: 1.93 },
                    { icon: 'Case4/design.png', value: 1.66 },
                    { icon: 'Case4/dfgre.png', value: 8.00 },
                    { icon: 'Case4/dfvdfg.png', value: 6.85 },
                    { icon: 'Case4/fcb.png', value: 1.38 },
                    { icon: 'Case4/ghj.png', value: 2.79 },
                    { icon: 'Case4/htWoussKmtHLqPSqdJxeJFMWQGSJnXcGpv1ElXaMW3GvFQu4ByvGwNkXpY_bpi9aPnZz4V_tmORkIr1bgwNG3cSr.png', value: 2.90 },
                    { icon: 'Case4/J0AtygNa7Vynkk01WRz3m7tvd3aGENdcSomt2KMb0IWVi4Nger7-21T8fXzbSh_gkElGXQ4YlP-tZYRN_chAwoo8.png', value: 4.59 },
                    { icon: 'Case4/jghbmbn.png', value: 2.90 },
                    { icon: 'Case4/lkp.png', value: 1.76 },
                    { icon: 'Case4/m85G8Q6e9wbRhws2KZrKozAtGL8yspcDCUNh6-Znff_yFr2Zed-PS-is8UIdZvP7NlPtSiOhBKN5QbVZcaRrum1U.png', value: 40.44 },
                    { icon: 'Case4/olg3GK1sNR-dbLonHn6WaDW-jjLFOZ7-LD1-d8DpIvm6EEhPsN6JxDoPeMAER_jHkmhbsEdOttVeYsxPTE7-M09j.png', value: 23.50 },
                    { icon: 'Case4/remove.photos-removed-background.png', value: 15.00 },
                    { icon: 'Case4/rthgf.png', value: 12.00 },
                    { icon: 'Case4/sdf.png', value: 10.00 },
                    { icon: 'Case4/sfsef.png', value: 8.50 },
                    { icon: 'Case4/sxdfsd.png', value: 6.00 },
                    { icon: 'Case4/vbnfg.png', value: 5.00 },
                    { icon: 'Case4/xdfvdf.png', value: 4.00 },
                    { icon: 'Case4/xdvc.png', value: 3.00 },
                    { icon: 'ton_symbol.png', value: 1.00 },
                    { icon: 'ton_symbol.png', value: 0.50 }
                ]
            };
            
            // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–∞ 5
            const case5Data = {
                id: 5,
                icon: 'Case5/Case/SKV9CMvzpTc3urYh5zDqJ6YKXR9ORWTnhkcda9zbRtvRLMk_5rN0YxNe7gGMyyCHwEv2Y9g7_8SSJPVT5dvK7ndy_preview_rev_1.png',
                price: 3.0,
                prizes: [
                    { icon: 'Case5/3zNYdZcaPwlYSu-6QbqscijQ8ZoROle4CcY06ECxKqJKQ5-HFWTofVLXmAPe_HQ8t6LsWm0_5MBwl2DkIItvz_dh.png', value: 1.32 },
                    { icon: 'Case5/9rOrYhKh86anJDeoMWT-bSw34wC_jE7--QgBJNXGqx2TUgwjRnVpWmwzhEdIRhuFI2hbLaPCxZEcNNwOVW8EZc9B.png', value: 101.88 },
                    { icon: 'Case5/aMWG33-puCe0ZZwFhGSE-ugaDKy8jMhAAaZhm5X2QdspSB64MNLxQSfC897kkE6V-2LOidLLI_-8WcjSJAwxd87i.png', value: 10.70 },
                    { icon: 'Case5/cE0vpkRNV7jJiUjuO5MqKvKNEGO6LyIUUZmb7Yf5HVugFu7WCHPpPROEbY0_KSJ7ZVa61e3LZe5t0pX3YdQSRirE.png', value: 1.23 },
                    { icon: 'Case5/CH2RF70ctcgzrrQJPzJA1Os9rjGBVspkDh5IKMOtb8F3SgYjxKCuq0TbkZ7DMSXyQUqvhXrTVhs5J_SJNsIoGvS4.png', value: 1.38 },
                    { icon: 'Case5/dW4PUS8jxBMRxIZR7OwURFdiqfhEzYWpfoZrEhmrpSt0eb2qiAnGc73Ctam-pB6X3Z3lnYzQ4MTWEJ3f2aGp4FcX.png', value: 43.90 },
                    { icon: 'Case5/fczZHZzpbDT5is93-YlJhIX37Ost3bwYv5RHAyCPvmbesQmkOO0TfuZ08twZSVyGaaJlYQPPTezN0W2z-oUFwEC2.png', value: 73.84 },
                    { icon: 'Case5/g1zeyljnNGnQiUsqnqcqqwOgnxL5TOh9YqAXAJxa9BzlkmRvgkjEBjq69s7otCHiX8MF16AcUx2-DCMpMBCsUnDk.png', value: 4.46 },
                    { icon: 'Case5/hny4Z-siOeGgXazG9jw3P3pE2xsdiRCJiOOIqUtHN3Q7OA83OJ1XHbHoVSLMHbyjGrxzwHg2zdzrbW6DkLhzKNjv.png', value: 24.20 },
                    { icon: 'Case5/ImJp1qKCRAUCdxq7qJycKHd3MXPSNmoCKtaqccyc_PaelAyEFCTpPICXjp_tuAbnkx1aIwgR2plITlubxc6cbJG9.png', value: 16.29 },
                    { icon: 'Case5/MUaZV1uId7tTDT8K0BRfYnmXRTTdGlI3kO_7y2Fj3OP6i8AG24SFyxB12ISdJE5uc0DZ7m_c3O084NCy46c0Ipk2.png', value: 65.00 },
                    { icon: 'Case5/p_Ue74pOdDx_fkmRqs0ISyfTUxjUklsrVkpHgz-qnXK6pyBXN8RB1vhjsCI1LuMu6DIeIQpRk4In1E1hDFuNVslf.png', value: 5.42 },
                    { icon: 'Case5/sPp4nE6WRQ51NU7tUCo75xiZrZlpY45rwxirjqhKtv94SIhTkMcIGTX86AdP6N5mlPptDiSCQbZgGFeOR5-iPKCa.png', value: 21.50 },
                    { icon: 'Case5/tccYIj1KsKErM9aw4IQm8_9PXVY87YmFC-maZ47wd1DlGBfRBUkdTrcXom6BgCxInERe9gKBzSQIjiKZJbQUpW6i.png', value: 1.71 },
                    { icon: 'Case5/vpfdyrpMKekBa4SFKtqSOxO3D-LAl3_Q_5yXThAMRveDu44sazRZTZF8PbI2fVz9mF7cZDO-BRHPeO00-D4-l-n8.png', value: 82.99 },
                    { icon: 'Case5/VRkQAOGmURihVmVjVgQhTBfY7JSIL4ilqbwN4r0lszXpD0AC2OSi3nFar4wBJHXw2Hxkob0qU8y7s-gHThb2UEzp.png', value: 1.27 },
                    { icon: 'Case5/VwX5xwbNDElL_UGNLIaP2lXs2xYYscWx1DwPP-Lt4lJCzThwYih9HCRVRIBz72fir1kuzOR-CorWzjiy9RNw0qOd.png', value: 2.90 },
                    { icon: 'Case5/WTjfm05s9hcyY1BLGkP0rQB1jvttlaZU9r_eAwQCJfo3MdpbBeuKBMNLUhhhICV41VM9KGsTYGUSSW_z8bbSwmRq.png', value: 1.93 },
                    { icon: 'Case5/yEx6wYHm9INrS57fRu86D4TJV0GQzqnnfjHZtrCPhWG3reCHtde-Y2wKcysFSpNgCN0AHAvbCaO7f7hgRrytn1YP.png', value: 7.97 },
                    { icon: 'Case5/YPnqYKrOGsMb7-8FgUNvrCO0HtoEfAmZwRuDGBGzUKexej-YIW8uyM_xmX__R8XPkMGJQantKGj94B-p_npwyE4Z.png', value: 1.25 },
                    { icon: 'Case5/ZuxLk3SMjDIyZjz2fS79BfR8cB88GQOv83pBN2fO2fNiZMiypgptqXGIr_EfHm-JPAyIV0wvJ9KJUbGE5Z_BrTCi.png', value: 69.90 },
                    { icon: 'Case5/zyV3RoVTS-VNBLMSrHEZTxDAqElRd60wBw0C48-fvwtsvplR7nyI2BNS6DhtAqwACt0wczvOsnb8VGiRS5GFkQc_.png', value: 1.30 },
                    { icon: 'ton_symbol.png', value: 0.30 },
                    { icon: 'ton_symbol.png', value: 0.10 }
                ]
            };
            
            // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–∞ 6
            const case6Data = {
                id: 6,
                icon: 'Case6/Case/remove.photos-removed-background.png',
                price: 7.0,
                prizes: [
                    { icon: 'Case6/asdw.png', value: 22.99 },
                    { icon: 'Case6/asfwqe.png', value: 4.59 },
                    { icon: 'Case6/dfg.png', value: 4.00 },
                    { icon: 'Case6/dfjyhb.png', value: 23.50 },
                    { icon: 'Case6/dsbvt.png', value: 43.90 },
                    { icon: 'Case6/dsferf.png', value: 10.70 },
                    { icon: 'Case6/dsgrfdg.png', value: 7.97 },
                    { icon: 'Case6/fhtr.png', value: 78.98 },
                    { icon: 'Case6/remove.photos-removed-background.png', value: 2.90 },
                    { icon: 'Case6/sdfed.png', value: 5.20 },
                    { icon: 'Case6/sdfef.png', value: 7.09 },
                    { icon: 'Case6/sdfver.png', value: 798.99 },
                    { icon: 'ton_symbol.png', value: 1.00 },
                    { icon: 'ton_symbol.png', value: 0.50 }
                ]
            };
            
            // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–∞ 7
            const case7Data = {
                id: 7,
                icon: 'Case7/Case/remove.photos-removed-background.png',
                price: 15.0,
                prizes: [
                    { icon: 'Case7/b.png', value: 227.99 },
                    { icon: 'Case7/cbfh.png', value: 65.00 },
                    { icon: 'Case7/dfgedrg.png', value: 6.85 },
                    { icon: 'Case7/dfgrt.png', value: 54.00 },
                    { icon: 'Case7/fgh.png', value: 27.20 },
                    { icon: 'Case7/gdfgr.png', value: 8.00 },
                    { icon: 'Case7/gvngh.png', value: 35.84 },
                    { icon: 'Case7/m.png', value: 340.00 },
                    { icon: 'Case7/n.png', value: 798.99 },
                    { icon: 'Case7/sdf.png', value: 5425.00 },
                    { icon: 'Case7/sdfe.png', value: 22.89 },
                    { icon: 'Case7/t.png', value: 1140.00 },
                    { icon: 'ton_symbol.png', value: 1.00 },
                    { icon: 'ton_symbol.png', value: 0.50 }
                ]
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
            window.casesData = window.casesData || {};
            window.casesData[case1Data.id] = case1Data;
            window.casesData[case2Data.id] = case2Data;
            window.casesData[case3Data.id] = case3Data;
            window.casesData[case4Data.id] = case4Data;
            window.casesData[case5Data.id] = case5Data;
            window.casesData[case6Data.id] = case6Data;
            window.casesData[case7Data.id] = case7Data;
            
            const cases = [case1Data, case2Data, case3Data, case4Data, case5Data, case6Data, case7Data];
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            casesContainer.innerHTML = '';
            
            // –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–∏–¥–∏–º - –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û
            casesContainer.style.setProperty('display', 'flex', 'important');
            casesContainer.style.setProperty('visibility', 'visible', 'important');
            casesContainer.style.setProperty('opacity', '1', 'important');
            casesContainer.style.setProperty('position', 'relative', 'important');
            casesContainer.style.setProperty('width', '100%', 'important');
            casesContainer.style.setProperty('min-height', '200px', 'important');
            
            console.log('‚úÖ –°—Ç–∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã');
            
            cases.forEach(caseData => {
                const caseCard = document.createElement('div');
                caseCard.className = 'case-card';
                caseCard.dataset.case = caseData.id;
                caseCard.style.cursor = 'pointer';
                
                caseCard.innerHTML = `
                    <div class="case-icon">
                        <img src="${caseData.icon}" alt="–ö–µ–π—Å #${caseData.id}" onerror="this.style.display='none'; this.parentElement.innerHTML='üéÅ';">
                    </div>
                    <div class="case-info">
                        <div class="case-name">–ö–µ–π—Å #${caseData.id}</div>
                        <div class="case-description">${caseData.prizes.length} –ø—Ä–µ–¥–º–µ—Ç–æ–≤</div>
                        <div class="case-price">${caseData.price} <span class="currency-icon"></span></div>
                    </div>
                `;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–∏–≤—è–∑–∫–∞
                caseCard.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–µ–π—Å—É #' + caseData.id);
                    if (typeof window.showCaseDetail === 'function') {
                        window.showCaseDetail(caseData.id);
                    } else {
                        console.error('‚ùå showCaseDetail –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                        alert('–û—à–∏–±–∫–∞: —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –¥–µ—Ç–∞–ª–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    }
                });
                
                // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º onclick –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                caseCard.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (typeof window.showCaseDetail === 'function') {
                        window.showCaseDetail(caseData.id);
                    }
                };
                
                casesContainer.appendChild(caseCard);
            });
            
            console.log('‚úÖ –ö–µ–π—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', cases.length, '–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:', casesContainer);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
            if (casesContainer.children.length === 0) {
                console.error('‚ùå –ö–µ–π—Å—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä!');
                console.error('‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä:', casesContainer);
                console.error('‚ùå HTML –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:', casesContainer.innerHTML);
                alert('–û—à–∏–±–∫–∞: –∫–µ–π—Å—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å.');
            } else {
                console.log('‚úÖ –ö–µ–π—Å–æ–≤ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:', casesContainer.children.length);
                
                // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–∏–¥–∏–º - –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û
                casesContainer.style.setProperty('display', 'flex', 'important');
                casesContainer.style.setProperty('visibility', 'visible', 'important');
                casesContainer.style.setProperty('opacity', '1', 'important');
                casesContainer.style.setProperty('position', 'relative', 'important');
                casesContainer.style.setProperty('width', '100%', 'important');
                casesContainer.style.setProperty('min-height', '200px', 'important');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏ –¥–µ–ª–∞–µ–º –µ–≥–æ –≤–∏–¥–∏–º—ã–º - –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û
                Array.from(casesContainer.children).forEach((child, index) => {
                    console.log(`‚úÖ –ö–µ–π—Å ${index + 1}:`, child.className);
                    child.style.setProperty('display', 'flex', 'important');
                    child.style.setProperty('visibility', 'visible', 'important');
                    child.style.setProperty('opacity', '1', 'important');
                    child.style.setProperty('position', 'relative', 'important');
                    child.style.setProperty('width', '100%', 'important');
                    child.style.setProperty('max-width', '600px', 'important');
                    child.style.setProperty('margin', '0 auto 20px auto', 'important');
                    child.style.setProperty('pointer-events', 'auto', 'important');
                    child.style.setProperty('z-index', '10', 'important');
                });
                
                console.log('‚úÖ –í—Å–µ –∫–µ–π—Å—ã —Å–¥–µ–ª–∞–Ω—ã –≤–∏–¥–∏–º—ã–º–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ');
            }
        }
        
        window.loadCases = loadCases;
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–µ–π—Å–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(function() {
                    if (typeof loadCases === 'function') {
                        console.log('üîµ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–µ–π—Å–æ–≤ –ø—Ä–∏ DOMContentLoaded');
                        loadCases();
                    }
                }, 200);
            });
                        } else {
            setTimeout(function() {
                if (typeof loadCases === 'function') {
                    console.log('üîµ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫–µ–π—Å–æ–≤ (DOM —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω)');
                    loadCases();
                }
            }, 200);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –¥–µ—Ç–∞–ª–µ–π –∫–µ–π—Å–∞
        function showCaseDetail(caseId) {
            const caseData = window.casesData[caseId];
            if (!caseData) {
                alert('–ö–µ–π—Å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            const casesPage = document.getElementById('casesPage');
            const caseDetailPage = document.getElementById('caseDetailPage');
            const header = document.querySelector('.header');
            
            if (!caseDetailPage) {
                alert('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ—Ç–∞–ª–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                return;
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–µ–π—Å–æ–≤
            if (casesPage) {
                casesPage.style.display = 'none';
            }
            if (header) {
                header.style.display = 'none';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª–µ–π
            caseDetailPage.style.display = 'block';
            caseDetailPage.style.visibility = 'visible';
            caseDetailPage.style.opacity = '1';
            caseDetailPage.style.pointerEvents = 'auto';
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∫–æ–Ω–∫—É –∫–µ–π—Å–∞
            const detailIcon = document.getElementById('detailIcon');
            if (detailIcon) {
                detailIcon.innerHTML = '';
                const img = document.createElement('img');
                img.src = caseData.icon;
                img.alt = `–ö–µ–π—Å #${caseId}`;
                img.style.width = '100%';
                img.style.maxWidth = '300px';
                img.style.height = 'auto';
                img.style.objectFit = 'contain';
                img.onerror = () => detailIcon.textContent = 'üéÅ';
                detailIcon.appendChild(img);
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–Ω—É
            const detailPrice = document.getElementById('detailPrice');
            if (detailPrice) {
                detailPrice.innerHTML = `${caseData.price} <span class="currency-icon"></span>`;
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∞—Ä–∫–æ–≤
            const prizesGrid = document.getElementById('prizesGrid');
            if (prizesGrid) {
                prizesGrid.innerHTML = '';
                
                caseData.prizes.forEach(prize => {
                    const prizeItem = document.createElement('div');
                    prizeItem.className = 'prize-item';
                    
                    const iconDiv = document.createElement('div');
                    iconDiv.className = 'prize-icon';
                    const img = document.createElement('img');
                    img.src = prize.icon;
                    img.alt = '';
                    img.style.width = '60px';
                    img.style.height = '60px';
                    img.style.objectFit = 'contain';
                    img.onerror = () => iconDiv.textContent = 'üéÅ';
                    iconDiv.appendChild(img);
                    
                    prizeItem.appendChild(iconDiv);
                    
                    const valueDiv = document.createElement('div');
                    valueDiv.className = 'prize-value';
                    valueDiv.innerHTML = `${prize.value} <span class="currency-icon"></span>`;
                    prizeItem.appendChild(valueDiv);
                    
                    prizesGrid.appendChild(prizeItem);
                });
            }
        }
        
        window.showCaseDetail = showCaseDetail;
        
        // –¢–µ–∫—É—â–∏–π –æ—Ç–∫—Ä—ã–≤–∞–µ–º—ã–π –∫–µ–π—Å - –æ–±—ä—è–≤–ª—è–µ–º –î–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        var currentOpeningCase = null;
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞ —Å —Ä—É–ª–µ—Ç–∫–æ–π
        function openCase() {
            console.log('üîµ openCase –≤—ã–∑–≤–∞–Ω–∞, currentOpeningCase:', currentOpeningCase);
            
            const caseDetailPage = document.getElementById('caseDetailPage');
            if (!caseDetailPage) {
                console.error('‚ùå caseDetailPage –Ω–µ –Ω–∞–π–¥–µ–Ω');
                alert('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ—Ç–∞–ª–µ–π –∫–µ–π—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                return;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º ID –∫–µ–π—Å–∞ –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            const caseId = currentOpeningCase || 1;
            console.log('üîµ –ò—â–µ–º –∫–µ–π—Å —Å ID:', caseId);
            console.log('üîµ window.casesData:', window.casesData);
            
            const caseData = window.casesData[caseId];
            
            if (!caseData) {
                alert('–ö–µ–π—Å –Ω–µ –Ω–∞–π–¥–µ–Ω. ID: ' + caseId);
                console.error('‚ùå –ö–µ–π—Å –Ω–µ –Ω–∞–π–¥–µ–Ω, ID:', caseId, '–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–µ–π—Å—ã:', Object.keys(window.casesData || {}));
                return;
            }
            
            console.log('‚úÖ –ö–µ–π—Å –Ω–∞–π–¥–µ–Ω:', caseData);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
            const balance = parseFloat(_balance || 0);
            console.log('üîµ –ë–∞–ª–∞–Ω—Å:', balance, '–¶–µ–Ω–∞ –∫–µ–π—Å–∞:', caseData.price);
            if (balance < caseData.price) {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤. –ù—É–∂–Ω–æ: ' + caseData.price + ', –µ—Å—Ç—å: ' + balance);
                return;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –∫–µ–π—Å
            currentOpeningCase = caseId;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –∏ —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∞—Ä–∫–æ–≤
            const openBtn = document.getElementById('openCaseBtn');
            const prizesGrid = document.getElementById('prizesGrid');
            const whatsInside = document.querySelector('.whats-inside-title');
            const caseDetailHeader = document.querySelector('.case-detail-header');
            
            if (openBtn) {
                openBtn.style.display = 'none';
                console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞');
            } else {
                console.warn('‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ openCaseBtn –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
            }
            
            if (prizesGrid) prizesGrid.style.display = 'none';
            if (whatsInside) whatsInside.style.display = 'none';
            if (caseDetailHeader) caseDetailHeader.style.display = 'none';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä—É–ª–µ—Ç–∫—É
            const rouletteContainer = document.getElementById('rouletteContainer');
            if (rouletteContainer) {
                rouletteContainer.style.display = 'flex';
                rouletteContainer.style.zIndex = '2000';
                console.log('‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é —Ä—É–ª–µ—Ç–∫—É');
                setTimeout(() => {
                    if (typeof startRoulette === 'function') {
                        startRoulette(caseData);
                                } else {
                        console.error('‚ùå startRoulette –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                        alert('–û—à–∏–±–∫–∞: —Ñ—É–Ω–∫—Ü–∏—è —Ä—É–ª–µ—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                                }
                }, 100);
                            } else {
                console.error('‚ùå rouletteContainer –Ω–µ –Ω–∞–π–¥–µ–Ω');
                alert('–û—à–∏–±–∫–∞: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä—É–ª–µ—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω');
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ —Ä—É–ª–µ—Ç–∫–∏
        function startRoulette(caseData) {
            console.log('üîµ startRoulette –≤—ã–∑–≤–∞–Ω–∞');
            
            const roulettePrize = document.getElementById('roulettePrize');
            if (!roulettePrize) {
                console.error('‚ùå roulettePrize –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            // –°–ø–∏—Å–æ–∫ –ø–æ–¥–∞—Ä–∫–æ–≤ –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ (–ø–æ–≤—Ç–æ—Ä—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞)
            const prizes = caseData.prizes;
            
            // –†–∞–∑–¥–µ–ª—è–µ–º –ø–æ–¥–∞—Ä–∫–∏ –Ω–∞ TON –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ
            const tonPrizes = prizes.filter(p => p.icon === 'ton_symbol.png' || p.icon.includes('ton_symbol'));
            const otherPrizes = prizes.filter(p => p.icon !== 'ton_symbol.png' && !p.icon.includes('ton_symbol'));
            
            // –°–æ–∑–¥–∞–µ–º –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤: TON –ø–æ–¥–∞—Ä–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º 5 —Ä–∞–∑ (–±–æ–ª—å—à–∏–π —à–∞–Ω—Å), –æ—Å—Ç–∞–ª—å–Ω—ã–µ 1 —Ä–∞–∑
            const weightedPrizes = [];
            tonPrizes.forEach(prize => {
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞–∂–¥—ã–π TON –ø–æ–¥–∞—Ä–æ–∫ 5 —Ä–∞–∑ –¥–ª—è –±–æ–ª—å—à–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
                for (let i = 0; i < 5; i++) {
                    weightedPrizes.push(prize);
                }
            });
            // –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ 1 —Ä–∞–∑—É
            otherPrizes.forEach(prize => {
                weightedPrizes.push(prize);
            });
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ –∏–∑ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
            const selectedPrizeFromWeighted = weightedPrizes[Math.floor(Math.random() * weightedPrizes.length)];
            
            // –°–æ–∑–¥–∞–µ–º –∫–æ–ø–∏—é –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞
            const selectedPrize = {
                icon: selectedPrizeFromWeighted.icon,
                value: selectedPrizeFromWeighted.value,
                name: selectedPrizeFromWeighted.name
            };
            
            console.log('‚úÖ –í—ã–±—Ä–∞–Ω –ø–æ–¥–∞—Ä–æ–∫ –¥–ª—è –≤—ã–∏–≥—Ä—ã—à–∞:', selectedPrize);
            console.log('   –ò–∫–æ–Ω–∫–∞:', selectedPrize.icon);
            console.log('   –ó–Ω–∞—á–µ–Ω–∏–µ:', selectedPrize.value);
            
            // –ù–ê–ô–î–ï–ú –ü–û–ó–ò–¶–ò–Æ –í –û–†–ò–ì–ò–ù–ê–õ–¨–ù–û–ú –ú–ê–°–°–ò–í–ï –ü–ï–†–ï–î –°–û–ó–î–ê–ù–ò–ï–ú SCROLLITEMS
            // –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –º—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º –≥–¥–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–¥–∞—Ä–æ–∫
            let selectedPrizeIndexInOriginal = -1;
            for (let i = 0; i < prizes.length; i++) {
                if (prizes[i].icon === selectedPrize.icon && 
                    Math.abs(prizes[i].value - selectedPrize.value) < 0.001) {
                    selectedPrizeIndexInOriginal = i;
                    console.log('‚úÖ –ù–∞–π–¥–µ–Ω –∏–Ω–¥–µ–∫—Å –ø–æ–¥–∞—Ä–∫–∞ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –º–∞—Å—Å–∏–≤–µ:', selectedPrizeIndexInOriginal);
                    break;
                }
            }
            
            // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –º–∞—Å—Å–∏–≤–µ, –∏—â–µ–º –ø–æ –∏–∫–æ–Ω–∫–µ
            if (selectedPrizeIndexInOriginal === -1) {
                console.warn('‚ö†Ô∏è –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –º–∞—Å—Å–∏–≤–µ, –∏—â—É –ø–æ –∏–∫–æ–Ω–∫–µ...');
                for (let i = 0; i < prizes.length; i++) {
                    if (prizes[i].icon === selectedPrize.icon) {
                        selectedPrizeIndexInOriginal = i;
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –º–∞—Å—Å–∏–≤–µ
                        selectedPrize.value = prizes[i].value;
                        console.warn('‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ –ø–æ –∏–∫–æ–Ω–∫–µ, –∏–Ω–¥–µ–∫—Å:', selectedPrizeIndexInOriginal, '–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞:', selectedPrize.value);
                        break;
                    }
                }
            }
            
            // –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ –Ω–∞—à–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∏–Ω–¥–µ–∫—Å
            if (selectedPrizeIndexInOriginal === -1) {
                selectedPrizeIndexInOriginal = Math.floor(Math.random() * prizes.length);
                selectedPrize.icon = prizes[selectedPrizeIndexInOriginal].icon;
                selectedPrize.value = prizes[selectedPrizeIndexInOriginal].value;
                console.error('‚ùå –ü–æ–¥–∞—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é —Å–ª—É—á–∞–π–Ω—ã–π –∏–Ω–¥–µ–∫—Å:', selectedPrizeIndexInOriginal);
                console.error('   –û–±–Ω–æ–≤–ª–µ–Ω selectedPrize –Ω–∞:', selectedPrize);
            }
            
            // –°–æ–∑–¥–∞–µ–º scrollItems –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ (5 —Ä–∞–∑ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏)
            const scrollItems = [...prizes, ...prizes, ...prizes, ...prizes, ...prizes];
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
            roulettePrize.innerHTML = '';
            roulettePrize.style.transform = 'translateY(0)';
            
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
            scrollItems.forEach((prize, index) => {
                const item = document.createElement('div');
                item.className = 'roulette-item';
                item.dataset.prizeIndex = index % prizes.length;
                item.dataset.prizeIcon = prize.icon;
                item.dataset.prizeValue = prize.value;
                
                const img = document.createElement('img');
                img.src = prize.icon;
                img.alt = '';
                img.style.width = '80px';
                img.style.height = '80px';
                img.style.objectFit = 'contain';
                img.onerror = () => {
                    item.textContent = 'üéÅ';
                    item.style.fontSize = '60px';
                };
                
                item.appendChild(img);
                roulettePrize.appendChild(item);
            });
            
            // –ù–∞—Ö–æ–¥–∏–º –ø–æ–∑–∏—Ü–∏—é –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∫—Ä—É–≥–µ
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω–¥–µ–∫—Å –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
            const lastCircleStart = scrollItems.length - prizes.length;
            const targetIndex = lastCircleStart + selectedPrizeIndexInOriginal;
            
            // –ü–†–û–í–ï–†–Ø–ï–ú —á—Ç–æ –Ω–∞ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫
            const finalTargetPrize = scrollItems[targetIndex];
            console.log('‚úÖ –¶–µ–ª–µ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è:', targetIndex);
            console.log('   –í—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫:', selectedPrize.icon, selectedPrize.value);
            console.log('   –ü–æ–¥–∞—Ä–æ–∫ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏:', finalTargetPrize.icon, finalTargetPrize.value);
            
            // –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è - –µ—Å–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –æ–±–Ω–æ–≤–ª—è–µ–º selectedPrize
            if (finalTargetPrize.icon === selectedPrize.icon && 
                Math.abs(finalTargetPrize.value - selectedPrize.value) < 0.001) {
                console.log('‚úÖ –ü–û–î–ê–†–û–ö –°–û–í–ü–ê–î–ê–ï–¢!');
            } else {
                console.warn('‚ö†Ô∏è –ü–æ–¥–∞—Ä–æ–∫ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –æ–±–Ω–æ–≤–ª—è—é selectedPrize –Ω–∞ —Ç–æ—Ç —á—Ç–æ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏');
                selectedPrize.icon = finalTargetPrize.icon;
                selectedPrize.value = finalTargetPrize.value;
                console.log('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω selectedPrize:', selectedPrize);
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
            const duration = 3000;
            const startTime = Date.now();
            const startPosition = 0;
            const itemHeight = 100;
            const targetPosition = targetIndex * itemHeight;
            
            console.log('‚úÖ –ù–∞—á–∏–Ω–∞—é –∞–Ω–∏–º–∞—Ü–∏—é, targetPosition:', targetPosition, '–ø–æ–¥–∞—Ä–æ–∫:', selectedPrize);
            
            // Easing —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –∑–∞–º–µ–¥–ª–µ–Ω–∏—è
            function easeOutCubic(t) {
                return 1 - Math.pow(1 - t, 3);
            }
            
            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easedProgress = easeOutCubic(progress);
                
                const currentPosition = startPosition + (targetPosition - startPosition) * easedProgress;
                roulettePrize.style.transform = `translateY(-${currentPosition}px)`;
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–∏–≥—Ä—ã—à - –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫
                    console.log('‚úÖ –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é –ø–æ–¥–∞—Ä–æ–∫:', selectedPrize);
                    setTimeout(() => {
                        showPrize(selectedPrize);
                    }, 500);
                }
            }
            
            // –°–ø–∏—Å—ã–≤–∞–µ–º –±–∞–ª–∞–Ω—Å
            changeBalance(-caseData.price);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            requestAnimationFrame(animate);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –≤—ã–∏–≥—Ä—ã—à–∞
        function showPrize(prize) {
            console.log('üîµ showPrize –≤—ã–∑–≤–∞–Ω–∞, –ø–æ–¥–∞—Ä–æ–∫:', prize);
            
            const rouletteContainer = document.getElementById('rouletteContainer');
            const prizeModal = document.getElementById('prizeModal');
            const prizeModalIcon = document.getElementById('prizeModalIcon');
            const prizeModalValue = document.getElementById('prizeModalValue');
            
            if (rouletteContainer) {
                rouletteContainer.style.display = 'none';
            }
            
            if (prizeModal && prizeModalIcon && prizeModalValue) {
                prizeModalIcon.innerHTML = '';
                const img = document.createElement('img');
                img.src = prize.icon;
                img.alt = '';
                img.style.width = '120px';
                img.style.height = '120px';
                img.style.objectFit = 'contain';
                img.onerror = () => prizeModalIcon.textContent = 'üéÅ';
                prizeModalIcon.appendChild(img);
                
                prizeModalValue.innerHTML = `${prize.value} <span class="currency-icon"></span>`;
                prizeModal.style.display = 'flex';
                
                // –í–ê–ñ–ù–û: –ù–ï –Ω–∞—á–∏—Å–ª—è–µ–º –±–∞–ª–∞–Ω—Å —Å—Ä–∞–∑—É! –¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                // –ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –Ω–∞—á–∏—Å–ª–µ–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–∞—Ä–æ–∫ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: —É–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ userInventory —ç—Ç–æ –º–∞—Å—Å–∏–≤
                if (typeof userInventory === 'undefined') {
                    userInventory = [];
                    console.warn('‚ö†Ô∏è userInventory –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, —Å–æ–∑–¥–∞—é –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤');
                }
                
                if (!Array.isArray(userInventory)) {
                    console.warn('‚ö†Ô∏è userInventory –Ω–µ –º–∞—Å—Å–∏–≤, –ø—Ä–µ–æ–±—Ä–∞–∑—É—é –≤ –º–∞—Å—Å–∏–≤. –¢–∏–ø:', typeof userInventory, '–ó–Ω–∞—á–µ–Ω–∏–µ:', userInventory);
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
                    try {
                        const stored = localStorage.getItem('userInventory');
                        if (stored) {
                            userInventory = JSON.parse(stored);
                            if (!Array.isArray(userInventory)) {
                                userInventory = [];
                            }
                        } else {
                            userInventory = [];
                        }
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –∏–∑ localStorage:', e);
                        userInventory = [];
                    }
                }
                
                const inventoryItem = {
                    icon: prize.icon,
                    name: prize.name || `–ü—Ä–µ–¥–º–µ—Ç ${prize.value.toFixed(2)}`,
                    value: prize.value,
                    timestamp: Date.now(),
                    id: Date.now() + Math.random()
                };
                
                userInventory.push(inventoryItem);
                console.log('‚úÖ –ü–æ–¥–∞—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å:', inventoryItem);
                console.log('‚úÖ –í—Å–µ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ:', userInventory.length);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –°–†–ê–ó–£ –≤ localStorage
                try {
                    localStorage.setItem('userInventory', JSON.stringify(userInventory));
                    console.log('‚úÖ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ:', userInventory.length);
                } catch (e) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –≤ localStorage:', e);
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ–º)
                if (typeof saveUserData === 'function') {
                    saveUserData().then(() => {
                        console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å:', userInventory.length, '–ø—Ä–µ–¥–º–µ—Ç–æ–≤');
                    }).catch(err => {
                        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', err);
                        // –ü—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ö–æ—Ç—è –±—ã –ª–æ–∫–∞–ª—å–Ω–æ
                        try {
                            localStorage.setItem('userInventory', JSON.stringify(userInventory));
                        } catch (e) {
                            console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ:', e);
                        }
                    });
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                if (typeof updateInventory === 'function') {
                    setTimeout(() => {
                        updateInventory();
                        console.log('‚úÖ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ —ç–∫—Ä–∞–Ω–µ, –ø—Ä–µ–¥–º–µ—Ç–æ–≤:', userInventory.length);
                    }, 100);
                }
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—ã–∏–≥—Ä—ã—à–∞
        function closePrizeModal() {
            const prizeModal = document.getElementById('prizeModal');
            const openBtn = document.getElementById('openCaseBtn');
            const prizesGrid = document.getElementById('prizesGrid');
            const whatsInside = document.querySelector('.whats-inside-title');
            
            if (prizeModal) {
                prizeModal.style.display = 'none';
            }
            
            if (openBtn) openBtn.style.display = 'block';
            if (prizesGrid) prizesGrid.style.display = 'grid';
            if (whatsInside) whatsInside.style.display = 'block';
            
            currentOpeningCase = null;
        }
        
        // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –î–û –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è - –ü–ï–†–ï–ó–ê–ü–ò–°–´–í–ê–ï–ú –∑–∞–≥–ª—É—à–∫–∏
        window.openCase = function() {
            console.log('üîµ window.openCase –≤—ã–∑–≤–∞–Ω–∞ (–ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è)');
            openCase();
        };
        window.closePrizeModal = closePrizeModal;
        window.goBackFromCase = goBackFromCase;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –∫–µ–π—Å–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –¥–µ—Ç–∞–ª–µ–π
        const originalShowCaseDetail = window.showCaseDetail;
        
        // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º showCaseDetail —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ - –î–û attachOpenCaseHandlers
        window.showCaseDetail = function(caseId) {
            console.log('üîµ showCaseDetail –≤—ã–∑–≤–∞–Ω–∞ –¥–ª—è –∫–µ–π—Å–∞:', caseId);
            currentOpeningCase = caseId;
            if (originalShowCaseDetail) {
                originalShowCaseDetail(caseId);
            }
            // –ü–µ—Ä–µ–ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª–µ–π - –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
            setTimeout(attachOpenCaseHandlers, 50);
            setTimeout(attachOpenCaseHandlers, 150);
            setTimeout(attachOpenCaseHandlers, 300);
            setTimeout(attachOpenCaseHandlers, 500);
            setTimeout(attachOpenCaseHandlers, 1000);
        };
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–Ω–æ–ø–∫–∏
        function attachOpenCaseHandlers() {
            console.log('üîµ attachOpenCaseHandlers –≤—ã–∑–≤–∞–Ω–∞');
            let openCaseBtn = document.getElementById('openCaseBtn');
            
            // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –∫–Ω–æ–ø–∫—É —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏
            if (!openCaseBtn) {
                openCaseBtn = document.querySelector('.open-case-btn');
            }
            if (!openCaseBtn) {
                openCaseBtn = document.querySelector('#openCaseBtn');
            }
            
            if (openCaseBtn) {
                console.log('‚úÖ –ù–∞—à–µ–ª –∫–Ω–æ–ø–∫—É openCaseBtn, –ø—Ä–∏–≤—è–∑—ã–≤–∞—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏');
                
                // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —á–µ—Ä–µ–∑ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
                const newBtn = openCaseBtn.cloneNode(true);
                openCaseBtn.parentNode.replaceChild(newBtn, openCaseBtn);
                
                // –î–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–∏–¥–∏–º–æ–π –∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–π
                newBtn.style.setProperty('display', 'block', 'important');
                newBtn.style.setProperty('visibility', 'visible', 'important');
                newBtn.style.setProperty('opacity', '1', 'important');
                newBtn.style.setProperty('pointer-events', 'auto', 'important');
                newBtn.style.setProperty('cursor', 'pointer', 'important');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —á–µ—Ä–µ–∑ addEventListener
                newBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ –ö–ª–∏–∫ —á–µ—Ä–µ–∑ addEventListener –Ω–∞ –∫–Ω–æ–ø–∫–µ –æ—Ç–∫—Ä—ã—Ç–∏—è');
                    if (typeof window.openCase === 'function') {
                        console.log('‚úÖ –í—ã–∑—ã–≤–∞—é window.openCase');
                        window.openCase();
                    } else {
                        console.error('‚ùå window.openCase –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ addEventListener');
                        alert('–û—à–∏–±–∫–∞: —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –¢–∏–ø: ' + typeof window.openCase);
                    }
                }, true); // useCapture = true –¥–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
                
                // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º onclick –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
                newBtn.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ –ö–ª–∏–∫ —á–µ—Ä–µ–∑ onclick handler –Ω–∞ –∫–Ω–æ–ø–∫–µ –æ—Ç–∫—Ä—ã—Ç–∏—è');
                    if (typeof window.openCase === 'function') {
                        console.log('‚úÖ –í—ã–∑—ã–≤–∞—é window.openCase —á–µ—Ä–µ–∑ onclick');
                        window.openCase();
                    } else {
                        console.error('‚ùå window.openCase –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ onclick');
                    }
                    return false;
                };
                
                // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º touchstart –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                newBtn.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ touchstart –Ω–∞ –∫–Ω–æ–ø–∫–µ –æ—Ç–∫—Ä—ã—Ç–∏—è');
                    if (typeof window.openCase === 'function') {
                        console.log('‚úÖ –í—ã–∑—ã–≤–∞—é window.openCase —á–µ—Ä–µ–∑ touchstart');
                        window.openCase();
                    }
                }, { passive: false });
                
                // –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º mousedown –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                newBtn.addEventListener('mousedown', function(e) {
                    e.preventDefault();
                    console.log('üîµ mousedown –Ω–∞ –∫–Ω–æ–ø–∫–µ –æ—Ç–∫—Ä—ã—Ç–∏—è');
                });
                
                console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã');
            } else {
                console.warn('‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ openCaseBtn –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –ø–æ–ø—Ä–æ–±—É—é –ø–æ–∑–∂–µ');
                setTimeout(attachOpenCaseHandlers, 200);
            }
        }
        
        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
        function initOpenCaseButton() {
            attachOpenCaseHandlers();
            setTimeout(attachOpenCaseHandlers, 100);
            setTimeout(attachOpenCaseHandlers, 300);
            setTimeout(attachOpenCaseHandlers, 500);
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initOpenCaseButton);
        } else {
            initOpenCaseButton();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞–∑–∞–¥
        function goBackFromCase() {
            const caseDetailPage = document.getElementById('caseDetailPage');
            const casesPage = document.getElementById('casesPage');
            const header = document.querySelector('.header');
            const rouletteContainer = document.getElementById('rouletteContainer');
            const prizeModal = document.getElementById('prizeModal');
            
            if (caseDetailPage) {
                caseDetailPage.style.display = 'none';
            }
            
            if (rouletteContainer) {
                rouletteContainer.style.display = 'none';
            }
            
            if (prizeModal) {
                prizeModal.style.display = 'none';
            }
            
            if (casesPage) {
                casesPage.style.display = 'block';
            }
            
            if (header) {
                header.style.display = 'flex';
            }
            
            currentOpeningCase = null;
        }
        
        window.goBackFromCase = goBackFromCase;

        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOMContentLoaded - –Ω–∞—á–∏–Ω–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é');
            
            const mainPage = document.getElementById('mainPage');
            const casesPage = document.getElementById('casesPage');
            const detailPage = document.getElementById('caseDetailPage');
            const profilePage = document.getElementById('profilePage');
            
            if (!mainPage || !detailPage || !profilePage) {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!');
                return;
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º mainPage (—Å—Ç–∞—Ä–æ–µ –º–µ–Ω—é) –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            mainPage.style.display = 'none';
            mainPage.style.visibility = 'hidden';
            mainPage.style.opacity = '0';
            mainPage.classList.add('hidden');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–µ–π—Å–æ–≤ –µ—Å–ª–∏ –æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞
            if (casesPage) {
                casesPage.style.display = 'block';
                casesPage.style.visibility = 'visible';
                casesPage.style.opacity = '1';
            }
            
            detailPage.style.display = 'none';
            detailPage.classList.remove('active');
            profilePage.style.display = 'none';
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–µ–π—Å—ã
            loadCases();
            
            // –°–†–ê–ó–£ –æ–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            setTimeout(function() {
                    if (typeof updateBalanceDisplay === 'function') {
                    console.log('üí∞ –û–±–Ω–æ–≤–ª—è—é –±–∞–ª–∞–Ω—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ...');
                        updateBalanceDisplay();
                } else {
                    console.error('‚ùå updateBalanceDisplay –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                    }
                }, 100);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –°–†–ê–ó–£ –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
            console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é...');
            
            function doInit() {
                console.log('üîß –í—ã–∑—ã–≤–∞—é initEventHandlers...');
                if (typeof initEventHandlers === 'function') {
                    initEventHandlers();
                } else {
                    console.error('‚ùå initEventHandlers –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                }
                
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –≤—ã–≤–æ–¥–∞
                if (typeof initTopUpHandlers === 'function') {
                    initTopUpHandlers();
                }
                if (typeof initWithdrawHandlers === 'function') {
                    initWithdrawHandlers();
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–µ–π—Å–æ–≤
                const cards = document.querySelectorAll('.case-card');
                console.log('üìã –ù–∞–π–¥–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–µ–π—Å–æ–≤:', cards.length);
                cards.forEach((card, i) => {
                    const caseNum = card.dataset.case;
                    console.log(`üìã –ö–µ–π—Å ${i}: data-case="${caseNum}", onclick="${card.getAttribute('onclick')}"`);
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–Ω–æ–ø–∫–∏
                const makeBetBtn = document.getElementById('makeBetBtn');
                const minesStartBtn = document.getElementById('minesStartBtn');
                const diceStartBtn = document.getElementById('diceStartBtn');
                console.log('üìã makeBetBtn:', makeBetBtn ? '–Ω–∞–π–¥–µ–Ω–∞' : '–ù–ï –ù–ê–ô–î–ï–ù–ê');
                console.log('üìã minesStartBtn:', minesStartBtn ? '–Ω–∞–π–¥–µ–Ω–∞' : '–ù–ï –ù–ê–ô–î–ï–ù–ê');
                console.log('üìã diceStartBtn:', diceStartBtn ? '–Ω–∞–π–¥–µ–Ω–∞' : '–ù–ï –ù–ê–ô–î–ï–ù–ê');
            }
            
            // –í—ã–∑—ã–≤–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
            doInit();
            setTimeout(doInit, 100);
            setTimeout(doInit, 300);
            setTimeout(doInit, 500);
            setTimeout(doInit, 1000);
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–¥–∞—Ä–∫–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ –∏–∑ localStorage
            fetchGlobalPrizes();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–∞–ª–∞–Ω—Å –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å) —Å —Å–µ—Ä–≤–µ—Ä–∞
            loadUserData();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–æ—Ñ–∏–ª—è
            updateProfileInfo();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É –∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ö–µ–¥–µ—Ä–µ (—Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ Telegram API)
                setTimeout(() => {
                updateHeaderAvatar();
                // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ API –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
                setTimeout(updateHeaderAvatar, 1000);
            }, 100);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∞—Ä–∫–æ–≤ –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
            setInterval(() => {
                    fetchGlobalPrizes();
            }, 3000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ (–¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è)
            setInterval(() => {
                if (typeof loadUserData === 'function') {
                    loadUserData();
                }
            }, 5000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∏–∑ –±–æ—Ç–∞)
            document.addEventListener('visibilitychange', () => {
                if (!document.hidden) {
                    if (typeof loadUserData === 'function') {
                        loadUserData();
                    }
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ñ–æ–∫—É—Å–∞ –æ–∫–Ω–∞
            window.addEventListener('focus', () => {
                if (typeof loadUserData === 'function') {
                    loadUserData();
                }
            });
            
            // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ localStorage (–¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏)
            window.addEventListener('storage', (e) => {
                if (e.key === 'globalPrizes') {
                    loadPrizesFromLocalStorage();
                }
                if (e.key === 'userInventory') {
                    loadInventory();
                }
            });
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ
        function initApp() {
            try {
                console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
                
                updateBalanceDisplay();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                loadUserData().catch(err => {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', err);
                });
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑—ã
                fetchGlobalPrizes().catch(err => {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–∑–æ–≤:', err);
                });
                
                console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error);
            }
        }

        // –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞–¥–ø–∏—Å—å "5 TON Demo"
        const tonBalance = document.querySelector('.ton-balance');
        if (tonBalance) {
            tonBalance.style.display = 'none';
            tonBalance.style.visibility = 'hidden';
            tonBalance.style.opacity = '0';
            tonBalance.style.height = '0';
            tonBalance.style.margin = '0';
            tonBalance.style.padding = '0';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏ –∏–º–µ–Ω–∏ –≤ —à–∞–ø–∫–µ
        function updateHeaderAvatar() {
            try {
                console.log('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
                
                // –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
                let user = null;
                
                if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user) {
                    user = tg.initDataUnsafe.user;
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram:', user);
                } else {
                    console.warn('‚ö†Ô∏è Telegram Web App API –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                    console.log('tg:', tg);
                    console.log('tg?.initDataUnsafe:', tg?.initDataUnsafe);
                }
                
                const usernameEl = document.getElementById('username');
                const avatarEl = document.querySelector('.avatar');
                
        if (user) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    if (usernameEl) {
                        const displayName = user.first_name || user.username || user.last_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                        usernameEl.textContent = displayName;
                        console.log('‚úÖ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–æ:', displayName);
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É
                    if (avatarEl) {
                        if (user.photo_url) {
                            // –°–æ–∑–¥–∞–µ–º img —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∫–∏
                    const img = document.createElement('img');
                            img.src = user.photo_url;
                    img.style.width = '100%';
                            img.style.height = '100%';
                            img.style.objectFit = 'cover';
                            img.style.borderRadius = '50%';
                            img.onerror = function() {
                                console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                                avatarEl.innerHTML = 'üë§';
                            };
                    img.onload = function() {
                                console.log('‚úÖ –§–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–æ');
                            };
                            avatarEl.innerHTML = '';
                            avatarEl.appendChild(img);
                            } else {
                            // –ï—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–º–æ–¥–∑–∏
                            avatarEl.innerHTML = 'üë§';
                            console.log('‚ÑπÔ∏è –§–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —ç–º–æ–¥–∑–∏');
                            }
                        }
                } else {
                    // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –æ—Å—Ç–∞–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    if (usernameEl) {
                        usernameEl.textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                    }
                    if (avatarEl && !avatarEl.querySelector('img')) {
                        avatarEl.innerHTML = 'üë§';
                    }
                    console.warn('‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
                }
                
                // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ
                const profileUsernameEl = document.getElementById('profileUsername');
                if (profileUsernameEl && user) {
                    const displayName = user.first_name || user.username || user.last_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                    profileUsernameEl.textContent = displayName;
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∫–∏:', error);
            }
        }
        
        // –í—ã–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        // updateHeaderAvatar –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ –≤ DOMContentLoaded

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–±–æ–≤ (—É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ initEventHandlers)
        

        document.querySelector('.subscribe-btn').addEventListener('click', () => {
            if (tg) {
                tg.openTelegramLink('https://t.me/YourChannel');
                tg.HapticFeedback.impactOccurred('medium');
            } else {
                window.open('https://t.me/YourChannel', '_blank');
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "+" –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ - –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ initTopUpHandlers

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
        function updateProfileInfo() {
            const user = tg?.initDataUnsafe?.user;
            const profileUsername = document.getElementById('profileUsername');
            const profileAvatar = document.getElementById('profileAvatarImg');
            const profileAvatarContainer = document.getElementById('profileAvatar');
            
            if (user) {
                if (profileUsername) {
                    profileUsername.textContent = user.first_name || user.username || 'User';
                }
                
                if (profileAvatarContainer) {
                    if (user.photo_url) {
                        // –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è, —Å–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º img —ç–ª–µ–º–µ–Ω—Ç
                        if (!profileAvatar) {
                            const img = document.createElement('img');
                            img.id = 'profileAvatarImg';
                            img.alt = 'Avatar';
                            img.style.width = '100%';
                            img.style.height = '100%';
                            img.style.objectFit = 'cover';
                            img.style.borderRadius = '50%';
                            profileAvatarContainer.appendChild(img);
                        }
                        const img = profileAvatar || document.getElementById('profileAvatarImg');
                        if (img) {
                            img.src = user.photo_url;
                            img.style.display = 'block';
                            img.onerror = function() {
                                // –ï—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–º–æ–¥–∑–∏
                                this.style.display = 'none';
                                if (!profileAvatarContainer.querySelector('span')) {
                                    const fallback = document.createElement('span');
                                    fallback.textContent = 'üë§';
                                    fallback.style.fontSize = '60px';
                                    profileAvatarContainer.appendChild(fallback);
                                }
                            };
                        }
            } else {
                        // –ï—Å–ª–∏ —Ñ–æ—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–º–æ–¥–∑–∏
                        profileAvatarContainer.innerHTML = '';
                        const fallback = document.createElement('span');
                        fallback.textContent = 'üë§';
                        fallback.style.fontSize = '60px';
                        profileAvatarContainer.appendChild(fallback);
                    }
                }
            }
        }
        
        // –¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É –≤ —à–∞–ø–∫–µ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
        updateProfileInfo();
        updateHeaderAvatar();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function updateInventory() {
            console.log('üîµ updateInventory –≤—ã–∑–≤–∞–Ω–∞, userInventory:', userInventory);
            
            const inventoryGrid = document.getElementById('inventoryGrid');
            const inventoryCount = document.getElementById('inventoryCount');
            
            if (!inventoryGrid) {
                console.warn('‚ö†Ô∏è inventoryGrid –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ userInventory —ç—Ç–æ –º–∞—Å—Å–∏–≤
            if (!Array.isArray(userInventory)) {
                console.error('‚ùå userInventory –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Å–∏–≤–æ–º:', typeof userInventory);
                userInventory = [];
            }
            
            console.log('‚úÖ –í—Å–µ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ:', userInventory.length);
            
            inventoryGrid.innerHTML = '';
            
            if (inventoryCount) {
                inventoryCount.textContent = userInventory.length;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∞–∫—Å–∏–º—É–º 9 –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (3x3), + —Å–ª–æ—Ç –¥–ª—è –ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏—è
            const itemsToShow = userInventory.slice(0, 8);
            console.log('‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é –ø—Ä–µ–¥–º–µ—Ç–æ–≤:', itemsToShow.length);
            
            itemsToShow.forEach((item, index) => {
                const slot = document.createElement('div');
                slot.className = 'inventory-slot has-item';
                slot.dataset.itemId = item.id || index;
                slot.dataset.itemIndex = index;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–±—Ä–∞–Ω –ª–∏ —ç—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç
                if (selectedInventoryItem && selectedInventoryItem.id === item.id) {
                    slot.classList.add('selected');
                }
                
                const iconStr = String(item.icon || '');
                if (iconStr.toLowerCase().includes('.png') || iconStr.toLowerCase().includes('.jpg') || iconStr.toLowerCase().includes('.jpeg') || iconStr.toLowerCase().includes('.gif') || iconStr.toLowerCase().includes('.webp')) {
                    const img = document.createElement('img');
                    img.src = item.icon;
                    img.alt = item.name || '–ü—Ä–µ–¥–º–µ—Ç';
                    img.onerror = function() {
                        slot.innerHTML = '<span class="empty-icon">üéÅ</span>';
                    };
                    slot.appendChild(img);
                } else {
                    slot.innerHTML = `<span class="empty-icon">${item.icon || 'üéÅ'}</span>`;
                }
                
                const valueBadge = document.createElement('div');
                valueBadge.className = 'item-value';
                valueBadge.innerHTML = formatPrice(item.value);
                slot.appendChild(valueBadge);
                
                // –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–∞
                function selectItem() {
                    // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                    document.querySelectorAll('.inventory-slot').forEach(s => {
                        s.classList.remove('selected');
                    });
                    
                    // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç
                    slot.classList.add('selected');
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç
                    selectedInventoryItem = item;
                    
                    console.log('‚úÖ –ü—Ä–µ–¥–º–µ—Ç –≤—ã–±—Ä–∞–Ω:', item);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                    if (typeof showInventoryItemModal === 'function') {
                        showInventoryItemModal(item);
                    } else if (typeof window.showInventoryItemModal === 'function') {
                        window.showInventoryItemModal(item);
                    }
                    
                    // –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
                    if (tg) {
                        tg.HapticFeedback.impactOccurred('light');
                    }
                }
                
                // –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                slot.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ –ö–ª–∏–∫ –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:', item);
                    selectItem();
                };
                
                slot.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ –ö–ª–∏–∫ –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è (addEventListener):', item);
                    selectItem();
                }, true);
                
                slot.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ Touch –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:', item);
                    selectItem();
                }, { passive: false });
                
                // –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –∫–ª–∏–∫–∞–±–µ–ª–µ–Ω
                slot.style.cursor = 'pointer';
                slot.style.pointerEvents = 'auto';
                slot.style.zIndex = '10';
                slot.style.position = 'relative';
                
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
                slot.title = `–ö–ª–∏–∫–Ω–∏—Ç–µ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –∏ –ø—Ä–æ–¥–∞—Ç—å\n${item.name || '–ü—Ä–µ–¥–º–µ—Ç'}\n–¶–µ–Ω–∞: ${item.value.toFixed(2)}`;
                
                inventoryGrid.appendChild(slot);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ —Å–ª–æ—Ç—ã –∏–ª–∏ —Å–ª–æ—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const remaining = userInventory.length - itemsToShow.length;
            const slotsNeeded = 9 - itemsToShow.length;
            
            for (let i = 0; i < slotsNeeded; i++) {
                const slot = document.createElement('div');
                slot.className = 'inventory-slot';
                
                if (i === slotsNeeded - 1 && remaining > 0) {
                    slot.innerHTML = '<span class="next-icon">‚Üí</span>';
                    slot.addEventListener('click', () => {
            if (tg) {
                            tg.showAlert('–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
                        }
                    });
                } else {
                    slot.innerHTML = '<span class="empty-icon">üéÅ</span>';
                }
                
                inventoryGrid.appendChild(slot);
            }
        }
        
        // –ü—Ä–æ–¥–∞–∂–∞ –≤—Å–µ—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
        function sellAllItems() {
            if (userInventory.length === 0) {
                if (tg) {
                    tg.showAlert('–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç');
                } else {
                    alert('–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç');
                }
                return;
            }
            
            const totalValue = userInventory.reduce((sum, item) => sum + item.value, 0);
            
            if (tg) {
                tg.showConfirm(`–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã –∑–∞ ${formatPrice(totalValue)}?`, (confirmed) => {
                    if (confirmed) {
                        if (changeBalance(totalValue, 'sellAll')) {
                            userInventory = [];
                            saveInventory(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∞–ª–∞–Ω—Å –ª–æ–∫–∞–ª—å–Ω–æ
                            saveUserData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                            updateInventory();
                            tg.HapticFeedback.notificationOccurred('success');
                        }
                    }
                });
            } else {
                if (confirm(`–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã –∑–∞ ${totalValue.toFixed(2)}?`)) {
                    if (changeBalance(totalValue, 'sellAll')) {
                        userInventory = [];
                        saveInventory(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∞–ª–∞–Ω—Å –ª–æ–∫–∞–ª—å–Ω–æ
                        saveUserData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                        updateInventory();
                    }
                }
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç–∞–±–æ–≤
        function initTabs() {
            try {
                const tabs = document.querySelectorAll('.tab');
                if (tabs.length > 0) {
                    console.log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ ${tabs.length} —Ç–∞–±–æ–≤`);
                    tabs.forEach(tab => {
                        const newTab = tab.cloneNode(true);
                        tab.parentNode.replaceChild(newTab, tab);
                        
                        newTab.addEventListener('click', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                            newTab.classList.add('active');
                            currentTab = newTab.dataset.tab;
                            console.log('–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω —Ç–∞–±:', currentTab);
                        });
                    });
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–±–æ–≤:', error);
            }
        }
        
        // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
        function openTopUpModal() {
            window.openTopUpModal = openTopUpModal; // –î–µ–ª–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–π
            console.log('openTopUpModal –≤—ã–∑–≤–∞–Ω–∞');
            const modal = document.getElementById('topUpModal');
            console.log('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞–π–¥–µ–Ω–æ:', modal);
            if (modal) {
                modal.classList.add('active');
                modal.style.display = 'flex';
                modal.style.zIndex = '10000';
                console.log('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ');
                if (tg) {
                    tg.HapticFeedback.impactOccurred('medium');
                }
            } else {
                console.error('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ topUpModal –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!');
            }
        }

        function closeTopUpModal() {
            const modal = document.getElementById('topUpModal');
            if (modal) {
                modal.classList.remove('active');
                modal.style.display = 'none';
                if (tg) {
                tg.HapticFeedback.impactOccurred('light');
                }
            }
        }
        
        function openWithdrawModal() {
            window.openWithdrawModal = openWithdrawModal; // –î–µ–ª–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–π
            console.log('openWithdrawModal –≤—ã–∑–≤–∞–Ω–∞');
            const modal = document.getElementById('withdrawModal');
            console.log('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ –Ω–∞–π–¥–µ–Ω–æ:', modal);
            if (modal) {
                modal.classList.add('active');
                modal.style.display = 'flex';
                modal.style.zIndex = '10000';
                console.log('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ –æ—Ç–∫—Ä—ã—Ç–æ');
                if (tg) {
                    tg.HapticFeedback.impactOccurred('medium');
                }
            } else {
                console.error('–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ withdrawModal –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!');
            }
        }

        function closeWithdrawModal() {
            const modal = document.getElementById('withdrawModal');
            if (modal) {
                modal.classList.remove('active');
                modal.style.display = 'none';
                if (tg) {
                    tg.HapticFeedback.impactOccurred('light');
                }
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        function initTopUpHandlers() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å" - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞
            // –ù–ï —Ç—Ä–æ–≥–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –ø—Ä–æ—Ñ–∏–ª–µ, –æ–Ω–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ initProfileHandlers
            const topUpBtn = document.getElementById('topUpBtn');
            if (topUpBtn && !topUpBtn.hasAttribute('data-handler-set')) {
                console.log('–ù–∞–π–¥–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ topUpBtn, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞');
                
                // –ü–æ–º–µ—á–∞–µ–º, —á—Ç–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                topUpBtn.setAttribute('data-handler-set', 'true');
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç
                topUpBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    console.log('‚úÖ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ü–æ–ø–æ–ª–Ω–∏—Ç—å - –æ—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ');
                    if (typeof openTopUpModal === 'function') {
                        openTopUpModal();
                    } else {
                        console.error('–§—É–Ω–∫—Ü–∏—è openTopUpModal –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    }
                    return false;
                }, { capture: true, once: false });
                
                console.log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
            } else if (!topUpBtn) {
                console.warn('–ö–Ω–æ–ø–∫–∞ topUpBtn –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ—Ñ–∏–ª—è)');
            }

            // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram Wallet
            const telegramWalletBtn = document.getElementById('telegramWalletBtn');
            if (telegramWalletBtn) {
                telegramWalletBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    closeTopUpModal();
                    
                    try {
                        const userId = getUserId();
                        if (!userId) {
                            throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                        }

                        // –û—Ç–∫—Ä—ã–≤–∞–µ–º –±–æ—Ç–∞ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram Wallet
                        // –°—É–º–º–∞ –±—É–¥–µ—Ç –≤—ã–±—Ä–∞–Ω–∞ –≤ –±–æ—Ç–µ
                        const botUsername = 'Znakomstva13_bot';
                        const botUrl = `https://t.me/${botUsername}?start=wallet_${userId}`;
                        
                        if (tg) {
                            if (tg.openTelegramLink) {
                                tg.openTelegramLink(botUrl);
                            } else {
                                tg.openLink(botUrl);
                            }
                            tg.HapticFeedback.impactOccurred('medium');
                            
                            setTimeout(() => {
                                if (tg.showAlert) {
                                    tg.showAlert('–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É /pay –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram Wallet');
                                }
                            }, 500);
                        } else {
                            window.open(botUrl, '_blank');
                            alert('–ë–æ—Ç –æ—Ç–∫—Ä—ã—Ç. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É /pay –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram Wallet.');
                        }
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞:', error);
                        if (tg && tg.showAlert) {
                            tg.showAlert('–û—à–∏–±–∫–∞: ' + error.message);
                        }
                    }
                });
            }

            // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞
            const telegramBotBtn = document.getElementById('telegramBotBtn');
            if (telegramBotBtn) {
                telegramBotBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    closeTopUpModal();
                    
                    const botUsername = 'Znakomstva13_bot';
                    const userId = getUserId();
                    const botUrl = `https://t.me/${botUsername}?start=cryptobot_${userId}`;
                    
                    console.log('–û—Ç–∫—Ä—ã–≤–∞–µ–º –±–æ—Ç–∞ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ CryptoBot:', botUrl, 'User ID:', userId);
                    
                    if (tg) {
                        if (tg.openTelegramLink) {
                            tg.openTelegramLink(botUrl);
                        } else {
                            tg.openLink(botUrl);
                        }
                        tg.HapticFeedback.impactOccurred('medium');
                        
                        setTimeout(() => {
                            if (tg.showAlert) {
                                tg.showAlert('–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É /pay –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ CryptoBot');
                            }
                        }, 500);
                    } else {
                        window.open(botUrl, '_blank');
                        alert('–ë–æ—Ç –æ—Ç–∫—Ä—ã—Ç. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É /pay –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ CryptoBot.');
                    }
                });
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ "+" —Ä—è–¥–æ–º —Å –±–∞–ª–∞–Ω—Å–æ–º
            // –û—Å–Ω–æ–≤–Ω–æ–π –±–∞–ª–∞–Ω—Å –≤ —Ö–µ–¥–µ—Ä–µ
            const mainBalancePlusBtn = document.querySelector('.balance-section button');
            if (mainBalancePlusBtn) {
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                const newMainBtn = mainBalancePlusBtn.cloneNode(true);
                mainBalancePlusBtn.parentNode.replaceChild(newMainBtn, mainBalancePlusBtn);
                
                newMainBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    console.log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ + –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ');
                    openTopUpModal();
                    return false;
                }, true);
            }
            
            // –ë–∞–ª–∞–Ω—Å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫—Ä–∞—à–∞
            const crashBalancePlusBtn = document.getElementById('crashBalance')?.parentElement?.querySelector('button');
            if (crashBalancePlusBtn) {
                // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                const newCrashBtn = crashBalancePlusBtn.cloneNode(true);
                crashBalancePlusBtn.parentNode.replaceChild(newCrashBtn, crashBalancePlusBtn);
                
                newCrashBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    console.log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ + –≤ –±–∞–ª–∞–Ω—Å–µ –∫—Ä–∞—à–∞');
                    openTopUpModal();
                    return false;
                }, true);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ - –¥–µ–ª–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫
        function initTopUpHandlersWithRetry(retries = 3) {
            const topUpBtn = document.getElementById('topUpBtn');
            if (!topUpBtn && retries > 0) {
                setTimeout(() => initTopUpHandlersWithRetry(retries - 1), 100);
                return;
            }
            
            if (topUpBtn) {
                initTopUpHandlers();
                console.log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
            } else {
                console.error('–ö–Ω–æ–ø–∫–∞ topUpBtn –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫');
            }
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(initTopUpHandlersWithRetry, 100);
            });
        } else {
            setTimeout(initTopUpHandlersWithRetry, 100);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤—ã–≤–æ–¥–∞
        function initWithdrawHandlers() {
            const withdrawBtn = document.getElementById('withdrawBtn');
            if (withdrawBtn) {
                const newWithdrawBtn = withdrawBtn.cloneNode(true);
                withdrawBtn.parentNode.replaceChild(newWithdrawBtn, withdrawBtn);
                newWithdrawBtn.onclick = null;
                newWithdrawBtn.removeEventListener('click', () => {});
                newWithdrawBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    e.stopImmediatePropagation();
                    console.log('–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –í—ã–≤–µ—Å—Ç–∏ - –æ—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ');
                    openWithdrawModal();
                    return false;
                }, true);
            }
            
            // –í—ã–≤–æ–¥ —á–µ—Ä–µ–∑ Telegram Wallet
            const withdrawTelegramWalletBtn = document.getElementById('withdrawTelegramWalletBtn');
            if (withdrawTelegramWalletBtn) {
                withdrawTelegramWalletBtn.addEventListener('click', async (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    closeWithdrawModal();
                    
                    try {
                        const userId = getUserId();
                        if (!userId) {
                            throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
                        if (_balance <= 0) {
                            if (tg && tg.showAlert) {
                                tg.showAlert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞');
                            } else {
                                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞');
                            }
                            return;
                        }
                        
                        // –û—Ç–∫—Ä—ã–≤–∞–µ–º –±–æ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ Telegram Wallet
                        const botUsername = 'Znakomstva13_bot';
                        const botUrl = `https://t.me/${botUsername}?start=withdraw_wallet_${userId}`;
                        
                        if (tg) {
                            if (tg.openTelegramLink) {
                                tg.openTelegramLink(botUrl);
                            } else {
                                tg.openLink(botUrl);
                            }
                            tg.HapticFeedback.impactOccurred('medium');
                            
                            setTimeout(() => {
                                if (tg.showAlert) {
                                    tg.showAlert('–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É /withdraw –¥–ª—è –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ Telegram Wallet');
                                }
                            }, 500);
                        } else {
                            window.open(botUrl, '_blank');
                            alert('–ë–æ—Ç –æ—Ç–∫—Ä—ã—Ç. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É /withdraw –¥–ª—è –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ Telegram Wallet.');
                        }
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞:', error);
                        if (tg && tg.showAlert) {
                            tg.showAlert('–û—à–∏–±–∫–∞: ' + error.message);
                        }
                    }
                });
            }
            
            // –í—ã–≤–æ–¥ —á–µ—Ä–µ–∑ CryptoBot
            const withdrawTelegramBotBtn = document.getElementById('withdrawTelegramBotBtn');
            if (withdrawTelegramBotBtn) {
                withdrawTelegramBotBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    closeWithdrawModal();
                    
                    const botUsername = 'Znakomstva13_bot';
                    const userId = getUserId();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
                    if (_balance <= 0) {
                        if (tg && tg.showAlert) {
                            tg.showAlert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞');
                        } else {
                            alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞');
                        }
                        return;
                    }
                    
                    const botUrl = `https://t.me/${botUsername}?start=withdraw_cryptobot_${userId}`;
                    
                    console.log('–û—Ç–∫—Ä—ã–≤–∞–µ–º –±–æ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ CryptoBot:', botUrl, 'User ID:', userId);
                    
                    if (tg) {
                        if (tg.openTelegramLink) {
                            tg.openTelegramLink(botUrl);
                        } else {
                            tg.openLink(botUrl);
                        }
                        tg.HapticFeedback.impactOccurred('medium');
                        
                        setTimeout(() => {
                            if (tg.showAlert) {
                                tg.showAlert('–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É /withdraw –¥–ª—è –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ CryptoBot');
                            }
                        }, 500);
                    } else {
                        window.open(botUrl, '_blank');
                        alert('–ë–æ—Ç –æ—Ç–∫—Ä—ã—Ç. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É /withdraw –¥–ª—è –≤—ã–≤–æ–¥–∞ —á–µ—Ä–µ–∑ CryptoBot.');
                    }
                });
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–≤–æ–¥–∞
        function initWithdrawHandlersWithRetry(retries = 3) {
            const withdrawBtn = document.getElementById('withdrawBtn');
            if (!withdrawBtn && retries > 0) {
                setTimeout(() => initWithdrawHandlersWithRetry(retries - 1), 100);
                return;
            }
            
            if (withdrawBtn) {
                initWithdrawHandlers();
                console.log('–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–≤–æ–¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
            }
        }
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(initWithdrawHandlersWithRetry, 150);
            });
        } else {
            setTimeout(initWithdrawHandlersWithRetry, 150);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–¥–∞—Ç—å –≤—Å–µ"
        const sellAllBtn = document.getElementById('sellAllBtn');
        if (sellAllBtn) {
            sellAllBtn.addEventListener('click', sellAllItems);
        }
        
        // –¢–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        let selectedInventoryItem = null;
        
        // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function showInventoryItemModal(item) {
            console.log('üîµ showInventoryItemModal –≤—ã–∑–≤–∞–Ω–∞, –ø—Ä–µ–¥–º–µ—Ç:', item);
            if (!item) {
                console.error('‚ùå –ü—Ä–µ–¥–º–µ—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω');
                return;
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç
            selectedInventoryItem = item;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
            document.querySelectorAll('.inventory-slot').forEach(slot => {
                slot.classList.remove('selected');
                const itemId = slot.dataset.itemId;
                if (itemId && item.id && String(itemId) === String(item.id)) {
                    slot.classList.add('selected');
                }
            });
            const modal = document.getElementById('inventoryItemModal');
            const modalIcon = document.getElementById('inventoryModalIcon');
            const modalName = document.getElementById('inventoryModalName');
            const modalPrice = document.getElementById('inventoryModalPrice');
            
            if (!modal) {
                console.error('‚ùå –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ');
                return;
            }
            
            if (!modalIcon || !modalName || !modalPrice) {
                console.error('‚ùå –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                return;
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ
            modalName.textContent = item.name || '–ü—Ä–µ–¥–º–µ—Ç';
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–Ω—É
            modalPrice.innerHTML = formatPrice(item.value || 0);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∫–æ–Ω–∫—É
            modalIcon.innerHTML = '';
            const iconStr = String(item.icon || '');
            if (iconStr.toLowerCase().includes('.png') || iconStr.toLowerCase().includes('.jpg') || iconStr.toLowerCase().includes('.jpeg') || iconStr.toLowerCase().includes('.gif') || iconStr.toLowerCase().includes('.webp')) {
                const img = document.createElement('img');
                img.src = item.icon;
                img.alt = item.name || '–ü—Ä–µ–¥–º–µ—Ç';
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'contain';
                img.onerror = function() {
                    modalIcon.innerHTML = '<span style="font-size: 80px;">üéÅ</span>';
                };
                modalIcon.appendChild(img);
            } else {
                modalIcon.innerHTML = `<span style="font-size: 80px;">${item.icon || 'üéÅ'}</span>`;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            modal.classList.add('active');
            modal.style.display = 'flex';
            modal.style.zIndex = '3000';
            
            // –ü–µ—Ä–µ–ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–¥–∞–∂–∏
            const sellBtn = document.getElementById('sellItemBtn');
            if (sellBtn) {
                const newSellBtn = sellBtn.cloneNode(true);
                sellBtn.parentNode.replaceChild(newSellBtn, sellBtn);
                
                newSellBtn.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ø—Ä–æ–¥–∞–∂–∏');
                    if (typeof sellSelectedItem === 'function') {
                        sellSelectedItem();
                    } else if (typeof window.sellSelectedItem === 'function') {
                        window.sellSelectedItem();
                    } else {
                        console.error('‚ùå sellSelectedItem –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                        alert('–§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–¥–∞–∂–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    }
                };
                
                newSellBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (typeof sellSelectedItem === 'function') {
                        sellSelectedItem();
                    } else if (typeof window.sellSelectedItem === 'function') {
                        window.sellSelectedItem();
                    }
                }, true);
            }
            
            if (tg) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }
        
        // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≥–ª–æ–±–∞–ª—å–Ω–æ–π
        window.showInventoryItemModal = showInventoryItemModal;
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–µ–¥–º–µ—Ç–∞ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function closeInventoryModal() {
            const modal = document.getElementById('inventoryItemModal');
            if (modal) {
                modal.classList.remove('active');
            }
            selectedInventoryItem = null;
            
            if (tg) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }
        
        window.closeInventoryModal = closeInventoryModal;

        // –ò–ì–†–ê –ú–ò–ù–´
        // minesGameState —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞
        
        function initMinesGame() {
            const grid = document.getElementById('minesGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            minesGameState.grid = [];
            minesGameState.opened = [];
            minesGameState.gameActive = false;
            minesGameState.currentMultiplier = 1.0;
            
            for (let i = 0; i < minesGameState.gridSize; i++) {
                const cell = document.createElement('div');
                cell.className = 'mines-cell';
                cell.dataset.index = i;
                cell.textContent = '?';
                grid.appendChild(cell);
                minesGameState.grid.push({ isMine: false, revealed: false, index: i });
            }
            
            document.getElementById('minesOpenedCount').textContent = '0';
            document.getElementById('minesMultiplier').textContent = 'x1.00';
            document.getElementById('minesWinnings').textContent = '0.00';
            document.getElementById('minesTotalCount').textContent = minesGameState.minesCount;
            document.getElementById('minesCashOutBtn').disabled = true;
            document.getElementById('minesStartBtn').textContent = '–ù–∞—á–∞—Ç—å –∏–≥—Ä—É';
            document.getElementById('minesStartBtn').disabled = false;
            document.getElementById('minesBetAmount').disabled = false;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –≤—ã–±–æ—Ä–∞ –º–∏–Ω
            document.querySelectorAll('.mines-count-btn').forEach(btn => {
                if (parseInt(btn.dataset.count) === minesGameState.minesCount) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–ª–µ—Ç–æ–∫
            setupMinesCellHandlers();
            
            // –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
            const minesStartBtn = document.getElementById('minesStartBtn');
            if (minesStartBtn) {
                const newBtn = minesStartBtn.cloneNode(true);
                minesStartBtn.parentNode.replaceChild(newBtn, minesStartBtn);
                newBtn.onclick = startMinesGame;
                newBtn.addEventListener('click', startMinesGame);
                window.handleMinesStart = function(e) {
                    if (e) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                    startMinesGame();
                };
            }
            
            const minesCashOutBtn = document.getElementById('minesCashOutBtn');
            if (minesCashOutBtn) {
                const newBtn = minesCashOutBtn.cloneNode(true);
                minesCashOutBtn.parentNode.replaceChild(newBtn, minesCashOutBtn);
                newBtn.addEventListener('click', cashOutMines);
            }
            
            // –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω
            document.querySelectorAll('.mines-count-btn').forEach(btn => {
                const newBtn = btn.cloneNode(true);
                btn.parentNode.replaceChild(newBtn, btn);
                newBtn.addEventListener('click', function() {
                    minesGameState.minesCount = parseInt(newBtn.dataset.count);
                    document.querySelectorAll('.mines-count-btn').forEach(b => b.classList.remove('active'));
                    newBtn.classList.add('active');
                    const totalCountEl = document.getElementById('minesTotalCount');
                    if (totalCountEl) {
                        totalCountEl.textContent = minesGameState.minesCount;
                    }
                    updateMinesMultiplier();
                });
            });
        }
        
        function setupMinesCellHandlers() {
            const minesGrid = document.getElementById('minesGrid');
            if (!minesGrid) return;
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ
            const cells = minesGrid.querySelectorAll('.mines-cell');
            cells.forEach(cell => {
                const newCell = cell.cloneNode(true);
                cell.parentNode.replaceChild(newCell, cell);
                newCell.addEventListener('click', function() {
                    if (minesGameState.gameActive) {
                        const index = parseInt(this.dataset.index);
                        openMinesCell(index);
                    }
                });
            });
        }

        function startMinesGame() {
            window.startMinesGame = startMinesGame; // –î–µ–ª–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–π
            if (minesGameState.gameActive) return;
            
            minesGameState.betAmount = parseFloat(document.getElementById('minesBetAmount').value) || 0.1;
            
            if (_balance < minesGameState.betAmount) {
                if (tg) {
                    tg.showAlert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
                } else {
                    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
                }
                return;
            }
            
            if (!changeBalance(-minesGameState.betAmount, 'minesBet')) {
                return;
            }
            saveInventory();
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –º–∏–Ω—ã
            minesGameState.mines = [];
            minesGameState.opened = [];
            minesGameState.currentMultiplier = 1.0;
            minesGameState.gameActive = true;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –∫–ª–µ—Ç–∫–∏
            minesGameState.grid.forEach(cell => {
                cell.isMine = false;
                cell.revealed = false;
            });
            
            const gridSize = minesGameState.gridSize;
            while (minesGameState.mines.length < minesGameState.minesCount) {
                const randomIndex = Math.floor(Math.random() * gridSize);
                if (!minesGameState.mines.includes(randomIndex)) {
                    minesGameState.mines.push(randomIndex);
                    minesGameState.grid[randomIndex].isMine = true;
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–Ω–æ–∂–∏—Ç–µ–ª—è –≤ –Ω–∞—á–∞–ª–µ –∏–≥—Ä—ã
            updateMinesMultiplier();
            
            document.getElementById('minesStartBtn').textContent = '–ò–≥—Ä–∞ –∏–¥–µ—Ç...';
            document.getElementById('minesStartBtn').disabled = true;
            document.getElementById('minesBetAmount').disabled = true;
            document.getElementById('minesCashOutBtn').disabled = false;
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã
            document.querySelectorAll('.mines-count-btn').forEach(btn => {
                btn.disabled = true;
                btn.style.opacity = '0.5';
            });
            
            updateMinesDisplay();
            setupMinesCellHandlers();
        }

        function openMinesCell(index) {
            if (!minesGameState.gameActive) return;
            if (minesGameState.opened.includes(index)) return;
            
            const cell = minesGameState.grid[index];
            if (cell.isMine) {
                // –ü—Ä–æ–∏–≥—Ä—ã—à
                endMinesGame(false);
                revealAllMines();
                if (tg) {
                    tg.showAlert('–ú–ò–ù–ê! –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!');
                    tg.HapticFeedback.notificationOccurred('error');
                } else {
                    alert('–ú–ò–ù–ê! –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!');
                }
                return;
            }
            
            minesGameState.opened.push(index);
            cell.revealed = true;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å (—á–µ–º –±–æ–ª—å—à–µ –º–∏–Ω, —Ç–µ–º –±–æ–ª—å—à–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ)
            const openedCount = minesGameState.opened.length;
            let multiplierIncrease;
            if (minesGameState.minesCount === 3) {
                multiplierIncrease = 0.15; // +0.15 –∑–∞ –∫–ª–µ—Ç–∫—É –¥–ª—è 3 –º–∏–Ω
            } else if (minesGameState.minesCount === 5) {
                multiplierIncrease = 0.2; // +0.2 –∑–∞ –∫–ª–µ—Ç–∫—É –¥–ª—è 5 –º–∏–Ω
            } else if (minesGameState.minesCount === 10) {
                multiplierIncrease = 0.3; // +0.3 –∑–∞ –∫–ª–µ—Ç–∫—É –¥–ª—è 10 –º–∏–Ω
            } else {
                multiplierIncrease = 0.1;
            }
            minesGameState.currentMultiplier = 1.0 + (openedCount * multiplierIncrease);
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateMinesDisplay();
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å
            const multiplierEl = document.getElementById('minesMultiplier');
            const winningsEl = document.getElementById('minesWinnings');
            if (multiplierEl) {
                multiplierEl.textContent = `x${minesGameState.currentMultiplier.toFixed(2)}`;
            }
            if (winningsEl) {
                const winnings = minesGameState.betAmount * minesGameState.currentMultiplier;
                winningsEl.textContent = winnings.toFixed(2);
            }
            
            if (tg) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        function cashOutMines() {
            if (!minesGameState.gameActive) return;
            
            const winnings = minesGameState.betAmount * minesGameState.currentMultiplier;
            changeBalance(winnings, 'minesWin');
            saveInventory();
            
            endMinesGame(true);
            
            if (tg) {
                tg.showAlert(`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winnings.toFixed(2)}!`);
                tg.HapticFeedback.notificationOccurred('success');
            } else {
                alert(`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winnings.toFixed(2)}!`);
            }
        }

        function endMinesGame(won) {
            minesGameState.gameActive = false;
            document.getElementById('minesCashOutBtn').disabled = true;
            document.getElementById('minesStartBtn').textContent = '–ù–æ–≤–∞—è –∏–≥—Ä–∞';
            document.getElementById('minesStartBtn').disabled = false;
            document.getElementById('minesBetAmount').disabled = false;
            
            // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω
            document.querySelectorAll('.mines-count-btn').forEach(btn => {
                btn.disabled = false;
                btn.style.opacity = '1';
            });
            
            if (!won) {
                revealAllMines();
            }
        }

        function revealAllMines() {
            minesGameState.mines.forEach(mineIndex => {
                const cellElement = document.querySelector(`.mines-cell[data-index="${mineIndex}"]`);
                if (cellElement) {
                    cellElement.classList.add('mine');
                    cellElement.textContent = 'üí£';
                }
            });
        }

        function updateMinesDisplay() {
            const cells = document.querySelectorAll('.mines-cell');
            cells.forEach((cellElement, index) => {
                const cell = minesGameState.grid[index];
                if (minesGameState.opened.includes(index)) {
                    cellElement.classList.add('opened', 'safe');
                    cellElement.textContent = '‚úì';
                } else {
                    cellElement.classList.remove('opened', 'safe', 'mine');
                    if (!minesGameState.gameActive) {
                        cellElement.textContent = '?';
                    } else {
                        cellElement.textContent = '?';
                    }
                }
            });
            
            document.getElementById('minesOpenedCount').textContent = minesGameState.opened.length;
        }

        function updateMinesMultiplier() {
            const multiplierEl = document.getElementById('minesMultiplier');
            const winningsEl = document.getElementById('minesWinnings');
            
            if (multiplierEl) {
                multiplierEl.textContent = `x${minesGameState.currentMultiplier.toFixed(2)}`;
            }
            
            if (winningsEl) {
                const winnings = minesGameState.betAmount * minesGameState.currentMultiplier;
                winningsEl.textContent = winnings.toFixed(2);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            const minesStartBtn = document.getElementById('minesStartBtn');
            const minesCashOutBtn = document.getElementById('minesCashOutBtn');
            const minesGrid = document.getElementById('minesGrid');
            
            if (minesStartBtn) {
                minesStartBtn.addEventListener('click', startMinesGame);
            }
            
            if (minesCashOutBtn) {
                minesCashOutBtn.addEventListener('click', cashOutMines);
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –ø–æ –∫–ª–µ—Ç–∫–∞–º (–¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π)
            if (minesGrid) {
                minesGrid.addEventListener('click', (e) => {
                    const cell = e.target.closest('.mines-cell');
                    if (cell && minesGameState.gameActive && !cell.classList.contains('opened')) {
                        const index = parseInt(cell.dataset.index);
                        if (!isNaN(index)) {
                            openMinesCell(index);
                        }
                    }
                });
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω
            document.querySelectorAll('.mines-count-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (minesGameState.gameActive) {
                        if (tg) {
                            tg.showAlert('–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã!');
                        } else {
                            alert('–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã!');
                        }
                        return;
                    }
                    
                    document.querySelectorAll('.mines-count-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    minesGameState.minesCount = parseInt(btn.dataset.count);
                    const totalCountEl = document.getElementById('minesTotalCount');
                    if (totalCountEl) {
                        totalCountEl.textContent = minesGameState.minesCount;
                    }
                });
            });
        });
        
        // –ò–ì–†–ê DICE
        // diceGameState —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞
        
        function initDiceGame() {
            const thresholdSlider = document.getElementById('diceThreshold');
            const thresholdValue = document.getElementById('diceThresholdValue');
            const rollUnderBtn = document.getElementById('diceRollUnderBtn');
            const rollOverBtn = document.getElementById('diceRollOverBtn');
            const autoToggle = document.getElementById('diceAutoToggle');
            const autoStatus = document.getElementById('diceAutoStatus');
            const startBtn = document.getElementById('diceStartBtn');
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–ª–∞–π–¥–µ—Ä–∞
            if (thresholdSlider && thresholdValue) {
                thresholdValue.textContent = diceGameState.threshold;
                thresholdSlider.value = diceGameState.threshold;
                
                // –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–ª–∞–π–¥–µ—Ä–∞
                const newSlider = thresholdSlider.cloneNode(true);
                thresholdSlider.parentNode.replaceChild(newSlider, thresholdSlider);
                
                newSlider.addEventListener('input', (e) => {
                    diceGameState.threshold = parseInt(e.target.value);
                    thresholdValue.textContent = diceGameState.threshold;
                    updateDiceMultiplier();
                });
            }
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å—Ç–∞–≤–∫–∏ - Roll Under
            if (rollUnderBtn) {
                const newBtn = rollUnderBtn.cloneNode(true);
                rollUnderBtn.parentNode.replaceChild(newBtn, rollUnderBtn);
                newBtn.addEventListener('click', () => {
                    diceGameState.rollType = 'under';
                    newBtn.classList.add('active');
                    const rollOver = document.getElementById('diceRollOverBtn');
                    if (rollOver) rollOver.classList.remove('active');
                    updateDiceMultiplier();
                });
            }
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å—Ç–∞–≤–∫–∏ - Roll Over
            if (rollOverBtn) {
                const newBtn = rollOverBtn.cloneNode(true);
                rollOverBtn.parentNode.replaceChild(newBtn, rollOverBtn);
                newBtn.addEventListener('click', () => {
                    diceGameState.rollType = 'over';
                    newBtn.classList.add('active');
                    const rollUnder = document.getElementById('diceRollUnderBtn');
                    if (rollUnder) rollUnder.classList.remove('active');
                    updateDiceMultiplier();
                });
            }
            
            // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∞–≤—Ç–æ-–∏–≥—Ä—ã
            if (autoToggle) {
                const newToggle = autoToggle.cloneNode(true);
                autoToggle.parentNode.replaceChild(newToggle, autoToggle);
                newToggle.checked = diceGameState.autoPlay;
                newToggle.addEventListener('change', (e) => {
                    diceGameState.autoPlay = e.target.checked;
                    if (autoStatus) autoStatus.textContent = diceGameState.autoPlay ? 'ON' : 'OFF';
                    
                    if (diceGameState.autoPlay && !diceGameState.isRolling) {
                        startDiceGame();
                    } else if (!diceGameState.autoPlay) {
                        stopAutoPlay();
                    }
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ START
            if (startBtn) {
                const newBtn = startBtn.cloneNode(true);
                startBtn.parentNode.replaceChild(newBtn, startBtn);
                const diceHandler = () => {
                    if (!diceGameState.isRolling) {
                        startDiceGame();
                    }
                };
                newBtn.onclick = diceHandler;
                newBtn.addEventListener('click', diceHandler);
                window.handleDiceStart = function(e) {
                    if (e) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                    diceHandler();
                };
            }
            
            updateDiceMultiplier();
        }

        function updateDiceMultiplier() {
            // –ú–Ω–æ–∂–∏—Ç–µ–ª—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤—ã–∏–≥—Ä—ã—à–∞
            // –î–ª—è Roll Under: –º–Ω–æ–∂–∏—Ç–µ–ª—å = 99 / threshold
            // –î–ª—è Roll Over: –º–Ω–æ–∂–∏—Ç–µ–ª—å = 99 / (99 - threshold)
            let multiplier;
            if (diceGameState.rollType === 'under') {
                multiplier = 99 / diceGameState.threshold;
            } else {
                multiplier = 99 / (99 - diceGameState.threshold);
            }
            
            const multiplierEl = document.getElementById('diceMultiplier');
            if (multiplierEl) {
                multiplierEl.textContent = `x${multiplier.toFixed(2)}`;
            }
            
            const winningsEl = document.getElementById('diceWinnings');
            if (winningsEl) {
                const winnings = diceGameState.betAmount * multiplier;
                winningsEl.textContent = winnings.toFixed(2);
            }
        }

        function startDiceGame() {
            window.startDiceGame = startDiceGame; // –î–µ–ª–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–π
            if (diceGameState.isRolling) return;
            
            diceGameState.betAmount = parseFloat(document.getElementById('diceBetAmount').value) || 0.1;
            
            if (_balance < diceGameState.betAmount) {
                if (tg) {
                    tg.showAlert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
                } else {
                    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!');
                }
                if (diceGameState.autoPlay) {
                    document.getElementById('diceAutoToggle').checked = false;
                    diceGameState.autoPlay = false;
                    document.getElementById('diceAutoStatus').textContent = 'OFF';
                }
                return;
            }
            
            if (!changeBalance(-diceGameState.betAmount, 'diceBet')) {
                return;
            }
            saveInventory();
            
            diceGameState.isRolling = true;
            const startBtn = document.getElementById('diceStartBtn');
            if (startBtn) {
                startBtn.disabled = true;
                startBtn.textContent = 'ROLLING...';
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –±—Ä–æ—Å–∫–∞
            const resultValue = document.getElementById('diceResultValue');
            const resultText = document.getElementById('diceResultText');
            let rollCount = 0;
            const rollInterval = setInterval(() => {
                rollCount++;
                const randomValue = Math.floor(Math.random() * 100);
                if (resultValue) {
                    resultValue.textContent = randomValue;
                    resultValue.classList.remove('win', 'lose');
                }
                
                if (rollCount > 10) {
                    clearInterval(rollInterval);
                    
                    // –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    const finalRoll = Math.floor(Math.random() * 100);
                    
                    let won = false;
                    if (diceGameState.rollType === 'under') {
                        won = finalRoll < diceGameState.threshold;
                    } else {
                        won = finalRoll > diceGameState.threshold;
                    }
                    
                    if (resultValue) {
                        resultValue.textContent = finalRoll;
                        resultValue.classList.add(won ? 'win' : 'lose');
                    }
                    
                    if (resultText) {
                        resultText.textContent = won ? '–í–´–ò–ì–†–´–®!' : '–ü–†–û–ò–ì–†–´–®';
                        resultText.style.color = won ? '#00ff00' : '#ff0000';
                    }
                    
                    if (won) {
                        const multiplier = diceGameState.rollType === 'under' 
                            ? 99 / diceGameState.threshold 
                            : 99 / (99 - diceGameState.threshold);
                        const winnings = diceGameState.betAmount * multiplier;
                        changeBalance(winnings, 'diceWin');
                        saveInventory();
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–≥—Ä—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                        saveDiceGameToServer({
                            userId: getUserId(),
                            username: getUsername(),
                            result: finalRoll,
                            threshold: diceGameState.threshold,
                            rollType: diceGameState.rollType,
                            betAmount: diceGameState.betAmount,
                            multiplier: multiplier,
                            winnings: winnings,
                            won: true
                        });
                        
                        if (tg) {
                            tg.showAlert(`–í—ã–∏–≥—Ä—ã—à ${winnings.toFixed(2)}!`);
                            tg.HapticFeedback.notificationOccurred('success');
                        }
                    } else {
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–∏–≥—Ä—ã—à–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                        saveDiceGameToServer({
                            userId: getUserId(),
                            username: getUsername(),
                            result: finalRoll,
                            threshold: diceGameState.threshold,
                            rollType: diceGameState.rollType,
                            betAmount: diceGameState.betAmount,
                            multiplier: 0,
                            winnings: 0,
                            won: false
                        });
                        
                        if (tg) {
                            tg.showAlert('–ü—Ä–æ–∏–≥—Ä—ã—à!');
                            tg.HapticFeedback.notificationOccurred('error');
                        }
                    }
                    
                    diceGameState.isRolling = false;
                    if (startBtn) {
                        startBtn.disabled = false;
                        startBtn.textContent = 'START';
                    }
                    
                    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∞–≤—Ç–æ-–∏–≥—Ä—É –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞
                    if (diceGameState.autoPlay) {
                        setTimeout(() => {
                            startDiceGame();
                        }, 1500);
                    } else {
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                        setTimeout(() => {
                            if (resultValue) {
                                resultValue.textContent = '?';
                                resultValue.classList.remove('win', 'lose');
                            }
                            if (resultText) {
                                resultText.textContent = '–ù–∞–∂–º–∏—Ç–µ START';
                                resultText.style.color = 'rgba(255, 255, 255, 0.8)';
                            }
                        }, 3000);
                    }
                }
            }, 50);
        }

        function stopAutoPlay() {
            diceGameState.autoPlay = false;
            diceGameState.isRolling = false;
            const startBtn = document.getElementById('diceStartBtn');
            if (startBtn) {
                startBtn.disabled = false;
                startBtn.textContent = 'START';
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–≥—Ä—ã Dice –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        async function saveDiceGameToServer(gameData) {
            try {
                const userId = getUserId();
                if (!userId) {
                    return;
                }
                
                const response = await fetch(`${API_BASE_URL}/dice/games`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        ...gameData,
                        userId: userId,
                        timestamp: Date.now()
                    })
                });
                
                if (!response.ok) {
                    console.log('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–≥—Ä—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä');
                }
            } catch (error) {
                console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–≥—Ä—ã:', error);
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–Ω–æ–∂–∏—Ç–µ–ª—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞–≤–∫–∏
        document.addEventListener('DOMContentLoaded', () => {
            const diceBetAmount = document.getElementById('diceBetAmount');
            if (diceBetAmount) {
                diceBetAmount.addEventListener('input', () => {
                    diceGameState.betAmount = parseFloat(diceBetAmount.value) || 0.1;
                    updateDiceMultiplier();
                });
            }
        });

        // –ü—Ä–æ–¥–∞–∂–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞
        function sellSelectedItem() {
            console.log('üîµ sellSelectedItem –≤—ã–∑–≤–∞–Ω–∞, selectedInventoryItem:', selectedInventoryItem);
            
            if (!selectedInventoryItem) {
                console.error('‚ùå –ü—Ä–µ–¥–º–µ—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω');
                alert('–ü—Ä–µ–¥–º–µ—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω');
                return;
            }
            
            const item = selectedInventoryItem;
            console.log('‚úÖ –ü—Ä–æ–¥–∞—é –ø—Ä–µ–¥–º–µ—Ç:', item);
            
            const confirmText = `–ü—Ä–æ–¥–∞—Ç—å "${item.name || '–ü—Ä–µ–¥–º–µ—Ç'}" –∑–∞ ${item.value.toFixed(2)}?`;
            
            if (tg && tg.showConfirm) {
                tg.showConfirm(confirmText, (confirmed) => {
                    if (confirmed) {
                        console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –ø—Ä–æ–¥–∞–∂—É');
                        if (changeBalance(item.value, 'sellItem')) {
                            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                            const oldLength = userInventory.length;
                            userInventory = userInventory.filter(invItem => invItem.id !== item.id);
                            console.log('‚úÖ –ü—Ä–µ–¥–º–µ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è. –ë—ã–ª–æ:', oldLength, '–°—Ç–∞–ª–æ:', userInventory.length);
                            
                            saveInventory(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∞–ª–∞–Ω—Å –ª–æ–∫–∞–ª—å–Ω–æ
                            saveUserData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                            
                            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                            selectedInventoryItem = null;
                            document.querySelectorAll('.inventory-slot').forEach(s => {
                                s.classList.remove('selected');
                            });
                            
                            updateInventory();
                            closeInventoryModal();
                            
                            tg.HapticFeedback.notificationOccurred('success');
                        } else {
                            console.error('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å');
                            alert('–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç');
                        }
                    } else {
                        console.log('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª –ø—Ä–æ–¥–∞–∂—É');
                    }
                });
            } else {
                if (confirm(confirmText)) {
                    console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –ø—Ä–æ–¥–∞–∂—É');
                    if (changeBalance(item.value, 'sellItem')) {
                        // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                        const oldLength = userInventory.length;
                        userInventory = userInventory.filter(invItem => invItem.id !== item.id);
                        console.log('‚úÖ –ü—Ä–µ–¥–º–µ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è. –ë—ã–ª–æ:', oldLength, '–°—Ç–∞–ª–æ:', userInventory.length);
                        
                        saveInventory(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–∞–ª–∞–Ω—Å –ª–æ–∫–∞–ª—å–Ω–æ
                        saveUserData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                        
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                        selectedInventoryItem = null;
                        document.querySelectorAll('.inventory-slot').forEach(s => {
                            s.classList.remove('selected');
                        });
                        
                        updateInventory();
                        closeInventoryModal();
                    } else {
                        console.error('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å');
                        alert('–û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç');
                    }
                } else {
                    console.log('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª –ø—Ä–æ–¥–∞–∂—É');
                }
            }
        }
        
        // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≥–ª–æ–±–∞–ª—å–Ω–æ–π
        window.sellSelectedItem = sellSelectedItem;
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–¥–∞—Ç—å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
        function attachSellButtonHandler() {
        const sellItemBtn = document.getElementById('sellItemBtn');
        if (sellItemBtn) {
                console.log('‚úÖ –ü—Ä–∏–≤—è–∑—ã–≤–∞—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫ –∫–Ω–æ–ø–∫–µ –ø—Ä–æ–¥–∞–∂–∏');
                const newBtn = sellItemBtn.cloneNode(true);
                sellItemBtn.parentNode.replaceChild(newBtn, sellItemBtn);
                
                newBtn.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ø—Ä–æ–¥–∞–∂–∏ (onclick)');
                    if (typeof sellSelectedItem === 'function') {
                        sellSelectedItem();
                    } else if (typeof window.sellSelectedItem === 'function') {
                        window.sellSelectedItem();
                    }
                };
                
                newBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('üîµ –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –ø—Ä–æ–¥–∞–∂–∏ (addEventListener)');
                    if (typeof sellSelectedItem === 'function') {
                        sellSelectedItem();
                    } else if (typeof window.sellSelectedItem === 'function') {
                        window.sellSelectedItem();
                    }
                }, true);
            } else {
                console.warn('‚ö†Ô∏è –ö–Ω–æ–ø–∫–∞ sellItemBtn –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –ø–æ–ø—Ä–æ–±—É—é –ø–æ–∑–∂–µ');
                setTimeout(attachSellButtonHandler, 100);
            }
        }
        
        // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', attachSellButtonHandler);
        } else {
            attachSellButtonHandler();
        }

        // ========== –ò–ì–†–ê –ö–†–ê–® ==========
        
        function initCrashGame() {
            const canvas = document.getElementById('crashCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            if (!ctx) return;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã canvas
            const container = canvas.parentElement;
            const containerWidth = container ? container.offsetWidth : window.innerWidth - 40;
            const containerHeight = 300;
            
            const dpr = window.devicePixelRatio || 1;
            canvas.style.width = containerWidth + 'px';
            canvas.style.height = containerHeight + 'px';
            canvas.width = containerWidth * dpr;
            canvas.height = containerHeight * dpr;
            ctx.scale(dpr, dpr);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            updateCrashBalance();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é
            updateCrashHistoryDisplay();
            
            // –ï—Å–ª–∏ –∏–≥—Ä–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞ –∏ –Ω–µ—Ç –∫—É–ª–¥–∞—É–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –∫—É–ª–¥–∞—É–Ω
            if (!crashGameState.isRunning && !crashGameState.isCooldown) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –∫—É–ª–¥–∞—É–Ω –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É
                showCrashCooldown(ctx, canvas);
            }
        }
        
        function startCrashRound(ctx, canvas) {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–Ω–æ –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º hasBet, –µ—Å–ª–∏ —Å—Ç–∞–≤–∫–∞ —É–∂–µ —Å–¥–µ–ª–∞–Ω–∞)
            crashGameState.multiplier = 1.00;
            crashGameState.graphPoints = [];
            crashGameState.isRunning = true;
            crashGameState.isCooldown = false;
            // –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º hasBet - —Å—Ç–∞–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞—É–Ω–¥–∞
            // crashGameState.hasBet = false; // –£–ë–†–ê–ù–û - —Å—Ç–∞–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ü–µ–ª—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –Ω–∞ –¥–∏–∞–ø–∞–∑–æ–Ω 1.0-7.0 (70% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
            // –û—Å—Ç–∞–ª—å–Ω—ã–µ 30% - –æ—Ç 7.0 –¥–æ 30.0
            const random = Math.random();
            
            if (random < 0.7) {
                // 70% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å - –¥–∏–∞–ø–∞–∑–æ–Ω 1.0-7.0
                const seed1 = Date.now() % 1000000;
                const seed2 = Math.random() * 1000000;
                const seed3 = (Date.now() * Math.random()) % 1000000;
                const combinedSeed = (seed1 + seed2 + seed3) % 1000000;
                crashGameState.targetMultiplier = 1.0 + (combinedSeed / 1000000) * 6.0; // 1.0-7.0
            } else {
                // 30% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å - –¥–∏–∞–ø–∞–∑–æ–Ω 7.0-30.0
                const seed1 = Date.now() % 1000000;
                const seed2 = Math.random() * 1000000;
                const seed3 = (Date.now() * Math.random()) % 1000000;
                const combinedSeed = (seed1 + seed2 + seed3) % 1000000;
                crashGameState.targetMultiplier = 7.0 + (combinedSeed / 1000000) * 23.0; // 7.0-30.0
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—É—é –≤–∞—Ä–∏–∞—Ü–∏—é —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–ª—è –±–æ–ª–µ–µ —Ä–∞–Ω–¥–æ–º–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ (—É–º–µ–Ω—å—à–µ–Ω–æ –¥–ª—è –±–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞)
            crashGameState.speedVariation = 0.005 + Math.random() * 0.008; // –û—Ç 0.005 –¥–æ 0.013 (–±—ã–ª–æ 0.015-0.03)
            
            console.log('üöÄ –ù–æ–≤—ã–π —Ä–∞—É–Ω–¥! –¶–µ–ª—å:', crashGameState.targetMultiplier.toFixed(2));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É - –µ—Å–ª–∏ –µ—Å—Ç—å —Å—Ç–∞–≤–∫–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–ó–∞–±—Ä–∞—Ç—å", –∏–Ω–∞—á–µ –±–ª–æ–∫–∏—Ä—É–µ–º
            const betBtn = document.getElementById('crashBetBtn');
            if (betBtn) {
                if (crashGameState.hasBet) {
                    betBtn.textContent = '–ó–∞–±—Ä–∞—Ç—å';
                    betBtn.disabled = false;
                } else {
                    betBtn.textContent = '–†–∞—É–Ω–¥ –Ω–∞—á–∞–ª—Å—è';
                    betBtn.disabled = true;
                }
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            animateCrash(ctx, canvas);
        }
        
        function animateCrash(ctx, canvas) {
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â—É—é –∞–Ω–∏–º–∞—Ü–∏—é
            if (crashGameState.animationId) {
                cancelAnimationFrame(crashGameState.animationId);
            }
            
            const canvasWidth = canvas.width / (window.devicePixelRatio || 1);
            const canvasHeight = canvas.height / (window.devicePixelRatio || 1);
            let frameCount = 0;
            
            const animate = () => {
                if (!crashGameState.isRunning) {
                    crashGameState.animationId = null;
                    return;
                }
                
                frameCount++;
                
                // –û—á–∏—â–∞–µ–º canvas
                ctx.clearRect(0, 0, canvasWidth, canvasHeight);
                ctx.fillStyle = 'rgba(20, 20, 30, 1)';
                ctx.fillRect(0, 0, canvasWidth, canvasHeight);
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å —Ä–∞–Ω–¥–æ–º–Ω–æ–π –≤–∞—Ä–∏–∞—Ü–∏–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à–∏–µ —Å–ª—É—á–∞–π–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –¥–ª—è –±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
                // –°–∫–æ—Ä–æ—Å—Ç—å —É–º–µ–Ω—å—à–µ–Ω–∞ –¥–ª—è –±–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ –≥—Ä–∞—Ñ–∏–∫–∞
                const baseSpeed = crashGameState.speedVariation;
                const randomFactor = 0.8 + Math.random() * 0.4; // –û—Ç 0.8 –¥–æ 1.2
                const speed = baseSpeed * randomFactor * 0.5; // –£–º–Ω–æ–∂–∞–µ–º –Ω–∞ 0.5 –¥–ª—è –∑–∞–º–µ–¥–ª–µ–Ω–∏—è
                crashGameState.multiplier += speed;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫—É –≥—Ä–∞—Ñ–∏–∫–∞
                const x = 10 + crashGameState.graphPoints.length * 2;
                const multPercent = ((crashGameState.multiplier - 1.0) / 29.0) * 100;
                const y = canvasHeight - 30 - Math.min((multPercent / 100) * (canvasHeight - 60), canvasHeight - 60);
                
                crashGameState.graphPoints.push({ x, y, mult: crashGameState.multiplier });
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫
                const maxPoints = Math.floor((canvasWidth - 20) / 2);
                if (crashGameState.graphPoints.length > maxPoints) {
                    crashGameState.graphPoints.shift();
                    crashGameState.graphPoints.forEach((p, i) => {
                        p.x = 10 + i * 2;
                    });
                }
                
                // –†–∏—Å—É–µ–º –≥—Ä–∞—Ñ–∏–∫
                if (crashGameState.graphPoints.length >= 2) {
                    ctx.strokeStyle = '#00ff00';
                    ctx.lineWidth = 3;
                    ctx.beginPath();
                    ctx.moveTo(crashGameState.graphPoints[0].x, crashGameState.graphPoints[0].y);
                    for (let i = 1; i < crashGameState.graphPoints.length; i++) {
                        ctx.lineTo(crashGameState.graphPoints[i].x, crashGameState.graphPoints[i].y);
                    }
                    ctx.stroke();
                    
                    // –ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ—á–∫–∞
                    const lastPoint = crashGameState.graphPoints[crashGameState.graphPoints.length - 1];
                    ctx.fillStyle = '#00ff00';
                    ctx.beginPath();
                    ctx.arc(lastPoint.x, lastPoint.y, 4, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å
                const multEl = document.getElementById('crashMultiplier');
                if (multEl) {
                    multEl.textContent = `x${crashGameState.multiplier.toFixed(2)}`;
                    multEl.style.color = '#00ff00';
                    multEl.style.borderColor = '#00ff00';
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å —Å—Ç–∞–≤–∫–∞ - –≤–æ –≤—Ä–µ–º—è —Ä–∞—É–Ω–¥–∞ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∑–∞–±—Ä–∞—Ç—å
                const betBtn = document.getElementById('crashBetBtn');
                if (betBtn) {
                    if (crashGameState.hasBet) {
                        betBtn.textContent = '–ó–∞–±—Ä–∞—Ç—å';
                        betBtn.disabled = false;
                        betBtn.style.cursor = 'pointer';
                        betBtn.style.pointerEvents = 'auto';
                    } else {
                        // –ï—Å–ª–∏ –Ω–µ—Ç —Å—Ç–∞–≤–∫–∏ - –±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –≤–æ –≤—Ä–µ–º—è —Ä–∞—É–Ω–¥–∞
                        betBtn.textContent = '–†–∞—É–Ω–¥ –Ω–∞—á–∞–ª—Å—è';
                        betBtn.disabled = true;
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∞—à
                if (crashGameState.multiplier >= crashGameState.targetMultiplier) {
                    // –†–ò–ó–ö–û –ü–ê–î–ê–ï–¢
                    crashGameState.isRunning = false;
                    
                    // –†–∏—Å—É–µ–º –∫—Ä–∞—Å–Ω—É—é –ª–∏–Ω–∏—é –ø–∞–¥–µ–Ω–∏—è
                    if (crashGameState.graphPoints.length > 0) {
                        const lastPoint = crashGameState.graphPoints[crashGameState.graphPoints.length - 1];
                        ctx.strokeStyle = '#ff0000';
                        ctx.lineWidth = 3;
                        ctx.beginPath();
                        ctx.moveTo(lastPoint.x, lastPoint.y);
                        ctx.lineTo(lastPoint.x, canvasHeight - 30);
                        ctx.stroke();
                    }
                    
                    // –í–∏–±—Ä–∞—Ü–∏—è
                    if (tg) {
                        try { tg.HapticFeedback.notificationOccurred('error'); } catch(e) {}
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å (–∫—Ä–∞—Å–Ω—ã–π)
                    const multEl = document.getElementById('crashMultiplier');
                    if (multEl) {
                        multEl.textContent = `x${crashGameState.targetMultiplier.toFixed(2)}`;
                        multEl.style.color = '#ff0000';
                        multEl.style.borderColor = '#ff0000';
                    }
                    
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    processCrashResult();
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—É–ª–¥–∞—É–Ω 10 —Å–µ–∫—É–Ω–¥
                    showCrashCooldown(ctx, canvas);
                    
                    crashGameState.animationId = null;
                    return;
                }
                
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
                crashGameState.animationId = requestAnimationFrame(animate);
            };
            
            animate();
        }
        
        function makeCrashBet() {
            // –ï—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å —Å—Ç–∞–≤–∫–∞ - –∑–∞–±–∏—Ä–∞–µ–º –≤—ã–∏–≥—Ä—ã—à (–ù–û —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è —Ä–∞—É–Ω–¥–∞, –Ω–µ –≤–æ –≤—Ä–µ–º—è –∫—É–ª–¥–∞—É–Ω–∞)
            if (crashGameState.hasBet) {
                // –ù–µ–ª—å–∑—è –∑–∞–±–∏—Ä–∞—Ç—å –≤–æ –≤—Ä–µ–º—è –∫—É–ª–¥–∞—É–Ω–∞ - —ç—Ç–æ —ç–∫—Å–ø–ª–æ–π—Ç
                if (crashGameState.isCooldown) {
                    if (tg) {
                        tg.showAlert('–ó–∞–±—Ä–∞—Ç—å —Å—Ç–∞–≤–∫—É –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è —Ä–∞—É–Ω–¥–∞, –∫–æ–≥–¥–∞ –≥—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—Ç–µ—Ç!');
                    } else {
                        alert('–ó–∞–±—Ä–∞—Ç—å —Å—Ç–∞–≤–∫—É –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è —Ä–∞—É–Ω–¥–∞, –∫–æ–≥–¥–∞ –≥—Ä–∞—Ñ–∏–∫ —Ä–∞—Å—Ç–µ—Ç!');
                    }
                    return;
                }
                // –ú–æ–∂–Ω–æ –∑–∞–±–∏—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞—É–Ω–¥–∞
                if (!crashGameState.isRunning) {
                    if (tg) {
                        tg.showAlert('–î–æ–∂–¥–∏—Ç–µ—Å—å –Ω–∞—á–∞–ª–∞ —Ä–∞—É–Ω–¥–∞, —á—Ç–æ–±—ã –∑–∞–±—Ä–∞—Ç—å —Å—Ç–∞–≤–∫—É!');
                    } else {
                        alert('–î–æ–∂–¥–∏—Ç–µ—Å—å –Ω–∞—á–∞–ª–∞ —Ä–∞—É–Ω–¥–∞, —á—Ç–æ–±—ã –∑–∞–±—Ä–∞—Ç—å —Å—Ç–∞–≤–∫—É!');
                    }
                    return;
                }
                console.log('‚úÖ –ó–∞–±–∏—Ä–∞–µ–º —Å—Ç–∞–≤–∫—É, –º–Ω–æ–∂–∏—Ç–µ–ª—å:', crashGameState.multiplier);
                cashOutCrash();
                return;
            }
            
            // –°—Ç–∞–≤–∫–∏ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –¢–û–õ–¨–ö–û –≤–æ –≤—Ä–µ–º—è –∫—É–ª–¥–∞—É–Ω–∞
            if (!crashGameState.isCooldown) {
                if (tg) {
                    tg.showAlert('–°—Ç–∞–≤–∫–∏ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –∫—É–ª–¥–∞—É–Ω–∞!');
                } else {
                    alert('–°—Ç–∞–≤–∫–∏ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –∫—É–ª–¥–∞—É–Ω–∞!');
                }
                return;
            }
            
            // –ï—Å–ª–∏ –∏–≥—Ä–∞ —É–∂–µ –∑–∞–ø—É—â–µ–Ω–∞ (—Ä–∞—É–Ω–¥ –Ω–∞—á–∞–ª—Å—è), –Ω–µ–ª—å–∑—è —Å—Ç–∞–≤–∏—Ç—å
            if (crashGameState.isRunning) {
                if (tg) {
                    tg.showAlert('–†–∞—É–Ω–¥ —É–∂–µ –Ω–∞—á–∞–ª—Å—è! –ú–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∑–∞–±—Ä–∞—Ç—å —Å—Ç–∞–≤–∫—É.');
                } else {
                    alert('–†–∞—É–Ω–¥ —É–∂–µ –Ω–∞—á–∞–ª—Å—è! –ú–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –∑–∞–±—Ä–∞—Ç—å —Å—Ç–∞–≤–∫—É.');
                }
                return;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏
            const betInput = document.getElementById('crashBetAmount');
            if (!betInput) return;
            
            const betAmount = parseFloat(betInput.value);
            if (!betAmount || betAmount <= 0 || betAmount > _balance) {
                if (tg) {
                    tg.showAlert('–ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞ —Å—Ç–∞–≤–∫–∏!');
                } else {
                    alert('–ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞ —Å—Ç–∞–≤–∫–∏!');
                }
                return;
            }
            
            // –°–ø–∏—Å—ã–≤–∞–µ–º –±–∞–ª–∞–Ω—Å
            if (!changeBalance(-betAmount, 'crashBet')) {
                return;
            }
            
            crashGameState.hasBet = true;
            crashGameState.betAmount = betAmount;
            
            console.log('‚úÖ –°—Ç–∞–≤–∫–∞ —Å–¥–µ–ª–∞–Ω–∞:', betAmount, 'hasBet:', crashGameState.hasBet);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É - –≤—Å–µ–≥–¥–∞ "–ó–∞–±—Ä–∞—Ç—å" –ø–æ—Å–ª–µ —Å—Ç–∞–≤–∫–∏
            const betBtn = document.getElementById('crashBetBtn');
            if (betBtn) {
                betBtn.textContent = '–ó–∞–±—Ä–∞—Ç—å';
                betBtn.disabled = false;
                betBtn.style.cursor = 'pointer';
                betBtn.style.pointerEvents = 'auto';
                console.log('‚úÖ –ö–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ "–ó–∞–±—Ä–∞—Ç—å"');
            }
            
            updateCrashBalance();
            
            if (tg) {
                tg.HapticFeedback.impactOccurred('medium');
            }
        }
        
        function cashOutCrash() {
            if (!crashGameState.hasBet) {
                console.log('‚ö†Ô∏è –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Å—Ç–∞–≤–∫–∏ –¥–ª—è –∑–∞–±–∏—Ä–∞–Ω–∏—è');
                return;
            }
            
            console.log('üí∞ –ó–∞–±–∏—Ä–∞–µ–º —Å—Ç–∞–≤–∫—É:', crashGameState.betAmount, '–ú–Ω–æ–∂–∏—Ç–µ–ª—å:', crashGameState.multiplier);
            
            const winnings = crashGameState.betAmount * crashGameState.multiplier;
            changeBalance(winnings, 'crashWin');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é (–≤—ã–∏–≥—Ä—ã—à)
            addToCrashHistory({
                betAmount: crashGameState.betAmount,
                multiplier: crashGameState.multiplier,
                winnings: winnings,
                isWin: true
            });
            
            crashGameState.hasBet = false;
            crashGameState.betAmount = 0;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
            const betBtn = document.getElementById('crashBetBtn');
            if (betBtn) {
                if (crashGameState.isRunning) {
                    // –ï—Å–ª–∏ —Ä–∞—É–Ω–¥ –∏–¥–µ—Ç - –±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É (—Å—Ç–∞–≤–∫—É —É–∂–µ –∑–∞–±—Ä–∞–ª–∏)
                    betBtn.textContent = '–†–∞—É–Ω–¥ –Ω–∞—á–∞–ª—Å—è';
                    betBtn.disabled = true;
                } else if (crashGameState.isCooldown) {
                    // –ï—Å–ª–∏ –∫—É–ª–¥–∞—É–Ω - —Ä–∞–∑—Ä–µ—à–∞–µ–º –Ω–æ–≤—É—é —Å—Ç–∞–≤–∫—É
                    betBtn.textContent = '–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É';
                    betBtn.disabled = false;
                } else {
                    // –ò–Ω–∞—á–µ - –æ–±—ã—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                    betBtn.textContent = '–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É';
                    betBtn.disabled = false;
                }
            }
            
            updateCrashBalance();
            
            if (tg) {
                tg.showAlert(`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winnings.toFixed(2)}!`);
                tg.HapticFeedback.notificationOccurred('success');
            } else {
                alert(`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winnings.toFixed(2)}!`);
            }
        }
        
        function processCrashResult() {
            // –ï—Å–ª–∏ –±—ã–ª–∞ —Å—Ç–∞–≤–∫–∞ –∏ –Ω–µ –∑–∞–±—Ä–∞–ª–∏ - —Ç–µ—Ä—è–µ–º
            if (crashGameState.hasBet) {
                const lostAmount = crashGameState.betAmount;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é (–ø—Ä–æ–∏–≥—Ä—ã—à)
                addToCrashHistory({
                    betAmount: lostAmount,
                    multiplier: crashGameState.targetMultiplier,
                    winnings: 0,
                    isWin: false
                });
                
                crashGameState.hasBet = false;
                crashGameState.betAmount = 0;
                
                const betBtn = document.getElementById('crashBetBtn');
                if (betBtn) {
                    betBtn.textContent = '–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É';
                    betBtn.disabled = false;
                }
                
                if (tg) {
                    tg.showAlert('–ö–†–ê–®! –°—Ç–∞–≤–∫–∞ –ø–æ—Ç–µ—Ä—è–Ω–∞');
                }
            }
        }
        
        function updateCrashBalance() {
            const balanceEl = document.getElementById('crashBalance');
            if (balanceEl) {
                balanceEl.textContent = _balance.toFixed(2);
            }
        }
        
        function addToCrashHistory(record) {
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –Ω–∞—á–∞–ª–æ –∏—Å—Ç–æ—Ä–∏–∏
            crashGameState.history.unshift(record);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –¥–æ 20 –∑–∞–ø–∏—Å–µ–π
            if (crashGameState.history.length > 20) {
                crashGameState.history = crashGameState.history.slice(0, 20);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
            updateCrashHistoryDisplay();
        }
        
        function updateCrashHistoryDisplay() {
            const historyList = document.getElementById('crashHistory');
            if (!historyList) return;
            
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
            historyList.innerHTML = '';
            
            // –ï—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
            if (crashGameState.history.length === 0) {
                const emptyMsg = document.createElement('div');
                emptyMsg.className = 'crash-history-item empty';
                emptyMsg.style.color = 'rgba(255, 255, 255, 0.5)';
                emptyMsg.style.textAlign = 'center';
                emptyMsg.style.padding = '20px';
                emptyMsg.textContent = '–ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ –ø—É—Å—Ç–∞';
                historyList.appendChild(emptyMsg);
                return;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å
            crashGameState.history.forEach(record => {
                const item = document.createElement('div');
                item.className = `crash-history-item ${record.isWin ? 'win' : 'loss'}`;
                
                // –õ–µ–≤–∞—è —á–∞—Å—Ç—å: —Å—Ç–∞–≤–∫–∞
                const betPart = document.createElement('div');
                betPart.className = 'crash-history-part';
                const betLabel = document.createElement('div');
                betLabel.className = 'crash-history-label';
                betLabel.textContent = '–°—Ç–∞–≤–∫–∞';
                const betValue = document.createElement('div');
                betValue.className = 'crash-history-bet';
                betValue.textContent = `${record.betAmount.toFixed(2)}`;
                betPart.appendChild(betLabel);
                betPart.appendChild(betValue);
                
                // –°—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç—å: –º–Ω–æ–∂–∏—Ç–µ–ª—å –∏–ª–∏ –∫—Ä–µ—Å—Ç–∏–∫
                const multPart = document.createElement('div');
                multPart.className = 'crash-history-part';
                const multLabel = document.createElement('div');
                multLabel.className = 'crash-history-label';
                multLabel.textContent = record.isWin ? '–ú–Ω–æ–∂–∏—Ç–µ–ª—å' : '–†–µ–∑—É–ª—å—Ç–∞—Ç';
                const multValue = document.createElement('div');
                if (record.isWin) {
                    multValue.className = 'crash-history-multiplier';
                    multValue.textContent = `x${record.multiplier.toFixed(2)}`;
                } else {
                    multValue.className = 'crash-history-loss';
                    multValue.textContent = '‚úï';
                    multValue.style.fontSize = '20px';
                }
                multPart.appendChild(multLabel);
                multPart.appendChild(multValue);
                
                // –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å: –≤—ã–∏–≥—Ä—ã—à –∏–ª–∏ –ø—Ä–æ–∏–≥—Ä—ã—à
                const winPart = document.createElement('div');
                winPart.className = 'crash-history-part';
                const winLabel = document.createElement('div');
                winLabel.className = 'crash-history-label';
                winLabel.textContent = record.isWin ? '–í—ã–∏–≥—Ä—ã—à' : '–ü—Ä–æ–∏–≥—Ä—ã—à';
                const winValue = document.createElement('div');
                if (record.isWin) {
                    winValue.className = 'crash-history-winnings';
                    winValue.textContent = `+${record.winnings.toFixed(2)}`;
                } else {
                    winValue.className = 'crash-history-loss';
                    winValue.textContent = `-${record.betAmount.toFixed(2)}`;
                }
                winPart.appendChild(winLabel);
                winPart.appendChild(winValue);
                
                item.appendChild(betPart);
                item.appendChild(multPart);
                item.appendChild(winPart);
                
                historyList.appendChild(item);
            });
        }
        
        function showCrashCooldown(ctx, canvas) {
            crashGameState.cooldownRemaining = 10;
            crashGameState.isCooldown = true;
            crashGameState.isRunning = false;
            
            // –ù–ï —Å–±—Ä–∞—Å—ã–≤–∞–µ–º hasBet - –µ—Å–ª–∏ —Å—Ç–∞–≤–∫–∞ –±—ã–ª–∞ —Å–¥–µ–ª–∞–Ω–∞, –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è
            
            // –†–∞–∑—Ä–µ—à–∞–µ–º —Å—Ç–∞–≤–∫–∏ –≤–æ –≤—Ä–µ–º—è –∫—É–ª–¥–∞—É–Ω–∞
            const betBtn = document.getElementById('crashBetBtn');
            if (betBtn) {
                // –ï—Å–ª–∏ –Ω–µ—Ç —Å—Ç–∞–≤–∫–∏, –º–æ–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å
                if (!crashGameState.hasBet) {
                    betBtn.disabled = false;
                    betBtn.textContent = '–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É';
                    betBtn.style.cursor = 'pointer';
                    betBtn.style.pointerEvents = 'auto';
                } else {
                    // –ï—Å–ª–∏ –µ—Å—Ç—å —Å—Ç–∞–≤–∫–∞ –≤–æ –≤—Ä–µ–º—è –∫—É–ª–¥–∞—É–Ω–∞ - –∫–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è —Ä–∞—É–Ω–¥–∞
                    betBtn.disabled = true;
                    betBtn.textContent = '–î–æ–∂–¥–∏—Ç–µ—Å—å —Ä–∞—É–Ω–¥–∞';
                    betBtn.style.cursor = 'not-allowed';
                    betBtn.style.pointerEvents = 'auto';
                }
            }
            
            const canvasWidth = canvas.width / (window.devicePixelRatio || 1);
            const canvasHeight = canvas.height / (window.devicePixelRatio || 1);
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
            if (crashGameState.cooldownInterval) {
                clearInterval(crashGameState.cooldownInterval);
            }
            
            const drawCooldown = () => {
                // –û—á–∏—â–∞–µ–º canvas
                ctx.clearRect(0, 0, canvasWidth, canvasHeight);
                ctx.fillStyle = 'rgba(20, 20, 30, 1)';
                ctx.fillRect(0, 0, canvasWidth, canvasHeight);
                
                // –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç –∫—É–ª–¥–∞—É–Ω–∞
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 32px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(`–ù–æ–≤—ã–π —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑`, canvasWidth / 2, canvasHeight / 2 - 40);
                
                ctx.fillStyle = '#667eea';
                ctx.font = 'bold 96px Arial';
                ctx.fillText(`${crashGameState.cooldownRemaining}`, canvasWidth / 2, canvasHeight / 2 + 20);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å (—Å–∫—Ä—ã–≤–∞–µ–º)
                const multEl = document.getElementById('crashMultiplier');
                if (multEl) {
                    multEl.style.display = 'none';
                }
            };
            
            drawCooldown();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
            crashGameState.cooldownInterval = setInterval(() => {
                crashGameState.cooldownRemaining--;
                
                if (crashGameState.cooldownRemaining <= 0) {
                    clearInterval(crashGameState.cooldownInterval);
                    crashGameState.cooldownInterval = null;
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–Ω–æ–∂–∏—Ç–µ–ª—è
                    const multEl = document.getElementById('crashMultiplier');
                    if (multEl) {
                        multEl.style.display = 'block';
                        multEl.textContent = 'x1.00';
                        multEl.style.color = '#00ff00';
                        multEl.style.borderColor = '#00ff00';
                    }
                    
                    // –ó–∞–≤–µ—Ä—à–∞–µ–º –∫—É–ª–¥–∞—É–Ω
                    crashGameState.isCooldown = false;
                    
                    // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç —Å—Ç–∞–≤–∫–∏
                    if (betBtn) {
                        if (!crashGameState.hasBet) {
                            betBtn.disabled = false;
                            betBtn.textContent = '–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É';
                        } else {
                            betBtn.disabled = false;
                            betBtn.textContent = '–ó–∞–±—Ä–∞—Ç—å';
                        }
                    }
                    
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π —Ä–∞—É–Ω–¥
                    startCrashRound(ctx, canvas);
                } else {
                    drawCooldown();
                }
            }, 1000);
        }
        
        window.makeCrashBet = makeCrashBet;
        
        // ========== –ò–ì–†–ê –ú–ò–ù–´ ==========
    </script>
</body>
</html>
